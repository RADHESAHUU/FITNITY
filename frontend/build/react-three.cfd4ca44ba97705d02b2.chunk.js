"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["react-three"],{tXvy:(e,t,n)=>{n.r(t),n.d(t,{AccumulativeShadows:()=>Uc,AdaptiveDpr:()=>zu,AdaptiveEvents:()=>Su,ArcballControls:()=>Yt,AsciiRenderer:()=>At,BBAnchor:()=>mi,Backdrop:()=>Hc,BakeShadows:()=>vu,Billboard:()=>J,Bounds:()=>Ks,Box:()=>bs,Bvh:()=>ni,CameraControls:()=>rn,CameraShake:()=>Js,Capsule:()=>Us,CatmullRomLine:()=>ge,Caustics:()=>Jc,Center:()=>vi,Circle:()=>Es,Clone:()=>st,Cloud:()=>Tl,CloudInstance:()=>Sl,Clouds:()=>zl,ComputedAttribute:()=>at,Cone:()=>Ms,ContactShadows:()=>Bc,CubeCamera:()=>Ut,CubeTexture:()=>On,CubicBezierLine:()=>ye,CurveModifier:()=>Xi,CycleRaycast:()=>v,Cylinder:()=>zs,Decal:()=>pt,Detailed:()=>yu,DetectGPU:()=>pr,DeviceOrientationControls:()=>Nt,Dodecahedron:()=>Bs,DragControls:()=>k,Edges:()=>$e,Effects:()=>Be,Environment:()=>Rc,EnvironmentCube:()=>Dc,EnvironmentMap:()=>_c,EnvironmentPortal:()=>Pc,Example:()=>xi,Extrude:()=>Is,FaceControls:()=>af,FaceLandmarker:()=>ef,FaceLandmarkerDefaults:()=>Jd,Facemesh:()=>$d,FacemeshDatas:()=>Zd,FacemeshEye:()=>Kd,FacemeshEyeDefaults:()=>Yd,Fbo:()=>kt,Fbx:()=>jn,FirstPersonControls:()=>tn,Fisheye:()=>Bu,Float:()=>ec,FlyControls:()=>jt,GizmoHelper:()=>bn,GizmoViewcube:()=>Rn,GizmoViewport:()=>Bn,Gltf:()=>St,GradientTexture:()=>Le,GradientType:()=>Ie,Grid:()=>Ln,Helper:()=>rr,Html:()=>g,Hud:()=>un,Icosahedron:()=>Fs,Image:()=>qe,Instance:()=>Ii,InstancedAttribute:()=>Ni,Instances:()=>Li,IsObject:()=>Oe,KeyboardControls:()=>X,Ktx2:()=>Xn,Lathe:()=>Ls,Lightformer:()=>ul,Line:()=>me,Loader:()=>S,MapControls:()=>Wt,MarchingCube:()=>dt,MarchingCubes:()=>ut,MarchingPlane:()=>ft,Mask:()=>Fu,MatcapTexture:()=>Il,Merged:()=>Ui,MeshDiscardMaterial:()=>fs,MeshDistortMaterial:()=>$i,MeshPortalMaterial:()=>Uu,MeshReflectorMaterial:()=>es,MeshRefractionMaterial:()=>cs,MeshTransmissionMaterial:()=>ds,MeshWobbleMaterial:()=>Ki,MotionPathControls:()=>cn,MultiMaterial:()=>ms,NormalTexture:()=>Nl,Octahedron:()=>ks,OrbitControls:()=>Ht,OrthographicCamera:()=>Bt,Outlines:()=>Ke,PerformanceMonitor:()=>Au,PerspectiveCamera:()=>It,PivotControls:()=>Gd,Plane:()=>Ts,Point:()=>cu,PointMaterial:()=>ys,PointMaterialImpl:()=>ps,PointerLockControls:()=>Jt,Points:()=>uu,PointsBuffer:()=>lu,Polyhedron:()=>Rs,PositionMesh:()=>_i,PositionPoint:()=>tu,PositionalAudio:()=>ve,Preload:()=>gu,PresentationControls:()=>G,Progress:()=>M,QuadraticBezierLine:()=>pe,RandomizedLight:()=>Oc,Reflector:()=>el,RenderCubeTexture:()=>Cu,RenderTexture:()=>Du,Resize:()=>Ws,Ring:()=>Cs,RoundedBox:()=>Vs,Sampler:()=>ot,ScreenQuad:()=>Gs,ScreenSizer:()=>se,ScreenSpace:()=>ee,ScreenVideoTexture:()=>Wd,Scroll:()=>V,ScrollControls:()=>U,Segment:()=>pu,SegmentObject:()=>mu,Segments:()=>fu,Select:()=>Z,Shadow:()=>Xc,ShadowAlpha:()=>Kl,Shape:()=>Os,Sky:()=>ml,SoftShadows:()=>xs,Sparkles:()=>Rl,Sphere:()=>Ss,Splat:()=>Rt,SpotLight:()=>ll,SpotLightShadow:()=>cl,SpriteAnimator:()=>Wi,Stage:()=>Gc,Stars:()=>yl,Stats:()=>sr,StatsGl:()=>lr,Svg:()=>gt,Tetrahedron:()=>Ps,Text:()=>be,Text3D:()=>De,Texture:()=>Ve,Torus:()=>_s,TorusKnot:()=>Ds,TrackballControls:()=>qt,Trail:()=>tt,TrailTexture:()=>gi,TransformControls:()=>Zt,Tube:()=>As,VideoTexture:()=>Zn,View:()=>Qu,WebcamVideoTexture:()=>Hd,Wireframe:()=>Yl,accumulativeContext:()=>Ic,calcPosFromAngles:()=>fl,calculateScaleFactor:()=>ae,checkIfFrameIsEmpty:()=>er,createInstances:()=>Oi,getFirstFrame:()=>Jn,isWebGL2Available:()=>ke,meshBounds:()=>Mu,shaderMaterial:()=>Ue,useAnimations:()=>oi,useAspect:()=>dr,useBVH:()=>ti,useBounds:()=>Zs,useBoxProjectedEnv:()=>ui,useCamera:()=>fr,useContextBridge:()=>ri,useCubeCamera:()=>Lt,useCubeTexture:()=>Un,useCursor:()=>x,useDepthBuffer:()=>ur,useDetectGPU:()=>hr,useEnvironment:()=>wc,useFBO:()=>Ft,useFBX:()=>Vn,useFaceControls:()=>sf,useFaceLandmarker:()=>tf,useFont:()=>Ae,useGLTF:()=>zt,useGizmoContext:()=>fn,useHelper:()=>nr,useIntersect:()=>ai,useKTX2:()=>Hn,useKeyboardControls:()=>q,useMask:()=>ku,useMatcapTexture:()=>Bl,useMotion:()=>an,useNormalTexture:()=>Ol,usePerformanceMonitor:()=>_u,useProgress:()=>E,useScroll:()=>L,useSelect:()=>Q,useSpriteAnimator:()=>ji,useSpriteLoader:()=>tr,useSurfaceSampler:()=>rt,useTexture:()=>Ne,useTrail:()=>et,useTrailTexture:()=>yi,useVideoTexture:()=>Kn});var r=n("+9dH"),o=n("q1tI"),a=n("EbEg"),i=n("jBc9"),s=n("1a1p");const c=new i.Vector3,l=new i.Vector3,u=new i.Vector3,d=new i.Vector2;function f(e,t,n){const r=c.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=n.width/2,a=n.height/2;return[r.x*o+o,-r.y*a+a]}const m=e=>Math.abs(e)<1e-10?0:e;function h(e,t,n=""){let r="matrix3d(";for(let o=0;16!==o;o++)r+=m(t[o]*e.elements[o])+(15!==o?",":")");return n+r}const p=(y=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>h(e,y));var y;const g=o.forwardRef((({children:e,eps:t=.001,style:n,className:y,prepend:g,center:v,fullscreen:x,portal:w,distanceFactor:b,sprite:E=!1,transform:M=!1,occlude:z,onOcclude:S,castShadow:T,receiveShadow:A,material:_,geometry:D,zIndexRange:P=[16777271,0],calculatePosition:C=f,as:R="div",wrapperClass:F,pointerEvents:k="auto",...B},I)=>{const{gl:L,camera:U,scene:O,size:N,raycaster:V,events:j,viewport:G}=(0,s.D)(),[W]=o.useState((()=>document.createElement(R))),H=o.useRef(),X=o.useRef(null),q=o.useRef(0),$=o.useRef([0,0]),Y=o.useRef(null),K=o.useRef(null),Z=(null==w?void 0:w.current)||j.connected||L.domElement.parentNode,Q=o.useRef(null),J=o.useRef(!1),ee=o.useMemo((()=>z&&"blending"!==z||Array.isArray(z)&&z.length&&function(e){return e&&"object"===typeof e&&"current"in e}(z[0])),[z]);o.useLayoutEffect((()=>{const e=L.domElement;z&&"blending"===z?(e.style.zIndex=`${Math.floor(P[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[z]),o.useLayoutEffect((()=>{if(X.current){const e=H.current=a.createRoot(W);if(O.updateMatrixWorld(),M)W.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=C(X.current,U,N);W.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return Z&&(g?Z.prepend(W):Z.appendChild(W)),()=>{Z&&Z.removeChild(W),e.unmount()}}}),[Z,M]),o.useLayoutEffect((()=>{F&&(W.className=F)}),[F]);const te=o.useMemo((()=>M?{position:"absolute",top:0,left:0,width:N.width,height:N.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:v?"translate3d(-50%,-50%,0)":"none",...x&&{top:-N.height/2,left:-N.width/2,width:N.width,height:N.height},...n}),[n,v,x,N,M]),ne=o.useMemo((()=>({position:"absolute",pointerEvents:k})),[k]);o.useLayoutEffect((()=>{var t,r;J.current=!1,M?null==(t=H.current)||t.render(o.createElement("div",{ref:Y,style:te},o.createElement("div",{ref:K,style:ne},o.createElement("div",{ref:I,className:y,style:n,children:e})))):null==(r=H.current)||r.render(o.createElement("div",{ref:I,style:te,className:y,children:e}))}));const re=o.useRef(!0);(0,s.F)((e=>{if(X.current){U.updateMatrixWorld(),X.current.updateWorldMatrix(!0,!1);const e=M?$.current:C(X.current,U,N);if(M||Math.abs(q.current-U.zoom)>t||Math.abs($.current[0]-e[0])>t||Math.abs($.current[1]-e[1])>t){const t=function(e,t){const n=c.setFromMatrixPosition(e.matrixWorld),r=l.setFromMatrixPosition(t.matrixWorld),o=n.sub(r),a=t.getWorldDirection(u);return o.angleTo(a)>Math.PI/2}(X.current,U);let n=!1;ee&&(Array.isArray(z)?n=z.map((e=>e.current)):"blending"!==z&&(n=[O]));const r=re.current;if(n){const e=function(e,t,n,r){const o=c.setFromMatrixPosition(e.matrixWorld),a=o.clone();a.project(t),d.set(a.x,a.y),n.setFromCamera(d,t);const i=n.intersectObjects(r,!0);if(i.length){const e=i[0].distance;return o.distanceTo(n.ray.origin)<e}return!0}(X.current,U,V,n);re.current=e&&!t}else re.current=!t;r!==re.current&&(S?S(!re.current):W.style.display=re.current?"block":"none");const o=Math.floor(P[0]/2),a=z?ee?[P[0],o]:[o-1,0]:P;if(W.style.zIndex=`${function(e,t,n){if(t instanceof i.PerspectiveCamera||t instanceof i.OrthographicCamera){const r=c.setFromMatrixPosition(e.matrixWorld),o=l.setFromMatrixPosition(t.matrixWorld),a=r.distanceTo(o),i=(n[1]-n[0])/(t.far-t.near),s=n[1]-i*t.far;return Math.round(i*a+s)}}(X.current,U,a)}`,M){const[e,t]=[N.width/2,N.height/2],n=U.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:o,left:a,bottom:i,right:s}=U,c=p(U.matrixWorldInverse),l=r?`scale(${n})translate(${m(-(s+a)/2)}px,${m((o+i)/2)}px)`:`translateZ(${n}px)`;let u=X.current.matrixWorld;E&&(u=U.matrixWorldInverse.clone().transpose().copyPosition(u).scale(X.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),W.style.width=N.width+"px",W.style.height=N.height+"px",W.style.perspective=r?"":`${n}px`,Y.current&&K.current&&(Y.current.style.transform=`${l}${c}translate(${e}px,${t}px)`,K.current.style.transform=((e,t)=>{return h(e,[1/(n=t),1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1],"translate(-50%,-50%)");var n})(u,1/((b||10)/400)))}else{const t=void 0===b?1:function(e,t){if(t instanceof i.OrthographicCamera)return t.zoom;if(t instanceof i.PerspectiveCamera){const n=c.setFromMatrixPosition(e.matrixWorld),r=l.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(o/2)*a)}return 1}(X.current,U)*b;W.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}$.current=e,q.current=U.zoom}}if(!ee&&Q.current&&!J.current)if(M){if(Y.current){const e=Y.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=U;if(t||D)B.scale&&(Array.isArray(B.scale)?B.scale instanceof i.Vector3?Q.current.scale.copy(B.scale.clone().divideScalar(1)):Q.current.scale.set(1/B.scale[0],1/B.scale[1],1/B.scale[2]):Q.current.scale.setScalar(1/B.scale));else{const t=(b||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;Q.current.scale.set(n,r,1)}J.current=!0}}}else{const t=W.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/G.factor,n=t.clientWidth*e,r=t.clientHeight*e;Q.current.scale.set(n,r,1),J.current=!0}Q.current.lookAt(e.camera.position)}}));const oe=o.useMemo((()=>({vertexShader:M?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[M]);return o.createElement("group",(0,r.A)({},B,{ref:X}),z&&!ee&&o.createElement("mesh",{castShadow:T,receiveShadow:A,ref:Q},D||o.createElement("planeGeometry",null),_||o.createElement("shaderMaterial",{side:i.DoubleSide,vertexShader:oe.vertexShader,fragmentShader:oe.fragmentShader})))}));function v({onChanged:e,portal:t,preventDefault:n=!0,scroll:r=!0,keyCode:a=9}){const i=o.useRef(0),c=(0,s.D)((e=>e.setEvents)),l=(0,s.D)((e=>e.get)),u=(0,s.D)((e=>e.gl));return o.useEffect((()=>{var o;let s,d=[];const f=l().events.filter,m=null!==(o=null==t?void 0:t.current)&&void 0!==o?o:u.domElement.parentNode,h=()=>m&&e&&e(d,Math.round(i.current)%d.length);c({filter:(e,t)=>{let n=[...e];n.length===d.length&&d.every((e=>n.map((e=>e.object.uuid)).includes(e.object.uuid)))||(i.current=0,d=n,h()),f&&(n=f(n,t));for(let r=0;r<Math.round(i.current)%n.length;r++){const e=n.shift();n=[...n,e]}return n}});const p=e=>{var t,n;i.current=e(i.current),null==(t=l().events.handlers)||t.onPointerCancel(void 0),null==(n=l().events.handlers)||n.onPointerMove(s),h()},y=e=>{(e.keyCode||e.which)===a&&(n&&e.preventDefault(),d.length>1&&p((e=>e+1)))},g=e=>{n&&e.preventDefault();let t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),d.length>1&&p((e=>Math.abs(e-t)))},v=e=>s=e;return document.addEventListener("pointermove",v,{passive:!0}),r&&document.addEventListener("wheel",g),void 0!==a&&document.addEventListener("keydown",y),()=>{c({filter:f}),void 0!==a&&document.removeEventListener("keydown",y),r&&document.removeEventListener("wheel",g),document.removeEventListener("pointermove",v)}}),[u,l,c,n,r,a]),null}function x(e,t="pointer",n="auto",r=document.body){o.useEffect((()=>{if(e)return r.style.cursor=t,()=>{r.style.cursor=n}}),[e])}var w=n("Qwas");let b=0;const E=(0,w.v)((e=>(i.DefaultLoadingManager.onStart=(t,n,r)=>{e({active:!0,item:t,loaded:n,total:r,progress:(n-b)/(r-b)*100})},i.DefaultLoadingManager.onLoad=()=>{e({active:!1})},i.DefaultLoadingManager.onError=t=>e((e=>({errors:[...e.errors,t]}))),i.DefaultLoadingManager.onProgress=(t,n,r)=>{n===r&&(b=r),e({active:!0,item:t,loaded:n,total:r,progress:(n-b)/(r-b)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})));function M({children:e}){const t=E();return o.createElement(o.Fragment,null,null==e?void 0:e(t))}const z=e=>`Loading ${e.toFixed(2)}%`;function S({containerStyles:e,innerStyles:t,barStyles:n,dataStyles:r,dataInterpolation:a=z,initialState:i=e=>e}){const{active:s,progress:c}=E(),l=o.useRef(0),u=o.useRef(0),d=o.useRef(null),[f,m]=o.useState(i(s));o.useEffect((()=>{let e;return s!==f&&(e=setTimeout((()=>m(s)),300)),()=>clearTimeout(e)}),[f,s]);const h=o.useCallback((()=>{d.current&&(l.current+=(c-l.current)/2,(l.current>.95*c||100===c)&&(l.current=c),d.current.innerText=a(l.current),l.current<c&&(u.current=requestAnimationFrame(h)))}),[a,c]);return o.useEffect((()=>(h(),()=>cancelAnimationFrame(u.current))),[h]),f?o.createElement("div",{style:{...T.container,opacity:s?1:0,...e}},o.createElement("div",null,o.createElement("div",{style:{...T.inner,...t}},o.createElement("div",{style:{...T.bar,transform:`scaleX(${c/100})`,...n}}),o.createElement("span",{ref:d,style:{...T.data,...r}})))):null}const T={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}};var A=n("eCu4");const _=new i.Vector3,D=new i.Vector2,P=new i.Vector3,C=new i.Vector3,R=new i.Vector3,F=new i.Plane,k=o.forwardRef((({autoTransform:e=!0,matrix:t,axisLock:n,dragLimits:a,onHover:c,onDragStart:l,onDrag:u,onDragEnd:d,children:f,dragConfig:m,...h},p)=>{const y=(0,s.D)((e=>e.controls)),{camera:g,size:v,raycaster:x,invalidate:w}=(0,s.D)(),b=o.useRef(null),E=(0,A.useGesture)({onHover:({hovering:e})=>c&&c(null!==e&&void 0!==e&&e),onDragStart:({event:e})=>{y&&(y.enabled=!1);const{point:t}=e;b.current.matrix.decompose(_,new i.Quaternion,new i.Vector3),P.copy(t),C.copy(P).sub(_),l&&l(_),w()},onDrag:({xy:[t,r],intentional:o})=>{if(!o)return;const s=(t-v.left)/v.width*2-1,c=-(r-v.top)/v.height*2+1;if(D.set(s,c),x.setFromCamera(D,g),n)switch(n){case"x":R.set(1,0,0);break;case"y":R.set(0,1,0);break;case"z":R.set(0,0,1)}else g.getWorldDirection(R).negate();F.setFromNormalAndCoplanarPoint(R,P),x.ray.intersectPlane(F,P);const l=b.current.matrix.clone(),d=b.current.matrixWorld.clone(),f=new i.Vector3(P.x-C.x,P.y-C.y,P.z-C.z);if(a&&(f.x=a[0]?Math.max(Math.min(f.x,a[0][1]),a[0][0]):f.x,f.y=a[1]?Math.max(Math.min(f.y,a[1][1]),a[1][0]):f.y,f.z=a[2]?Math.max(Math.min(f.z,a[2][1]),a[2][0]):f.z),e){b.current.matrix.setPosition(f);const e=b.current.matrix.clone().multiply(l.invert()),t=b.current.matrix.clone().multiply(d.invert());u&&u(b.current.matrix,e,b.current.matrixWorld,t)}else{const e=(new i.Matrix4).copy(b.current.matrix);e.setPosition(f);const t=e.clone().multiply(l.invert()),n=e.clone().multiply(d.invert());u&&u(e,t,b.current.matrixWorld,n)}w()},onDragEnd:()=>{y&&(y.enabled=!0),d&&d(),w()}},{drag:{filterTaps:!0,threshold:1,..."object"===typeof m?m:{}}});return o.useImperativeHandle(p,(()=>b.current),[]),o.useLayoutEffect((()=>{t&&(b.current.matrix=t)}),[t]),o.createElement("group",(0,r.A)({ref:b},E(),{matrix:t,matrixAutoUpdate:!1},h),f)}));var B=n("+HXV");const I=o.createContext(null);function L(){return o.useContext(I)}function U({eps:e=1e-5,enabled:t=!0,infinite:n,horizontal:r,pages:a=1,distance:i=1,damping:c=.25,maxSpeed:l=1/0,prepend:u=!1,style:d={},children:f}){const{get:m,setEvents:h,gl:p,size:y,invalidate:g,events:v}=(0,s.D)(),[x]=o.useState((()=>document.createElement("div"))),[w]=o.useState((()=>document.createElement("div"))),[b]=o.useState((()=>document.createElement("div"))),E=p.domElement.parentNode,M=o.useRef(0),z=o.useMemo((()=>{const t={el:x,eps:e,fill:w,fixed:b,horizontal:r,damping:c,offset:0,delta:0,scroll:M,pages:a,range(e,t,n=0){const r=e-n,o=r+t+2*n;return this.offset<r?0:this.offset>o?1:(this.offset-r)/(o-r)},curve(e,t,n=0){return Math.sin(this.range(e,t,n)*Math.PI)},visible(e,t,n=0){const r=e-n,o=r+t+2*n;return this.offset>=r&&this.offset<=o}};return t}),[e,c,r,a]);o.useEffect((()=>{x.style.position="absolute",x.style.width="100%",x.style.height="100%",x.style[r?"overflowX":"overflowY"]="auto",x.style[r?"overflowY":"overflowX"]="hidden",x.style.top="0px",x.style.left="0px";for(const n in d)x.style[n]=d[n];b.style.position="sticky",b.style.top="0px",b.style.left="0px",b.style.width="100%",b.style.height="100%",b.style.overflow="hidden",x.appendChild(b),w.style.height=r?"100%":a*i*100+"%",w.style.width=r?a*i*100+"%":"100%",w.style.pointerEvents="none",x.appendChild(w),u?E.prepend(x):E.appendChild(x),x[r?"scrollLeft":"scrollTop"]=1;const e=v.connected||p.domElement;requestAnimationFrame((()=>null==v.connect?void 0:v.connect(x)));const t=m().events.compute;return h({compute(e,t){const{left:n,top:r}=E.getBoundingClientRect(),o=e.clientX-n,a=e.clientY-r;t.pointer.set(o/t.size.width*2-1,-a/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{E.removeChild(x),h({compute:t}),null==v.connect||v.connect(e)}}),[a,i,r,x,w,b,E]),o.useEffect((()=>{if(v.connected===x){const e=y[r?"width":"height"],o=x[r?"scrollWidth":"scrollHeight"],a=o-e;let i=0,s=!0,c=!0;const l=()=>{if(t&&!c&&(g(),i=x[r?"scrollLeft":"scrollTop"],M.current=i/a,n)){if(!s)if(i>=a){const e=1-z.offset;x[r?"scrollLeft":"scrollTop"]=1,M.current=z.offset=-e,s=!0}else if(i<=0){const e=1+z.offset;x[r?"scrollLeft":"scrollTop"]=o,M.current=z.offset=e,s=!0}s&&setTimeout((()=>s=!1),40)}};x.addEventListener("scroll",l,{passive:!0}),requestAnimationFrame((()=>c=!1));const u=e=>x.scrollLeft+=e.deltaY/2;return r&&x.addEventListener("wheel",u,{passive:!0}),()=>{x.removeEventListener("scroll",l),r&&x.removeEventListener("wheel",u)}}}),[x,v,y,n,z,g,r,t]);let S=0;return(0,s.F)(((t,n)=>{S=z.offset,B.cz.damp(z,"offset",M.current,c,n,l,void 0,e),B.cz.damp(z,"delta",Math.abs(S-z.offset),c,n,l,void 0,e),z.delta>e&&g()})),o.createElement(I.Provider,{value:z},f)}const O=o.forwardRef((({children:e},t)=>{const n=o.useRef(null);o.useImperativeHandle(t,(()=>n.current),[]);const r=L(),{width:a,height:i}=(0,s.D)((e=>e.viewport));return(0,s.F)((()=>{n.current.position.x=r.horizontal?-a*(r.pages-1)*r.offset:0,n.current.position.y=r.horizontal?0:i*(r.pages-1)*r.offset})),o.createElement("group",{ref:n},e)})),N=o.forwardRef((({children:e,style:t,...n},i)=>{const c=L(),l=o.useRef(null);o.useImperativeHandle(i,(()=>l.current),[]);const{width:u,height:d}=(0,s.D)((e=>e.size)),f=o.useContext(s.g),m=o.useMemo((()=>a.createRoot(c.fixed)),[c.fixed]);return(0,s.F)((()=>{c.delta>c.eps&&(l.current.style.transform=`translate3d(${c.horizontal?-u*(c.pages-1)*c.offset:0}px,${c.horizontal?0:d*(c.pages-1)*-c.offset}px,0)`)})),m.render(o.createElement("div",(0,r.A)({ref:l,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},n),o.createElement(I.Provider,{value:c},o.createElement(s.g.Provider,{value:f},e)))),null})),V=o.forwardRef((({html:e,...t},n)=>{const a=e?N:O;return o.createElement(a,(0,r.A)({ref:n},t))}));var j=n("p0GV");function G({enabled:e=!0,snap:t,global:n,domElement:a,cursor:c=!0,children:l,speed:u=1,rotation:d=[0,0,0],zoom:f=1,polar:m=[0,Math.PI/2],azimuth:h=[-1/0,1/0],config:p={mass:1,tension:170,friction:26}}){const y=(0,s.D)((e=>e.events)),g=(0,s.D)((e=>e.gl)),v=a||y.connected||g.domElement,{size:x}=(0,s.D)(),w=o.useMemo((()=>[d[0]+m[0],d[0]+m[1]]),[d[0],m[0],m[1]]),b=o.useMemo((()=>[d[1]+h[0],d[1]+h[1]]),[d[1],h[0],h[1]]),E=o.useMemo((()=>[i.MathUtils.clamp(d[0],...w),i.MathUtils.clamp(d[1],...b),d[2]]),[d[0],d[1],d[2],w,b]),[M,z]=(0,j.zh)((()=>({scale:1,rotation:E,config:p})));o.useEffect((()=>{z.start({scale:1,rotation:E,config:p})}),[E]),o.useEffect((()=>{if(n&&c&&e)return v.style.cursor="grab",g.domElement.style.cursor="",()=>{v.style.cursor="default",g.domElement.style.cursor="default"}}),[n,c,v,e]);const S=(0,A.useGesture)({onHover:({last:t})=>{c&&!n&&e&&(v.style.cursor=t?"auto":"grab")},onDrag:({down:n,delta:[r,o],memo:[a,s]=M.rotation.animation.to||E})=>{if(!e)return[o,r];c&&(v.style.cursor=n?"grabbing":"grab"),r=i.MathUtils.clamp(s+r/x.width*Math.PI*u,...b),o=i.MathUtils.clamp(a+o/x.height*Math.PI*u,...w);const l=t&&!n&&"boolean"!==typeof t?t:p;return z.start({scale:n&&o>w[1]/2?f:1,rotation:t&&!n?E:[o,r,0],config:e=>"scale"===e?{...l,friction:3*l.friction}:l}),[o,r]}},{target:n?v:void 0});return o.createElement(j.a.group,(0,r.A)({},null==S?void 0:S(),M),l)}var W=n("caKH");const H=o.createContext(null);function X({map:e,children:t,onChange:n,domElement:r}){const a=e.map((e=>e.name+e.keys)).join("-"),i=o.useMemo((()=>(0,w.v)((0,W.eh)((()=>e.reduce(((e,t)=>({...e,[t.name]:!1})),{}))))),[a]),s=o.useMemo((()=>[i.subscribe,i.getState,i]),[a]),c=i.setState;return o.useEffect((()=>{const t=e.map((({name:e,keys:t,up:r})=>({keys:t,up:r,fn:t=>{c({[e]:t}),n&&n(e,t,s[1]())}}))).reduce(((e,{keys:t,fn:n,up:r=!0})=>(t.forEach((t=>e[t]={fn:n,pressed:!1,up:r})),e)),{}),o=({key:e,code:n})=>{const r=t[e]||t[n];if(!r)return;const{fn:o,pressed:a,up:i}=r;r.pressed=!0,!i&&a||o(!0)},a=({key:e,code:n})=>{const r=t[e]||t[n];if(!r)return;const{fn:o,up:a}=r;r.pressed=!1,a&&o(!1)},i=r||window;return i.addEventListener("keydown",o,{passive:!0}),i.addEventListener("keyup",a,{passive:!0}),()=>{i.removeEventListener("keydown",o),i.removeEventListener("keyup",a)}}),[r,a]),o.createElement(H.Provider,{value:s,children:t})}function q(e){const[t,n,r]=o.useContext(H);return e?r(e):[t,n]}var $=n("m/r/"),Y=n("S05N");const K=o.createContext([]);function Z({box:e,multiple:t,children:n,onChange:a,onChangePointerUp:c,border:l="1px solid #55aaff",backgroundColor:u="rgba(75, 160, 255, 0.1)",filter:d=e=>e,...f}){const[m,h]=o.useState(!1),{setEvents:p,camera:y,raycaster:g,gl:v,controls:x,size:w,get:b}=(0,s.D)(),[E,M]=o.useState(!1),[z,S]=o.useReducer(((e,{object:t,shift:n})=>void 0===t?[]:Array.isArray(t)?t:n?e.includes(t)?e.filter((e=>e!==t)):[t,...e]:e[0]===t?[]:[t]),[]);o.useEffect((()=>{m?null==a||a(z):null==c||c(z)}),[z,m]);const T=o.useCallback((e=>{e.stopPropagation(),S({object:d([e.object])[0],shift:t&&e.shiftKey})}),[]),A=o.useCallback((e=>!E&&S({})),[E]),_=o.useRef(null);return o.useEffect((()=>{if(!e||!t)return;const n=new $.g(y,_.current),r=document.createElement("div");r.style.pointerEvents="none",r.style.border=l,r.style.backgroundColor=u,r.style.position="fixed";const o=new i.Vector2,a=new i.Vector2,s=new i.Vector2,c=b().events.enabled,f=null==x?void 0:x.enabled;let m=!1;function g(e,t){const{offsetX:n,offsetY:r}=e,{width:o,height:a}=w;t.set(n/o*2-1,-r/a*2+1)}function E(e){e.shiftKey&&(function(e){var t;x&&(x.enabled=!1),p({enabled:!1}),h(m=!0),null==(t=v.domElement.parentElement)||t.appendChild(r),r.style.left=`${e.clientX}px`,r.style.top=`${e.clientY}px`,r.style.width="0px",r.style.height="0px",o.x=e.clientX,o.y=e.clientY}(e),g(e,n.startPoint))}let M=[];function z(e){if(m){!function(e){s.x=Math.max(o.x,e.clientX),s.y=Math.max(o.y,e.clientY),a.x=Math.min(o.x,e.clientX),a.y=Math.min(o.y,e.clientY),r.style.left=`${a.x}px`,r.style.top=`${a.y}px`,r.style.width=s.x-a.x+"px",r.style.height=s.y-a.y+"px"}(e),g(e,n.endPoint);const t=n.select().sort((e=>e.uuid)).filter((e=>e.isMesh));(0,Y.x)(t,M)||(M=t,S({object:d(t)}))}}function T(e){m&&function(){var e;m&&(x&&(x.enabled=f),p({enabled:c}),h(m=!1),null==(e=r.parentElement)||e.removeChild(r))}()}return document.addEventListener("pointerdown",E,{passive:!0}),document.addEventListener("pointermove",z,{passive:!0,capture:!0}),document.addEventListener("pointerup",T,{passive:!0}),()=>{document.removeEventListener("pointerdown",E),document.removeEventListener("pointermove",z,!0),document.removeEventListener("pointerup",T)}}),[w.width,w.height,g,y,x,v]),o.createElement("group",(0,r.A)({ref:_,onClick:T,onPointerOver:()=>M(!0),onPointerOut:()=>M(!1),onPointerMissed:A},f),o.createElement(K.Provider,{value:z},n))}function Q(){return o.useContext(K)}const J=o.forwardRef((function({children:e,follow:t=!0,lockX:n=!1,lockY:a=!1,lockZ:c=!1,...l},u){const d=o.useRef(null),f=o.useRef(null),m=new i.Quaternion;return(0,s.F)((({camera:e})=>{if(!t||!f.current)return;const r=d.current.rotation.clone();f.current.updateMatrix(),f.current.updateWorldMatrix(!1,!1),f.current.getWorldQuaternion(m),e.getWorldQuaternion(d.current.quaternion).premultiply(m.invert()),n&&(d.current.rotation.x=r.x),a&&(d.current.rotation.y=r.y),c&&(d.current.rotation.z=r.z)})),o.useImperativeHandle(u,(()=>f.current),[]),o.createElement("group",(0,r.A)({ref:f},l),o.createElement("group",{ref:d},e))})),ee=o.forwardRef((({children:e,depth:t=-1,...n},a)=>{const i=o.useRef(null);return o.useImperativeHandle(a,(()=>i.current),[]),(0,s.F)((({camera:e})=>{i.current.quaternion.copy(e.quaternion),i.current.position.copy(e.position)})),o.createElement("group",(0,r.A)({ref:i},n),o.createElement("group",{"position-z":-t},e))})),te=new i.Vector3,ne=new i.Vector3,re=new i.Vector3,oe=(e,t,n,r=1)=>{const o=te.set(e.x/n.width*2-1,-e.y/n.height*2+1,r);return o.unproject(t),o},ae=(e,t,n,r)=>{const o=((e,t,n)=>{const r=n.width/2,o=n.height/2;t.updateMatrixWorld(!1);const a=e.project(t);return a.x=a.x*r+r,a.y=-a.y*o+o,a})(re.copy(e),n,r);let a=0;for(let i=0;i<2;++i){const s=ne.copy(o).setComponent(i,o.getComponent(i)+t),c=oe(s,n,r,s.z);a=Math.max(a,e.distanceTo(c))}return a},ie=new i.Vector3,se=(0,o.forwardRef)((({scale:e=1,...t},n)=>{const a=(0,o.useRef)(null);return o.useImperativeHandle(n,(()=>a.current),[]),(0,s.F)((t=>{const n=a.current;if(!n)return;const r=ae(n.getWorldPosition(ie),e,t.camera,t.size);n.scale.setScalar(r*e)})),o.createElement("object3D",(0,r.A)({ref:a},t))}));var ce=n("iilC"),le=n("NNJQ"),ue=n("7Le1"),de=n("+sZi"),fe=n("WYqX");const me=o.forwardRef((function({points:e,color:t=16777215,vertexColors:n,linewidth:a,lineWidth:c,segments:l,dashed:u,...d},f){var m,h;const p=(0,s.D)((e=>e.size)),y=o.useMemo((()=>l?new ce.b:new le.X),[l]),[g]=o.useState((()=>new ue.G)),v=4===(null==n||null==(m=n[0])?void 0:m.length)?4:3,x=o.useMemo((()=>{const r=l?new de.n:new fe.v,o=e.map((e=>{const t=Array.isArray(e);return e instanceof i.Vector3||e instanceof i.Vector4?[e.x,e.y,e.z]:e instanceof i.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(r.setPositions(o.flat()),n){t=16777215;const e=n.map((e=>e instanceof i.Color?e.toArray():e));r.setColors(e.flat(),v)}return r}),[e,l,n,v]);return o.useLayoutEffect((()=>{y.computeLineDistances()}),[e,y]),o.useLayoutEffect((()=>{u?g.defines.USE_DASH="":delete g.defines.USE_DASH,g.needsUpdate=!0}),[u,g]),o.useEffect((()=>()=>{x.dispose(),g.dispose()}),[x]),o.createElement("primitive",(0,r.A)({object:y,ref:f},d),o.createElement("primitive",{object:x,attach:"geometry"}),o.createElement("primitive",(0,r.A)({object:g,attach:"material",color:t,vertexColors:Boolean(n),resolution:[p.width,p.height],linewidth:null!==(h=null!==a&&void 0!==a?a:c)&&void 0!==h?h:1,dashed:u,transparent:4===v},d)))})),he=new i.Vector3,pe=o.forwardRef((function({start:e=[0,0,0],end:t=[0,0,0],mid:n,segments:a=20,...s},c){const l=o.useRef(null);o.useImperativeHandle(c,(()=>l.current));const[u]=o.useState((()=>new i.QuadraticBezierCurve3(void 0,void 0,void 0))),d=o.useCallback(((e,t,n,r=20)=>(e instanceof i.Vector3?u.v0.copy(e):u.v0.set(...e),t instanceof i.Vector3?u.v2.copy(t):u.v2.set(...t),n instanceof i.Vector3?u.v1.copy(n):Array.isArray(n)?u.v1.set(...n):u.v1.copy(u.v0.clone().add(u.v2.clone().sub(u.v0)).add(he.set(0,u.v0.y-u.v2.y,0))),u.getPoints(r))),[]);o.useLayoutEffect((()=>{l.current.setPoints=(e,t,n)=>{const r=d(e,t,n);l.current.geometry&&l.current.geometry.setPositions(r.map((e=>e.toArray())).flat())}}),[]);const f=o.useMemo((()=>d(e,t,n,a)),[e,t,n,a]);return o.createElement(me,(0,r.A)({ref:l,points:f},s))})),ye=o.forwardRef((function({start:e,end:t,midA:n,midB:a,segments:s=20,...c},l){const u=o.useMemo((()=>{const r=e instanceof i.Vector3?e:new i.Vector3(...e),o=t instanceof i.Vector3?t:new i.Vector3(...t),c=n instanceof i.Vector3?n:new i.Vector3(...n),l=a instanceof i.Vector3?a:new i.Vector3(...a);return new i.CubicBezierCurve3(r,c,l,o).getPoints(s)}),[e,t,n,a,s]);return o.createElement(me,(0,r.A)({ref:l,points:u},c))})),ge=o.forwardRef((function({points:e,closed:t=!1,curveType:n="centripetal",tension:a=.5,segments:s=20,vertexColors:c,...l},u){const d=o.useMemo((()=>{const r=e.map((e=>e instanceof i.Vector3?e:new i.Vector3(...e)));return new i.CatmullRomCurve3(r,t,n,a)}),[e,t,n,a]),f=o.useMemo((()=>d.getPoints(s)),[d,s]),m=o.useMemo((()=>{if(!c||c.length<2)return;if(c.length===s+1)return c;const e=c.map((e=>e instanceof i.Color?e:new i.Color(...e)));t&&e.push(e[0].clone());const n=[e[0]],r=s/(e.length-1);for(let t=1;t<s;t++){const o=t%r/r,a=Math.floor(t/r);n.push(e[a].clone().lerp(e[a+1],o))}return n.push(e[e.length-1]),n}),[c,s]);return o.createElement(me,(0,r.A)({ref:u,points:f,vertexColors:m},l))})),ve=o.forwardRef((({url:e,distance:t=1,loop:n=!0,autoplay:a,...c},l)=>{const u=o.useRef(null);o.useImperativeHandle(l,(()=>u.current),[]);const d=(0,s.D)((({camera:e})=>e)),[f]=o.useState((()=>new i.AudioListener)),m=(0,s.H)(i.AudioLoader,e);return o.useEffect((()=>{const e=u.current;e&&(e.setBuffer(m),e.setRefDistance(t),e.setLoop(n),a&&!e.isPlaying&&e.play())}),[m,d,t,n]),o.useEffect((()=>{const e=u.current;return d.add(f),()=>{d.remove(f),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}}),[]),o.createElement("positionalAudio",(0,r.A)({ref:u,args:[f]},c))}));var xe=n("pBfW"),we=n("3wJl");const be=o.forwardRef((({sdfGlyphSize:e=64,anchorX:t="center",anchorY:n="middle",font:a,fontSize:i=1,children:c,characters:l,onSync:u,...d},f)=>{const m=(0,s.D)((({invalidate:e})=>e)),[h]=o.useState((()=>new xe.EY)),[p,y]=o.useMemo((()=>{const e=[];let t="";return o.Children.forEach(c,(n=>{"string"===typeof n||"number"===typeof n?t+=n:e.push(n)})),[e,t]}),[c]);return(0,we.DY)((()=>new Promise((e=>(0,xe.PY)({font:a,characters:l},e)))),["troika-text",a,l]),o.useLayoutEffect((()=>{h.sync((()=>{m(),u&&u(h)}))})),o.useEffect((()=>()=>h.dispose()),[h]),o.createElement("primitive",(0,r.A)({object:h,ref:f,font:a,text:y,anchorX:t,anchorY:n,fontSize:i,sdfGlyphSize:e},d),p)}));var Ee=n("UcaZ"),Me=n("xIrr"),ze=n("Ab5z");let Se=null;async function Te(e){const t=await async function(e){return"string"===typeof e?await(await fetch(e)).json():e}(e);return n=t,Se||(Se=new ze.J),Se.parse(n);var n}function Ae(e){return(0,we.DY)(Te,[e])}Ae.preload=e=>(0,we.uv)(Te,[e]),Ae.clear=e=>(0,we.IU)([e]);const _e=["string","number"],De=o.forwardRef((({font:e,letterSpacing:t=0,lineHeight:n=1,size:a=1,height:i=.2,bevelThickness:c=.1,bevelSize:l=.01,bevelEnabled:u=!1,bevelOffset:d=0,bevelSegments:f=4,curveSegments:m=8,smooth:h,children:p,...y},g)=>{o.useMemo((()=>(0,s.e)({RenamedTextGeometry:Ee._})),[]);const v=o.useRef(null),x=Ae(e),w=(0,o.useMemo)((()=>({font:x,size:a,height:i,bevelThickness:c,bevelSize:l,bevelEnabled:u,bevelSegments:f,bevelOffset:d,curveSegments:m,letterSpacing:t,lineHeight:n})),[x,a,i,c,l,u,f,d,m,t,n]),[b,...E]=(0,o.useMemo)((()=>(e=>{let t="";const n=[];return o.Children.forEach(e,(e=>{_e.includes(typeof e)?t+=e+"":n.push(e)})),[t,...n]})(p)),[p]),M=o.useMemo((()=>[b,w]),[b,w]);return o.useLayoutEffect((()=>{h&&(v.current.geometry=(0,Me.ec)(v.current.geometry,h),v.current.geometry.computeVertexNormals())}),[M,h]),o.useImperativeHandle(g,(()=>v.current),[]),o.createElement("mesh",(0,r.A)({},y,{ref:v}),o.createElement("renamedTextGeometry",{args:M}),E)}));var Pe=n("VGrL"),Ce=n("+uaP"),Re=n("iG0e"),Fe=n("2FA9");const ke=()=>{try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}},Be=o.forwardRef((({children:e,multisamping:t=8,renderIndex:n=1,disableRender:a,disableGamma:c,disableRenderPass:l,depthBuffer:u=!0,stencilBuffer:d=!1,anisotropy:f=1,encoding:m,type:h,...p},y)=>{o.useMemo((()=>(0,s.e)({EffectComposer:Pe.s,RenderPass:Ce.A,ShaderPass:Re.p})),[]);const g=o.useRef(null);o.useImperativeHandle(y,(()=>g.current),[]);const{scene:v,camera:x,gl:w,size:b,viewport:E}=(0,s.D)(),[M]=o.useState((()=>{const e=new i.WebGLRenderTarget(b.width,b.height,{type:h||i.HalfFloatType,format:i.RGBAFormat,depthBuffer:u,stencilBuffer:d,anisotropy:f});return h===i.UnsignedByteType&&null!=m&&("colorSpace"in e?e.texture.colorSpace=m:e.texture.encoding=m),e.samples=t,e}));o.useEffect((()=>{var e,t;null==(e=g.current)||e.setSize(b.width,b.height),null==(t=g.current)||t.setPixelRatio(E.dpr)}),[w,b,E.dpr]),(0,s.F)((()=>{var e;a||null==(e=g.current)||e.render()}),n);const z=[];return l||z.push(o.createElement("renderPass",{key:"renderpass",attach:`passes-${z.length}`,args:[v,x]})),c||z.push(o.createElement("shaderPass",{attach:`passes-${z.length}`,key:"gammapass",args:[Fe.Z]})),o.Children.forEach(e,(e=>{e&&z.push(o.cloneElement(e,{key:z.length,attach:`passes-${z.length}`}))})),o.createElement("effectComposer",(0,r.A)({ref:g,args:[w,M]},p),z)}));let Ie=function(e){return e.Linear="linear",e.Radial="radial",e}({});function Le({stops:e,colors:t,size:n=1024,width:a=16,type:c=Ie.Linear,innerCircleRadius:l=0,outerCircleRadius:u="auto",...d}){const f=(0,s.D)((e=>e.gl)),m=o.useMemo((()=>{const r=document.createElement("canvas"),o=r.getContext("2d");let s;if(r.width=a,r.height=n,c===Ie.Linear)s=o.createLinearGradient(0,0,0,n);else{const e=r.width/2,t=r.height/2,n="auto"!==u?Math.abs(Number(u)):Math.sqrt(e**2+t**2);s=o.createRadialGradient(e,t,Math.abs(l),e,t,n)}const d=new i.Color;let f=e.length;for(;f--;)s.addColorStop(e[f],d.set(t[f]).getStyle());return o.save(),o.fillStyle=s,o.fillRect(0,0,a,n),o.restore(),r}),[e]);return o.createElement("canvasTexture",(0,r.A)({colorSpace:f.outputColorSpace,args:[m],attach:"map"},d))}function Ue(e,t,n,r){const o=class extends i.ShaderMaterial{constructor(o={}){const a=Object.entries(e);super({uniforms:a.reduce(((e,[t,n])=>({...e,...i.UniformsUtils.clone({[t]:{value:n}})})),{}),vertexShader:t,fragmentShader:n}),this.key="",a.forEach((([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))),Object.assign(this,o),r&&r(this)}};return o.key=i.MathUtils.generateUUID(),o}const Oe=e=>e===Object(e)&&!Array.isArray(e)&&"function"!==typeof e;function Ne(e,t){const n=(0,s.D)((e=>e.gl)),r=(0,s.H)(i.TextureLoader,Oe(e)?Object.values(e):e);(0,o.useLayoutEffect)((()=>{null==t||t(r)}),[t]),(0,o.useEffect)((()=>{if("initTexture"in n){let e=[];Array.isArray(r)?e=r:r instanceof i.Texture?e=[r]:Oe(r)&&(e=Object.values(r)),e.forEach((e=>{e instanceof i.Texture&&n.initTexture(e)}))}}),[n,r]);const a=(0,o.useMemo)((()=>{if(Oe(e)){const t={};let n=0;for(const o in e)t[o]=r[n++];return t}return r}),[e,r]);return a}Ne.preload=e=>s.H.preload(i.TextureLoader,e),Ne.clear=e=>s.H.clear(i.TextureLoader,e);const Ve=({children:e,input:t,onLoad:n})=>{const r=Ne(t,n);return o.createElement(o.Fragment,null,null==e?void 0:e(r))},je=(()=>parseInt(i.REVISION.replace(/\D+/g,"")))(),Ge=Ue({color:new i.Color("white"),scale:new i.Vector2(1,1),imageBounds:new i.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n  varying vec2 vUv;\n  varying vec2 vPos;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n    vPos = position.xy;\n  }\n",`\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  varying vec2 vPos;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform float resolution;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float radius;\n  uniform float zoom;\n  uniform float grayscale;\n  uniform float opacity;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  \n  const float PI = 3.14159265;\n    \n  // from https://iquilezles.org/articles/distfunctions\n  float udRoundBox( vec2 p, vec2 b, float r ) {\n    return length(max(abs(p)-b+r,0.0))-r;\n  }\n\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n\n    vec2 res = vec2(scale * resolution);\n    vec2 halfRes = 0.5 * res;\n    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n\t  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n    \n    #include <tonemapping_fragment>\n    #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n  }\n`),We=o.forwardRef((({children:e,color:t,segments:n=1,scale:a=1,zoom:i=1,grayscale:c=0,opacity:l=1,radius:u=0,texture:d,toneMapped:f,transparent:m,side:h,...p},y)=>{(0,s.e)({ImageMaterial:Ge});const g=o.useRef(null),v=(0,s.D)((e=>e.size)),x=Array.isArray(a)?[a[0],a[1]]:[a,a],w=[d.image.width,d.image.height],b=Math.max(v.width,v.height);return o.useImperativeHandle(y,(()=>g.current),[]),o.useLayoutEffect((()=>{g.current.geometry.parameters&&g.current.material.scale.set(x[0]*g.current.geometry.parameters.width,x[1]*g.current.geometry.parameters.height)}),[x[0],x[1]]),o.createElement("mesh",(0,r.A)({ref:g,scale:Array.isArray(a)?[...a,1]:a},p),o.createElement("planeGeometry",{args:[1,1,n,n]}),o.createElement("imageMaterial",{color:t,map:d,zoom:i,grayscale:c,opacity:l,scale:x,imageBounds:w,resolution:b,radius:u,toneMapped:f,transparent:m,side:h,key:Ge.key}),e)})),He=o.forwardRef((({url:e,...t},n)=>{const a=Ne(e);return o.createElement(We,(0,r.A)({},t,{texture:a,ref:n}))})),Xe=o.forwardRef((({url:e,...t},n)=>o.createElement(We,(0,r.A)({},t,{ref:n})))),qe=o.forwardRef(((e,t)=>{if(e.url)return o.createElement(He,(0,r.A)({},e,{ref:t}));if(e.texture)return o.createElement(Xe,(0,r.A)({},e,{ref:t}));throw new Error("<Image /> requires a url or texture")})),$e=o.forwardRef((({threshold:e=15,geometry:t,...n},a)=>{const s=o.useRef(null);o.useImperativeHandle(a,(()=>s.current),[]);const c=o.useMemo((()=>[0,0,0,1,0,0]),[]),l=o.useRef(),u=o.useRef();return o.useLayoutEffect((()=>{const n=s.current.parent,r=null!==t&&void 0!==t?t:null==n?void 0:n.geometry;if(!r)return;if(l.current===r&&u.current===e)return;l.current=r,u.current=e;const o=new i.EdgesGeometry(r,e).attributes.position.array;s.current.geometry.setPositions(o),s.current.geometry.attributes.instanceStart.needsUpdate=!0,s.current.geometry.attributes.instanceEnd.needsUpdate=!0,s.current.computeLineDistances()})),o.createElement(me,(0,r.A)({segments:!0,points:c,ref:s,raycast:()=>null},n))})),Ye=Ue({screenspace:!1,color:new i.Color("black"),opacity:1,thickness:.05,size:new i.Vector2},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   #include <clipping_planes_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n\t     #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n\t   #include <morphtarget_vertex>\n\t   #include <skinning_vertex>\n     #include <project_vertex>\n     #include <clipping_planes_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }",`uniform vec3 color;\n   uniform float opacity;\n   #include <clipping_planes_pars_fragment>\n   void main(){\n     #include <clipping_planes_fragment>\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`);function Ke({color:e="black",opacity:t=1,transparent:n=!1,screenspace:a=!1,toneMapped:c=!0,polygonOffset:l=!1,polygonOffsetFactor:u=0,renderOrder:d=0,thickness:f=.05,angle:m=Math.PI,clippingPlanes:h,...p}){const y=o.useRef(),[g]=o.useState((()=>new Ye({side:i.BackSide}))),{gl:v}=(0,s.D)(),x=v.getDrawingBufferSize(new i.Vector2);o.useMemo((()=>(0,s.e)({OutlinesMaterial:Ye})),[]);const w=o.useRef(0),b=o.useRef();return o.useLayoutEffect((()=>{const e=y.current;if(!e)return;const t=e.parent;if(t&&t.geometry&&(w.current!==m||b.current!==t.geometry)){var n;w.current=m,b.current=t.geometry;let r=null==(n=e.children)?void 0:n[0];r&&(m&&r.geometry.dispose(),e.remove(r)),t.skeleton?(r=new i.SkinnedMesh,r.material=g,r.bind(t.skeleton,t.bindMatrix),e.add(r)):t.isInstancedMesh?(r=new i.InstancedMesh(t.geometry,g,t.count),r.instanceMatrix=t.instanceMatrix,e.add(r)):(r=new i.Mesh,r.material=g,e.add(r)),r.geometry=m?(0,Me.pb)(t.geometry,m):t.geometry,r.morphTargetInfluences=t.morphTargetInfluences,r.morphTargetDictionary=t.morphTargetDictionary}})),o.useLayoutEffect((()=>{const r=y.current;if(!r)return;const o=r.children[0];if(o){o.renderOrder=d;const i=r.parent;(0,s.k)(o,{morphTargetInfluences:i.morphTargetInfluences,morphTargetDictionary:i.morphTargetDictionary}),(0,s.k)(o.material,{transparent:n,thickness:f,color:e,opacity:t,size:x,screenspace:a,toneMapped:c,polygonOffset:l,polygonOffsetFactor:u,clippingPlanes:h,clipping:h&&h.length>0})}})),o.useEffect((()=>()=>{const e=y.current;if(!e)return;const t=e.children[0];t&&(m&&t.geometry.dispose(),e.remove(t))}),[]),o.createElement("group",(0,r.A)({ref:y},p))}var Ze=n("KEjY");const Qe={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},Je=(e,t=1)=>(e.set(e.subarray(t)),e.fill(-1/0,-t),e);function et(e,t){const{length:n,local:r,decay:a,interval:c,stride:l}={...Qe,...t},u=o.useRef(),[d]=o.useState((()=>new i.Vector3));o.useLayoutEffect((()=>{e&&(u.current=Float32Array.from({length:10*n*3},((t,n)=>e.position.getComponent(n%3))))}),[n,e]);const f=o.useRef(new i.Vector3),m=o.useRef(0);return(0,s.F)((()=>{if(e&&u.current){if(0===m.current){let t;r?t=e.position:(e.getWorldPosition(d),t=d);const n=1*a;for(let e=0;e<n;e++)t.distanceTo(f.current)<l||(Je(u.current,3),u.current.set(t.toArray(),u.current.length-3));f.current.copy(t)}m.current++,m.current=m.current%c}})),u}const tt=o.forwardRef(((e,t)=>{const{children:n}=e,{width:r,length:a,decay:c,local:l,stride:u,interval:d}={...Qe,...e},{color:f="hotpink",attenuation:m,target:h}=e,p=(0,s.D)((e=>e.size)),y=(0,s.D)((e=>e.scene)),g=o.useRef(null),[v,x]=o.useState(null),w=et(v,{length:a,decay:c,local:l,stride:u,interval:d});o.useEffect((()=>{const e=(null==h?void 0:h.current)||g.current.children.find((e=>e instanceof i.Object3D));e&&x(e)}),[w,h]);const b=o.useMemo((()=>new Ze.mx),[]),E=o.useMemo((()=>{var e;const t=new Ze.Xu({lineWidth:.1*r,color:f,sizeAttenuation:1,resolution:new i.Vector2(p.width,p.height)});let o;if(n)if(Array.isArray(n))o=n.find((e=>{const t=e;return"string"===typeof t.type&&"meshLineMaterial"===t.type}));else{const e=n;"string"===typeof e.type&&"meshLineMaterial"===e.type&&(o=e)}return"object"===typeof(null==(e=o)?void 0:e.props)&&t.setValues(o.props),t}),[r,f,p,n]);return o.useEffect((()=>{E.uniforms.resolution.value.set(p.width,p.height)}),[p]),(0,s.F)((()=>{w.current&&b.setPoints(w.current,m)})),o.createElement("group",null,(0,s.h)(o.createElement("mesh",{ref:t,geometry:b,material:E}),y),o.createElement("group",{ref:g},n))}));var nt=n("Fz9d");function rt(e,t=16,n,r,a){const[s,c]=o.useState((()=>{const e=Array.from({length:t},(()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])).flat();return new i.InstancedBufferAttribute(Float32Array.from(e),16)}));return o.useLayoutEffect((()=>{if("undefined"===typeof e.current)return;const o=new nt.N(e.current);r&&o.setWeightAttribute(r),o.build();const l=new i.Vector3,u=new i.Vector3,d=new i.Color,f=new i.Object3D;e.current.updateMatrixWorld(!0);for(let r=0;r<t;r++)o.sample(l,u,d),"function"===typeof n?n({dummy:f,sampledMesh:e.current,position:l,normal:u,color:d},r):f.position.copy(l),f.updateMatrix(),null!=a&&a.current&&a.current.setMatrixAt(r,f.matrix),f.matrix.toArray(s.array,16*r);null!=a&&a.current&&(a.current.instanceMatrix.needsUpdate=!0),s.needsUpdate=!0,c(new i.InstancedBufferAttribute(s.array,s.itemSize).copy(s))}),[e,a,r,t,n]),s}function ot({children:e,weight:t,transform:n,instances:a,mesh:i,count:s=16,...c}){const l=o.useRef(null),u=o.useRef(null),d=o.useRef(null);return o.useLayoutEffect((()=>{var e,t;u.current=null!==(e=null==a?void 0:a.current)&&void 0!==e?e:l.current.children.find((e=>e.hasOwnProperty("instanceMatrix"))),d.current=null!==(t=null==i?void 0:i.current)&&void 0!==t?t:l.current.children.find((e=>"Mesh"===e.type))}),[e,null==i?void 0:i.current,null==a?void 0:a.current]),rt(d,s,n,t,u),o.createElement("group",(0,r.A)({ref:l},c),e)}const at=({compute:e,name:t,...n})=>{const[a]=o.useState((()=>new i.BufferAttribute(new Float32Array(0),1))),s=o.useRef(null);return o.useLayoutEffect((()=>{if(s.current){var t;const n=null!==(t=s.current.parent)&&void 0!==t?t:s.current.__r3f.parent,r=e(n);s.current.copy(r)}}),[e]),o.createElement("primitive",(0,r.A)({ref:s,object:a,attach:`attributes-${t}`},n))};var it=n("4xMl");const st=o.forwardRef((({isChild:e=!1,object:t,children:n,deep:a,castShadow:s,receiveShadow:c,inject:l,keys:u,...d},f)=>{const m={keys:u,deep:a,inject:l,castShadow:s,receiveShadow:c};if(t=o.useMemo((()=>{if(!1===e&&!Array.isArray(t)){let e=!1;if(t.traverse((t=>{t.isSkinnedMesh&&(e=!0)})),e)return it.t.clone(t)}return t}),[t,e]),Array.isArray(t))return o.createElement("group",(0,r.A)({},d,{ref:f}),t.map((e=>o.createElement(st,(0,r.A)({key:e.uuid,object:e},m)))),n);const{children:h,...p}=function(e,{keys:t=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:n,inject:r,castShadow:a,receiveShadow:s}){let c={};for(const o of t)c[o]=e[o];return n&&(c.geometry&&"materialsOnly"!==n&&(c.geometry=c.geometry.clone()),c.material&&"geometriesOnly"!==n&&(c.material=c.material.clone())),r&&(c="function"===typeof r?{...c,children:r(e)}:o.isValidElement(r)?{...c,children:r}:{...c,...r}),e instanceof i.Mesh&&(a&&(c.castShadow=!0),s&&(c.receiveShadow=!0)),c}(t,m),y=t.type[0].toLowerCase()+t.type.slice(1);return o.createElement(y,(0,r.A)({},p,d,{ref:f}),t.children.map((e=>"Bone"===e.type?o.createElement("primitive",(0,r.A)({key:e.uuid,object:e},m)):o.createElement(st,(0,r.A)({key:e.uuid,object:e},m,{isChild:!0})))),n,h)}));var ct=n("gGK5");const lt=o.createContext(null),ut=o.forwardRef((({resolution:e=28,maxPolyCount:t=1e4,enableUvs:n=!1,enableColors:a=!1,children:i,...c},l)=>{const u=o.useRef(null);o.useImperativeHandle(l,(()=>u.current),[]);const d=o.useMemo((()=>new ct.Yc(e,null,n,a,t)),[e,t,n,a]),f=o.useMemo((()=>({getParent:()=>u})),[]);return(0,s.F)((()=>{d.update(),d.reset()}),-1),o.createElement(o.Fragment,null,o.createElement("primitive",(0,r.A)({object:d,ref:u},c),o.createElement(lt.Provider,{value:f},i)))})),dt=o.forwardRef((({strength:e=.5,subtract:t=12,color:n,...a},c)=>{const{getParent:l}=o.useContext(lt),u=o.useMemo((()=>l()),[l]),d=o.useRef(null);o.useImperativeHandle(c,(()=>d.current),[]);const f=new i.Vector3;return(0,s.F)((r=>{u.current&&d.current&&(d.current.getWorldPosition(f),u.current.addBall(.5+.5*f.x,.5+.5*f.y,.5+.5*f.z,e,t,n))})),o.createElement("group",(0,r.A)({ref:d},a))})),ft=o.forwardRef((({planeType:e="x",strength:t=.5,subtract:n=12,...a},i)=>{const{getParent:c}=o.useContext(lt),l=o.useMemo((()=>c()),[c]),u=o.useRef(null);o.useImperativeHandle(i,(()=>u.current),[]);const d=o.useMemo((()=>"x"===e?"addPlaneX":"y"===e?"addPlaneY":"addPlaneZ"),[e]);return(0,s.F)((()=>{l.current&&u.current&&l.current[d](t,n)})),o.createElement("group",(0,r.A)({ref:u},a))}));var mt=n("J0Jp");function ht(e=[0,0,0]){return function(e){return Array.isArray(e)}(e)?e:e instanceof i.Vector3||e instanceof i.Euler?[e.x,e.y,e.z]:[e,e,e]}const pt=o.forwardRef((function({debug:e,depthTest:t=!1,polygonOffsetFactor:n=-10,map:a,mesh:c,children:l,position:u,rotation:d,scale:f,...m},h){const p=o.useRef(null);o.useImperativeHandle(h,(()=>p.current));const y=o.useRef(null),g=o.useRef({position:new i.Vector3,rotation:new i.Euler,scale:new i.Vector3(1,1,1)});return o.useLayoutEffect((()=>{const e=(null==c?void 0:c.current)||p.current.parent,t=p.current;if(!(e instanceof i.Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(e){(0,s.k)(g.current,{position:u,scale:f});const n=e.matrixWorld.clone();if(e.matrixWorld.identity(),d&&"number"!==typeof d)(0,s.k)(g.current,{rotation:d});else{const t=new i.Object3D;t.position.copy(g.current.position);const n=e.geometry.attributes.position.array;void 0===e.geometry.attributes.normal&&e.geometry.computeVertexNormals();const r=e.geometry.attributes.normal.array;let o=1/0;new i.Vector3;let a=new i.Vector3;const c=t.position.x,l=t.position.y,u=t.position.z,f=n.length;let m=-1;for(let e=0;e<f;e+=3){const t=n[e]-c,r=n[e+1]-l,a=n[e+2]-u,i=t*t+r*r+a*a;i<o&&(o=i,m=e)}a.fromArray(r,m),t.lookAt(t.position.clone().add(a)),t.rotateZ(Math.PI),t.rotateY(Math.PI),"number"===typeof d&&t.rotateZ(d),(0,s.k)(g.current,{rotation:t.rotation})}return t.geometry=new mt.w(e,g.current.position,g.current.rotation,g.current.scale),e.matrixWorld=n,()=>{t.geometry.dispose()}}}),[c,...ht(u),...ht(f),...ht(d)]),o.useLayoutEffect((()=>{y.current&&((0,s.k)(y.current,g.current),y.current.traverse((e=>e.raycast=()=>null)))}),[e]),o.createElement("mesh",(0,r.A)({ref:p,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":n,"material-depthTest":t,"material-map":a},m),l,e&&o.createElement("mesh",{ref:y},o.createElement("boxGeometry",null),o.createElement("meshNormalMaterial",{wireframe:!0}),o.createElement("axesHelper",null)))}));var yt=n("N7Pa");const gt=(0,o.forwardRef)((function({src:e,skipFill:t,skipStrokes:n,fillMaterial:a,strokeMaterial:c,fillMeshProps:l,strokeMeshProps:u,...d},f){const m=(0,s.H)(yt.c,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),h=(0,o.useMemo)((()=>n?[]:m.paths.map((e=>{var t;return void 0===(null==(t=e.userData)?void 0:t.style.stroke)||"none"===e.userData.style.stroke?null:e.subPaths.map((t=>yt.c.pointsToStroke(t.getPoints(),e.userData.style)))}))),[m,n]);(0,o.useEffect)((()=>()=>h.forEach((e=>e&&e.map((e=>e.dispose()))))),[h]);let p=0;return o.createElement("object3D",(0,r.A)({ref:f},d),o.createElement("object3D",{scale:[1,-1,1]},m.paths.map(((e,s)=>{var d,f;return o.createElement(o.Fragment,{key:s},!t&&void 0!==(null==(d=e.userData)?void 0:d.style.fill)&&"none"!==e.userData.style.fill&&yt.c.createShapes(e).map(((t,n)=>o.createElement("mesh",(0,r.A)({key:n},l,{renderOrder:p++}),o.createElement("shapeGeometry",{args:[t]}),o.createElement("meshBasicMaterial",(0,r.A)({color:e.userData.style.fill,opacity:e.userData.style.fillOpacity,transparent:!0,side:i.DoubleSide,depthWrite:!1},a))))),!n&&void 0!==(null==(f=e.userData)?void 0:f.style.stroke)&&"none"!==e.userData.style.stroke&&e.subPaths.map(((t,n)=>o.createElement("mesh",(0,r.A)({key:n,geometry:h[s][n]},u,{renderOrder:p++}),o.createElement("meshBasicMaterial",(0,r.A)({color:e.userData.style.stroke,opacity:e.userData.style.strokeOpacity,transparent:!0,side:i.DoubleSide,depthWrite:!1},c))))))}))))}));var vt=n("D+O2"),xt=n("jJgd"),wt=n("RugN");let bt=null,Et="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Mt(e=!0,t=!0,n){return r=>{n&&n(r),e&&(bt||(bt=new vt.Z),bt.setDecoderPath("string"===typeof e?e:Et),r.setDRACOLoader(bt)),t&&r.setMeshoptDecoder("function"===typeof xt.f?(0,xt.f)():xt.f)}}const zt=(e,t,n,r)=>(0,s.H)(wt.B,e,Mt(t,n,r));zt.preload=(e,t,n,r)=>s.H.preload(wt.B,e,Mt(t,n,r)),zt.clear=e=>s.H.clear(wt.B,e),zt.setDecoderPath=e=>{Et=e};const St=o.forwardRef((({src:e,useDraco:t,useMeshOpt:n,extendLoader:a,...i},s)=>{const{scene:c}=zt(e,t,n,a);return o.createElement(st,(0,r.A)({ref:s},i,{object:c}))}));var Tt=n("V4Zg");function At({renderIndex:e=1,bgColor:t="black",fgColor:n="white",characters:r=" .:-+*=%@#",invert:a=!0,color:i=!1,resolution:c=.15}){const{size:l,gl:u,scene:d,camera:f}=(0,s.D)(),m=o.useMemo((()=>{const e=new Tt.f(u,r,{invert:a,color:i,resolution:c});return e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.pointerEvents="none",e}),[r,a,i,c]);return o.useLayoutEffect((()=>{m.domElement.style.color=n,m.domElement.style.backgroundColor=t}),[n,t]),o.useEffect((()=>(u.domElement.style.opacity="0",u.domElement.parentNode.appendChild(m.domElement),()=>{u.domElement.style.opacity="1",u.domElement.parentNode.removeChild(m.domElement)})),[m]),o.useEffect((()=>{m.setSize(l.width,l.height)}),[m,l]),(0,s.F)((e=>{m.render(d,f)}),e),o.createElement(o.Fragment,null)}const _t=Ue({alphaTest:0,viewport:new i.Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},"\n    precision highp sampler2D;\n    precision highp usampler2D;\n    out vec4 vColor;\n    out vec3 vPosition;\n    uniform vec2 resolution;\n    uniform vec2 viewport;\n    uniform float focal;\n    attribute uint splatIndex;\n    uniform sampler2D centerAndScaleTexture;\n    uniform usampler2D covAndColorTexture;    \n\n    vec2 unpackInt16(in uint value) {\n      int v = int(value);\n      int v0 = v >> 16;\n      int v1 = (v & 0xFFFF);\n      if((v & 0x8000) != 0)\n        v1 |= 0xFFFF0000;\n      return vec2(float(v1), float(v0));\n    }\n\n    void main () {\n      ivec2 texSize = textureSize(centerAndScaleTexture, 0);\n      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));\n      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);\n      vec4 center = vec4(centerAndScaleData.xyz, 1);\n      vec4 camspace = modelViewMatrix * center;\n      vec4 pos2d = projectionMatrix * camspace;\n\n      float bounds = 1.2 * pos2d.w;\n      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds\n        || pos2d.y < -bounds || pos2d.y > bounds) {\n        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);\n        return;\n      }\n\n      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);\n      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;\n      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;\n      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;\n      mat3 Vrk = mat3(\n        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,\n        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,\n        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y\n      );\n\n      mat3 J = mat3(\n        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),\n        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),\n        0., 0., 0.\n      );\n\n      mat3 W = transpose(mat3(modelViewMatrix));\n      mat3 T = W * J;\n      mat3 cov = transpose(T) * Vrk * T;\n      vec2 vCenter = vec2(pos2d) / pos2d.w;\n      float diagonal1 = cov[0][0] + 0.3;\n      float offDiagonal = cov[0][1];\n      float diagonal2 = cov[1][1] + 0.3;\n      float mid = 0.5 * (diagonal1 + diagonal2);\n      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));\n      float lambda1 = mid + radius;\n      float lambda2 = max(mid - radius, 0.1);\n      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));\n      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;\n      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);\n      uint colorUint = covAndColorData.w;\n      vColor = vec4(\n        float(colorUint & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,\n        float(colorUint >> uint(24)) / 255.0\n      );\n      vPosition = position;\n\n      gl_Position = vec4(\n        vCenter \n          + position.x * v2 / viewport * 2.0 \n          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);\n    }\n    ",`\n    #include <alphatest_pars_fragment>\n    #include <alphahash_pars_fragment>\n    in vec4 vColor;\n    in vec3 vPosition;\n    void main () {\n      float A = -dot(vPosition.xy, vPosition.xy);\n      if (A < -4.0) discard;\n      float B = exp(A) * vColor.a;\n      vec4 diffuseColor = vec4(vColor.rgb, B);\n      #include <alphatest_fragment>\n      #include <alphahash_fragment>\n      gl_FragColor = diffuseColor;\n      #include <tonemapping_fragment>\n      #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `);function Dt(e){let t=null,n=0;e.onmessage=r=>{if("push"==r.data.method){0===n&&(t=new Float32Array(r.data.length));const e=new Float32Array(r.data.matrices);t.set(e,n),n+=e.length}else if("sort"==r.data.method&&null!==t){const n=function(e,n=!1){const r=t.length/16;let o=-1/0,a=1/0;const i=new Float32Array(r),s=new Int32Array(i.buffer),c=new Int32Array(r);let l=0;for(let h=0;h<r;h++){const r=e[0]*t[16*h+12]+e[1]*t[16*h+13]+e[2]*t[16*h+14]+e[3];(n||r<0&&t[16*h+15]>-1e-4*r)&&(i[l]=r,c[l]=h,l++,r>o&&(o=r),r<a&&(a=r))}const u=65535/(o-a),d=new Uint32Array(65536);for(let t=0;t<l;t++)s[t]=(i[t]-a)*u|0,d[s[t]]++;const f=new Uint32Array(65536);for(let t=1;t<65536;t++)f[t]=f[t-1]+d[t-1];const m=new Uint32Array(l);for(let t=0;t<l;t++)m[f[s[t]]++]=c[t];return m}(new Float32Array(r.data.view),r.data.hashed);e.postMessage({indices:n,key:r.data.key},[n.buffer])}}}class Pt extends i.Loader{constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}load(e,t,n,r){const o={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",Dt.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(e,t,n)=>function(e,t,n,r){if(e.updateMatrixWorld(),t.gl.getCurrentViewport(n.viewport),n.material.viewport.x=n.viewport.z,n.material.viewport.y=n.viewport.w,n.material.focal=n.viewport.w/2*Math.abs(e.projectionMatrix.elements[5]),n.ready){if(r&&n.sorted)return;n.ready=!1;const e=new Float32Array([n.modelViewMatrix.elements[2],-n.modelViewMatrix.elements[6],n.modelViewMatrix.elements[10],n.modelViewMatrix.elements[14]]);t.worker.postMessage({method:"sort",src:t.url,key:n.uuid,view:e.buffer,hashed:r},[e.buffer]),r&&t.loaded&&(n.sorted=!0)}}(t,o,e,n),connect:e=>function(e,t){e.loading||async function(e){e.loading=!0;let t=0,n=0;const r=[];let o=0;const a=0!==e.totalDownloadBytes;for(;;)try{const{value:i,done:s}=await e.stream.read();if(s)break;if(t+=i.length,void 0!=e.totalDownloadBytes){const n=t/e.totalDownloadBytes*100;if(e.onProgress&&n-o>1){const r=new ProgressEvent("progress",{lengthComputable:a,loaded:t,total:e.totalDownloadBytes});e.onProgress(r),o=n}}r.push(i);const c=t-n;if(void 0!=e.totalDownloadBytes&&c>e.rowLength*e.chunkSize){let t=Math.floor(c/e.rowLength);const o=new Uint8Array(c);let i=0;for(const e of r)o.set(e,i),i+=e.length;if(r.length=0,c>t*e.rowLength){const n=new Uint8Array(c-t*e.rowLength);n.set(o.subarray(c-n.length,c),0),r.push(n)}const s=new Uint8Array(t*e.rowLength);s.set(o.subarray(0,s.byteLength),0);const l=Ct(e,s.buffer,t);if(e.worker.postMessage({method:"push",src:e.url,length:16*e.numVertices,matrices:l.buffer},[l.buffer]),n+=t*e.rowLength,e.onProgress){const t=new ProgressEvent("progress",{lengthComputable:a,loaded:e.totalDownloadBytes,total:e.totalDownloadBytes});e.onProgress(t)}}}catch(i){break}if(t-n>0){let t=new Uint8Array(r.reduce(((e,t)=>e+t.length),0)),n=0;for(const e of r)t.set(e,n),n+=e.length;let o=Math.floor(t.byteLength/e.rowLength);const a=Ct(e,t.buffer,o);e.worker.postMessage({method:"push",src:e.url,length:16*o,matrices:a.buffer},[a.buffer])}e.loaded=!0,e.manager.itemEnd(e.url)}(e),t.ready=!1,t.pm=new i.Matrix4,t.vm1=new i.Matrix4,t.vm2=new i.Matrix4,t.viewport=new i.Vector4;let n=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight);const r=new i.InstancedBufferAttribute(n,1,!1);r.setUsage(i.DynamicDrawUsage);const o=t.geometry=new i.InstancedBufferGeometry,a=new Float32Array(18),s=new i.BufferAttribute(a,3);function c(e){if(t&&e.data.key===t.uuid){let n=new Uint32Array(e.data.indices);o.attributes.splatIndex.set(n),o.attributes.splatIndex.needsUpdate=!0,o.instanceCount=n.length,t.ready=!0}}return o.setAttribute("position",s),s.setXYZ(2,-2,2,0),s.setXYZ(1,2,2,0),s.setXYZ(0,-2,-2,0),s.setXYZ(5,-2,-2,0),s.setXYZ(4,2,2,0),s.setXYZ(3,2,-2,0),s.needsUpdate=!0,o.setAttribute("splatIndex",r),o.instanceCount=1,e.worker.addEventListener("message",c),async function(){for(;;){const t=e.gl.properties.get(e.centerAndScaleTexture),n=e.gl.properties.get(e.covAndColorTexture);if(null!=t&&t.__webglTexture&&null!=n&&n.__webglTexture&&e.loadedVertexCount>0)break;await new Promise((e=>setTimeout(e,10)))}t.ready=!0}(),()=>e.worker.removeEventListener("message",c)}(o,e),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:n};(async function(e){e.manager.itemStart(e.url);const t=await fetch(e.url);if(null===t.body)throw"Failed to fetch file";let n=t.headers.get("Content-Length");const r=n?parseInt(n):void 0;if(void 0==r)throw"Failed to get content length";e.stream=t.body.getReader(),e.totalDownloadBytes=r,e.numVertices=Math.floor(e.totalDownloadBytes/e.rowLength);const o=e.gl.getContext();let a=o.getParameter(o.MAX_TEXTURE_SIZE);return e.maxVertexes=a*a,e.numVertices>e.maxVertexes&&(e.numVertices=e.maxVertexes),e.bufferTextureWidth=a,e.bufferTextureHeight=Math.floor((e.numVertices-1)/a)+1,e.centerAndScaleData=new Float32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.covAndColorData=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.centerAndScaleTexture=new i.DataTexture(e.centerAndScaleData,e.bufferTextureWidth,e.bufferTextureHeight,i.RGBAFormat,i.FloatType),e.centerAndScaleTexture.needsUpdate=!0,e.covAndColorTexture=new i.DataTexture(e.covAndColorData,e.bufferTextureWidth,e.bufferTextureHeight,i.RGBAIntegerFormat,i.UnsignedIntType),e.covAndColorTexture.internalFormat="RGBA32UI",e.covAndColorTexture.needsUpdate=!0,e})(o).then(t).catch((e=>{null==r||r(e),o.manager.itemError(o.url)}))}}function Ct(e,t,n){const r=e.gl.getContext();if(e.loadedVertexCount+n>e.maxVertexes&&(n=e.maxVertexes-e.loadedVertexCount),n<=0)throw"Failed to parse file";const o=new Uint8Array(t),a=new Float32Array(t),s=new Float32Array(16*n),c=new Uint8Array(e.covAndColorData.buffer),l=new Int16Array(e.covAndColorData.buffer);for(let u=0;u<n;u++){const t=new i.Quaternion(-(o[32*u+28+1]-128)/128,(o[32*u+28+2]-128)/128,(o[32*u+28+3]-128)/128,-(o[32*u+28+0]-128)/128);t.invert();const n=new i.Vector3(a[8*u+0],a[8*u+1],-a[8*u+2]),r=new i.Vector3(a[8*u+3+0],a[8*u+3+1],a[8*u+3+2]),d=new i.Matrix4;d.makeRotationFromQuaternion(t),d.transpose(),d.scale(r);const f=d.clone();d.transpose(),d.premultiply(f),d.setPosition(n);const m=[0,1,2,5,6,10];let h=0;for(let e=0;e<m.length;e++)Math.abs(d.elements[m[e]])>h&&(h=Math.abs(d.elements[m[e]]));let p=4*e.loadedVertexCount+4*u;e.centerAndScaleData[p+0]=n.x,e.centerAndScaleData[p+1]=-n.y,e.centerAndScaleData[p+2]=n.z,e.centerAndScaleData[p+3]=h/32767,p=8*e.loadedVertexCount+4*u*2;for(let e=0;e<m.length;e++)l[p+e]=32767*d.elements[m[e]]/h;p=16*e.loadedVertexCount+4*(4*u+3);const y=new i.Color(o[32*u+24+0]/255,o[32*u+24+1]/255,o[32*u+24+2]/255);y.convertSRGBToLinear(),c[p+0]=255*y.r,c[p+1]=255*y.g,c[p+2]=255*y.b,c[p+3]=o[32*u+24+3],d.elements[15]=Math.max(r.x,r.y,r.z)*o[32*u+24+3]/255;for(let e=0;e<16;e++)s[16*u+e]=d.elements[e]}for(;n>0;){let t=0,o=0;const a=e.loadedVertexCount%e.bufferTextureWidth,i=Math.floor(e.loadedVertexCount/e.bufferTextureWidth);e.loadedVertexCount%e.bufferTextureWidth!=0?(t=Math.min(e.bufferTextureWidth,a+n)-a,o=1):Math.floor(n/e.bufferTextureWidth)>0?(t=e.bufferTextureWidth,o=Math.floor(n/e.bufferTextureWidth)):(t=n%e.bufferTextureWidth,o=1);const s=e.gl.properties.get(e.centerAndScaleTexture);r.bindTexture(r.TEXTURE_2D,s.__webglTexture),r.texSubImage2D(r.TEXTURE_2D,0,a,i,t,o,r.RGBA,r.FLOAT,e.centerAndScaleData,4*e.loadedVertexCount);const c=e.gl.properties.get(e.covAndColorTexture);r.bindTexture(r.TEXTURE_2D,c.__webglTexture),r.texSubImage2D(r.TEXTURE_2D,0,a,i,t,o,r.RGBA_INTEGER,r.UNSIGNED_INT,e.covAndColorData,4*e.loadedVertexCount),e.gl.resetState(),e.loadedVertexCount+=t*o,n-=t*o}return s}function Rt({src:e,toneMapped:t=!1,alphaTest:n=0,alphaHash:a=!1,chunkSize:c=25e3,...l}){(0,s.e)({SplatMaterial:_t});const u=o.useRef(null),d=(0,s.D)((e=>e.gl)),f=(0,s.D)((e=>e.camera)),m=(0,s.H)(Pt,e,(e=>{e.gl=d,e.chunkSize=c}));return o.useLayoutEffect((()=>m.connect(u.current)),[e]),(0,s.F)((()=>m.update(u.current,f,a))),o.createElement("mesh",(0,r.A)({ref:u,frustumCulled:!1},l),o.createElement("splatMaterial",{key:`${e}/${n}/${a}${_t.key}`,transparent:!a,depthTest:!0,alphaTest:a?0:n,centerAndScaleTexture:m.centerAndScaleTexture,covAndColorTexture:m.covAndColorTexture,depthWrite:!!a||n>0,blending:a?i.NormalBlending:i.CustomBlending,blendSrcAlpha:i.OneFactor,alphaHash:!!a,toneMapped:t}))}function Ft(e,t,n){const r=(0,s.D)((e=>e.size)),a=(0,s.D)((e=>e.viewport)),c="number"===typeof e?e:r.width*a.dpr,l="number"===typeof t?t:r.height*a.dpr,u=("number"===typeof e?n:e)||{},{samples:d=0,depth:f,...m}=u,h=o.useMemo((()=>{const e=new i.WebGLRenderTarget(c,l,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,type:i.HalfFloatType,...m});return f&&(e.depthTexture=new i.DepthTexture(c,l,i.FloatType)),e.samples=d,e}),[]);return o.useLayoutEffect((()=>{h.setSize(c,l),d&&(h.samples=d)}),[d,h,c,l]),o.useEffect((()=>()=>h.dispose()),[]),h}const kt=({children:e,width:t,height:n,...r})=>{const a=Ft(t,n,r);return o.createElement(o.Fragment,null,null==e?void 0:e(a))},Bt=o.forwardRef((({envMap:e,resolution:t=256,frames:n=1/0,children:a,makeDefault:i,...c},l)=>{const u=(0,s.D)((({set:e})=>e)),d=(0,s.D)((({camera:e})=>e)),f=(0,s.D)((({size:e})=>e)),m=o.useRef(null);o.useImperativeHandle(l,(()=>m.current),[]);const h=o.useRef(null),p=Ft(t);o.useLayoutEffect((()=>{c.manual||m.current.updateProjectionMatrix()}),[f,c]),o.useLayoutEffect((()=>{m.current.updateProjectionMatrix()})),o.useLayoutEffect((()=>{if(i){const e=d;return u((()=>({camera:m.current}))),()=>u((()=>({camera:e})))}}),[m,i,u]);let y=0,g=null;const v="function"===typeof a;return(0,s.F)((t=>{v&&(n===1/0||y<n)&&(h.current.visible=!1,t.gl.setRenderTarget(p),g=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,m.current),t.scene.background=g,t.gl.setRenderTarget(null),h.current.visible=!0,y++)})),o.createElement(o.Fragment,null,o.createElement("orthographicCamera",(0,r.A)({left:f.width/-2,right:f.width/2,top:f.height/2,bottom:f.height/-2,ref:m},c),!v&&a),o.createElement("group",{ref:h},v&&a(p.texture)))})),It=o.forwardRef((({envMap:e,resolution:t=256,frames:n=1/0,makeDefault:a,children:i,...c},l)=>{const u=(0,s.D)((({set:e})=>e)),d=(0,s.D)((({camera:e})=>e)),f=(0,s.D)((({size:e})=>e)),m=o.useRef(null);o.useImperativeHandle(l,(()=>m.current),[]);const h=o.useRef(null),p=Ft(t);o.useLayoutEffect((()=>{c.manual||(m.current.aspect=f.width/f.height)}),[f,c]),o.useLayoutEffect((()=>{m.current.updateProjectionMatrix()}));let y=0,g=null;const v="function"===typeof i;return(0,s.F)((t=>{v&&(n===1/0||y<n)&&(h.current.visible=!1,t.gl.setRenderTarget(p),g=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,m.current),t.scene.background=g,t.gl.setRenderTarget(null),h.current.visible=!0,y++)})),o.useLayoutEffect((()=>{if(a){const e=d;return u((()=>({camera:m.current}))),()=>u((()=>({camera:e})))}}),[m,a,u]),o.createElement(o.Fragment,null,o.createElement("perspectiveCamera",(0,r.A)({ref:m},c),!v&&i),o.createElement("group",{ref:h},v&&i(p.texture)))}));function Lt({resolution:e=256,near:t=.1,far:n=1e3,envMap:r,fog:a}={}){const c=(0,s.D)((({gl:e})=>e)),l=(0,s.D)((({scene:e})=>e)),u=(0,o.useMemo)((()=>{const t=new i.WebGLCubeRenderTarget(e);return t.texture.type=i.HalfFloatType,t}),[e]);(0,o.useEffect)((()=>()=>{u.dispose()}),[u]);const d=(0,o.useMemo)((()=>new i.CubeCamera(t,n,u)),[t,n,u]);let f,m;const h=o.useCallback((()=>{f=l.fog,m=l.background,l.background=r||m,l.fog=a||f,d.update(c,l),l.fog=f,l.background=m}),[c,l,d]);return{fbo:u,camera:d,update:h}}function Ut({children:e,frames:t=1/0,resolution:n,near:r,far:a,envMap:i,fog:c,...l}){const u=o.useRef(null),{fbo:d,camera:f,update:m}=Lt({resolution:n,near:r,far:a,envMap:i,fog:c});let h=0;return(0,s.F)((()=>{u.current&&(t===1/0||h<t)&&(u.current.visible=!1,m(),u.current.visible=!0,h++)})),o.createElement("group",l,o.createElement("primitive",{object:f}),o.createElement("group",{ref:u},null==e?void 0:e(d.texture)))}var Ot=n("SKFb");const Nt=o.forwardRef(((e,t)=>{const{camera:n,onChange:a,makeDefault:i,...c}=e,l=(0,s.D)((e=>e.camera)),u=(0,s.D)((e=>e.invalidate)),d=(0,s.D)((e=>e.get)),f=(0,s.D)((e=>e.set)),m=n||l,h=o.useMemo((()=>new Ot.n(m)),[m]);return o.useEffect((()=>{const e=e=>{u(),a&&a(e)};return null==h||null==h.addEventListener||h.addEventListener("change",e),()=>null==h||null==h.removeEventListener?void 0:h.removeEventListener("change",e)}),[a,h,u]),(0,s.F)((()=>null==h?void 0:h.update()),-1),o.useEffect((()=>{const e=h;return null==e||e.connect(),()=>null==e?void 0:e.dispose()}),[h]),o.useEffect((()=>{if(i){const e=d().controls;return f({controls:h}),()=>f({controls:e})}}),[i,h]),h?o.createElement("primitive",(0,r.A)({ref:t,object:h},c)):null}));var Vt=n("gL+i");const jt=o.forwardRef((({domElement:e,...t},n)=>{const{onChange:a,makeDefault:i,...c}=t,l=(0,s.D)((e=>e.invalidate)),u=(0,s.D)((e=>e.camera)),d=(0,s.D)((e=>e.gl)),f=(0,s.D)((e=>e.events)),m=(0,s.D)((e=>e.get)),h=(0,s.D)((e=>e.set)),p=e||f.connected||d.domElement,y=o.useMemo((()=>new Vt.o(u)),[u]);return o.useEffect((()=>(y.connect(p),()=>{y.dispose()})),[p,y,l]),o.useEffect((()=>{const e=e=>{l(),a&&a(e)};return null==y.addEventListener||y.addEventListener("change",e),()=>null==y.removeEventListener?void 0:y.removeEventListener("change",e)}),[a,l]),o.useEffect((()=>{if(i){const e=m().controls;return h({controls:y}),()=>h({controls:e})}}),[i,y]),(0,s.F)(((e,t)=>y.update(t))),o.createElement("primitive",(0,r.A)({ref:n,object:y,args:[u,p]},c))}));var Gt=n("imZL");const Wt=o.forwardRef(((e={enableDamping:!0},t)=>{const{domElement:n,camera:a,makeDefault:i,onChange:c,onStart:l,onEnd:u,...d}=e,f=(0,s.D)((e=>e.invalidate)),m=(0,s.D)((e=>e.camera)),h=(0,s.D)((e=>e.gl)),p=(0,s.D)((e=>e.events)),y=(0,s.D)((e=>e.set)),g=(0,s.D)((e=>e.get)),v=n||p.connected||h.domElement,x=a||m,w=o.useMemo((()=>new Gt.r(x)),[x]);return o.useEffect((()=>{w.connect(v);const e=e=>{f(),c&&c(e)};return w.addEventListener("change",e),l&&w.addEventListener("start",l),u&&w.addEventListener("end",u),()=>{w.dispose(),w.removeEventListener("change",e),l&&w.removeEventListener("start",l),u&&w.removeEventListener("end",u)}}),[c,l,u,w,f,v]),o.useEffect((()=>{if(i){const e=g().controls;return y({controls:w}),()=>y({controls:e})}}),[i,w]),(0,s.F)((()=>w.update()),-1),o.createElement("primitive",(0,r.A)({ref:t,object:w,enableDamping:!0},d))})),Ht=o.forwardRef((({makeDefault:e,camera:t,regress:n,domElement:a,enableDamping:i=!0,keyEvents:c=!1,onChange:l,onStart:u,onEnd:d,...f},m)=>{const h=(0,s.D)((e=>e.invalidate)),p=(0,s.D)((e=>e.camera)),y=(0,s.D)((e=>e.gl)),g=(0,s.D)((e=>e.events)),v=(0,s.D)((e=>e.setEvents)),x=(0,s.D)((e=>e.set)),w=(0,s.D)((e=>e.get)),b=(0,s.D)((e=>e.performance)),E=t||p,M=a||g.connected||y.domElement,z=o.useMemo((()=>new Gt.N(E)),[E]);return(0,s.F)((()=>{z.enabled&&z.update()}),-1),o.useEffect((()=>(c&&z.connect(!0===c?M:c),z.connect(M),()=>{z.dispose()})),[c,M,n,z,h]),o.useEffect((()=>{const e=e=>{h(),n&&b.regress(),l&&l(e)},t=e=>{u&&u(e)},r=e=>{d&&d(e)};return z.addEventListener("change",e),z.addEventListener("start",t),z.addEventListener("end",r),()=>{z.removeEventListener("start",t),z.removeEventListener("end",r),z.removeEventListener("change",e)}}),[l,u,d,z,h,v]),o.useEffect((()=>{if(e){const e=w().controls;return x({controls:z}),()=>x({controls:e})}}),[e,z]),o.createElement("primitive",(0,r.A)({ref:m,object:z,enableDamping:i},f))}));var Xt=n("VRiI");const qt=o.forwardRef((({makeDefault:e,camera:t,domElement:n,regress:a,onChange:i,onStart:c,onEnd:l,...u},d)=>{const{invalidate:f,camera:m,gl:h,events:p,set:y,get:g,performance:v,viewport:x}=(0,s.D)(),w=t||m,b=n||p.connected||h.domElement,E=o.useMemo((()=>new Xt.V(w)),[w]);return(0,s.F)((()=>{E.enabled&&E.update()}),-1),o.useEffect((()=>(E.connect(b),()=>{E.dispose()})),[b,a,E,f]),o.useEffect((()=>{const e=e=>{f(),a&&v.regress(),i&&i(e)};return E.addEventListener("change",e),c&&E.addEventListener("start",c),l&&E.addEventListener("end",l),()=>{c&&E.removeEventListener("start",c),l&&E.removeEventListener("end",l),E.removeEventListener("change",e)}}),[i,c,l,E,f]),o.useEffect((()=>{E.handleResize()}),[x]),o.useEffect((()=>{if(e){const e=g().controls;return y({controls:E}),()=>y({controls:e})}}),[e,E]),o.createElement("primitive",(0,r.A)({ref:d,object:E},u))}));var $t=n("UQVQ");const Yt=(0,o.forwardRef)((({camera:e,makeDefault:t,regress:n,domElement:a,onChange:i,onStart:c,onEnd:l,...u},d)=>{const f=(0,s.D)((e=>e.invalidate)),m=(0,s.D)((e=>e.camera)),h=(0,s.D)((e=>e.gl)),p=(0,s.D)((e=>e.events)),y=(0,s.D)((e=>e.set)),g=(0,s.D)((e=>e.get)),v=(0,s.D)((e=>e.performance)),x=e||m,w=a||p.connected||h.domElement,b=(0,o.useMemo)((()=>new $t.q(x)),[x]);return(0,s.F)((()=>{b.enabled&&b.update()}),-1),(0,o.useEffect)((()=>(b.connect(w),()=>{b.dispose()})),[w,n,b,f]),(0,o.useEffect)((()=>{const e=e=>{f(),n&&v.regress(),i&&i(e)};return b.addEventListener("change",e),c&&b.addEventListener("start",c),l&&b.addEventListener("end",l),()=>{b.removeEventListener("change",e),c&&b.removeEventListener("start",c),l&&b.removeEventListener("end",l)}}),[i,c,l]),(0,o.useEffect)((()=>{if(t){const e=g().controls;return y({controls:b}),()=>y({controls:e})}}),[t,b]),o.createElement("primitive",(0,r.A)({ref:d,object:b},u))}));var Kt=n("H80w");const Zt=o.forwardRef((({children:e,domElement:t,onChange:n,onMouseDown:a,onMouseUp:c,onObjectChange:l,object:u,makeDefault:d,camera:f,enabled:m,axis:h,mode:p,translationSnap:y,rotationSnap:g,scaleSnap:v,space:x,size:w,showX:b,showY:E,showZ:M,...z},S)=>{const T=(0,s.D)((e=>e.controls)),A=(0,s.D)((e=>e.gl)),_=(0,s.D)((e=>e.events)),D=(0,s.D)((e=>e.camera)),P=(0,s.D)((e=>e.invalidate)),C=(0,s.D)((e=>e.get)),R=(0,s.D)((e=>e.set)),F=f||D,k=t||_.connected||A.domElement,B=o.useMemo((()=>new Kt.ZU(F,k)),[F,k]),I=o.useRef(null);o.useLayoutEffect((()=>(u?B.attach(u instanceof i.Object3D?u:u.current):I.current instanceof i.Object3D&&B.attach(I.current),()=>{B.detach()})),[u,e,B]),o.useEffect((()=>{if(T){const e=e=>T.enabled=!e.value;return B.addEventListener("dragging-changed",e),()=>B.removeEventListener("dragging-changed",e)}}),[B,T]);const L=o.useRef(),U=o.useRef(),O=o.useRef(),N=o.useRef();return o.useLayoutEffect((()=>{L.current=n}),[n]),o.useLayoutEffect((()=>{U.current=a}),[a]),o.useLayoutEffect((()=>{O.current=c}),[c]),o.useLayoutEffect((()=>{N.current=l}),[l]),o.useEffect((()=>{const e=e=>{P(),null==L.current||L.current(e)},t=e=>null==U.current?void 0:U.current(e),n=e=>null==O.current?void 0:O.current(e),r=e=>null==N.current?void 0:N.current(e);return B.addEventListener("change",e),B.addEventListener("mouseDown",t),B.addEventListener("mouseUp",n),B.addEventListener("objectChange",r),()=>{B.removeEventListener("change",e),B.removeEventListener("mouseDown",t),B.removeEventListener("mouseUp",n),B.removeEventListener("objectChange",r)}}),[P,B]),o.useEffect((()=>{if(d){const e=C().controls;return R({controls:B}),()=>R({controls:e})}}),[d,B]),o.createElement(o.Fragment,null,o.createElement("primitive",{ref:S,object:B,enabled:m,axis:h,mode:p,translationSnap:y,rotationSnap:g,scaleSnap:v,space:x,size:w,showX:b,showY:E,showZ:M}),o.createElement("group",(0,r.A)({ref:I},z),e))}));var Qt=n("eBGR");const Jt=o.forwardRef((({domElement:e,selector:t,onChange:n,onLock:a,onUnlock:i,enabled:c=!0,makeDefault:l,...u},d)=>{const{camera:f,...m}=u,h=(0,s.D)((e=>e.setEvents)),p=(0,s.D)((e=>e.gl)),y=(0,s.D)((e=>e.camera)),g=(0,s.D)((e=>e.invalidate)),v=(0,s.D)((e=>e.events)),x=(0,s.D)((e=>e.get)),w=(0,s.D)((e=>e.set)),b=f||y,E=e||v.connected||p.domElement,M=o.useMemo((()=>new Qt.Z(b)),[b]);return o.useEffect((()=>{if(c){M.connect(E);const e=x().events.compute;return h({compute(e,t){const n=t.size.width/2,r=t.size.height/2;t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{M.disconnect(),h({compute:e})}}}),[c,M]),o.useEffect((()=>{const e=e=>{g(),n&&n(e)};M.addEventListener("change",e),a&&M.addEventListener("lock",a),i&&M.addEventListener("unlock",i);const r=()=>M.lock(),o=t?Array.from(document.querySelectorAll(t)):[document];return o.forEach((e=>e&&e.addEventListener("click",r))),()=>{M.removeEventListener("change",e),a&&M.removeEventListener("lock",a),i&&M.removeEventListener("unlock",i),o.forEach((e=>e?e.removeEventListener("click",r):void 0))}}),[n,a,i,t,M,g]),o.useEffect((()=>{if(l){const e=x().controls;return w({controls:M}),()=>w({controls:e})}}),[l,M]),o.createElement("primitive",(0,r.A)({ref:d,object:M},m))}));var en=n("aqsf");const tn=o.forwardRef((({domElement:e,makeDefault:t,...n},a)=>{const i=(0,s.D)((e=>e.camera)),c=(0,s.D)((e=>e.gl)),l=(0,s.D)((e=>e.events)),u=(0,s.D)((e=>e.get)),d=(0,s.D)((e=>e.set)),f=e||l.connected||c.domElement,[m]=o.useState((()=>new en.W(i,f)));return o.useEffect((()=>{if(t){const e=u().controls;return d({controls:m}),()=>d({controls:e})}}),[t,m]),(0,s.F)(((e,t)=>{m.update(t)}),-1),m?o.createElement("primitive",(0,r.A)({ref:a,object:m},n)):null}));var nn=n("pVCM");const rn=(0,o.forwardRef)(((e,t)=>{(0,o.useMemo)((()=>{const e={Box3:i.Box3,MathUtils:{clamp:i.MathUtils.clamp},Matrix4:i.Matrix4,Quaternion:i.Quaternion,Raycaster:i.Raycaster,Sphere:i.Sphere,Spherical:i.Spherical,Vector2:i.Vector2,Vector3:i.Vector3,Vector4:i.Vector4};nn.A.install({THREE:e}),(0,s.e)({CameraControlsImpl:nn.A})}),[]);const{camera:n,domElement:a,makeDefault:c,onStart:l,onEnd:u,onChange:d,regress:f,...m}=e,h=(0,s.D)((e=>e.camera)),p=(0,s.D)((e=>e.gl)),y=(0,s.D)((e=>e.invalidate)),g=(0,s.D)((e=>e.events)),v=(0,s.D)((e=>e.setEvents)),x=(0,s.D)((e=>e.set)),w=(0,s.D)((e=>e.get)),b=(0,s.D)((e=>e.performance)),E=n||h,M=a||g.connected||p.domElement,z=(0,o.useMemo)((()=>new nn.A(E)),[E]);return(0,s.F)(((e,t)=>{z.enabled&&z.update(t)}),-1),(0,o.useEffect)((()=>(z.connect(M),()=>{z.disconnect()})),[M,z]),(0,o.useEffect)((()=>{const e=e=>{y(),f&&b.regress(),d&&d(e)},t=e=>{l&&l(e)},n=e=>{u&&u(e)};return z.addEventListener("update",e),z.addEventListener("controlstart",t),z.addEventListener("controlend",n),z.addEventListener("control",e),z.addEventListener("transitionstart",e),z.addEventListener("wake",e),()=>{z.removeEventListener("update",e),z.removeEventListener("controlstart",t),z.removeEventListener("controlend",n),z.removeEventListener("control",e),z.removeEventListener("transitionstart",e),z.removeEventListener("wake",e)}}),[z,l,u,y,v,f,d]),(0,o.useEffect)((()=>{if(c){const e=w().controls;return x({controls:z}),()=>x({controls:e})}}),[c,z]),o.createElement("primitive",(0,r.A)({ref:t,object:z},m))})),on=o.createContext(null);function an(){const e=o.useContext(on);if(!e)throw new Error("useMotion hook must be used in a MotionPathControls component.");return e}function sn({points:e=50,color:t="black"}){const{path:n}=an(),[r,a]=o.useState([]),s=o.useMemo((()=>new i.MeshBasicMaterial({color:t})),[t]),c=o.useMemo((()=>new i.SphereGeometry(.025,16,16)),[]),l=o.useRef([]);return o.useEffect((()=>{n.curves!==l.current&&(a(n.getPoints(e)),l.current=n.curves)})),r.map(((e,t)=>o.createElement("mesh",{key:t,material:s,geometry:c,position:[e.x,e.y,e.z]})))}const cn=o.forwardRef((({children:e,curves:t=[],debug:n=!1,debugColor:a="black",object:c,focus:l,loop:u=!0,offset:d,smooth:f=!1,eps:m=1e-5,damping:h=.1,focusDamping:p=.1,maxSpeed:y=1/0,...g},v)=>{const{camera:x}=(0,s.D)(),w=o.useRef(null),b=o.useRef(null!==d&&void 0!==d?d:0),E=o.useMemo((()=>new i.CurvePath),[]),M=o.useMemo((()=>({focus:l,object:(null==c?void 0:c.current)instanceof i.Object3D?c:{current:x},path:E,current:b.current,offset:b.current,point:new i.Vector3,tangent:new i.Vector3,next:new i.Vector3})),[l,c]);o.useLayoutEffect((()=>{var e,n;E.curves=[];const r=t.length>0?t:null!==(e=null==(n=w.current)||null==(n=n.__r3f)?void 0:n.objects)&&void 0!==e?e:[];for(let t=0;t<r.length;t++)E.add(r[t]);if(f){const e=E.getPoints("number"===typeof f?f:1),t=new i.CatmullRomCurve3(e);E.curves=[t]}E.updateArcLengths()})),o.useImperativeHandle(v,(()=>Object.assign(w.current,{motion:M})),[M]),o.useLayoutEffect((()=>{b.current=B.Lr.repeat(b.current,1)}),[d]);const z=o.useMemo((()=>new i.Vector3),[]);return(0,s.F)(((e,t)=>{const n=M.offset;if(B.cz.damp(b,"current",void 0!==d?d:M.current,h,t,y,void 0,m),M.offset=u?B.Lr.repeat(b.current,1):B.Lr.clamp(b.current,0,1),E.getCurveLengths().length>0){E.getPointAt(M.offset,M.point),E.getTangentAt(M.offset,M.tangent).normalize(),E.getPointAt(B.Lr.repeat(b.current-(n-M.offset),1),M.next);const e=(null==c?void 0:c.current)instanceof i.Object3D?c.current:x;e.position.copy(M.point),l&&B.cz.dampLookAt(e,(e=>(null==e?void 0:e.current)instanceof i.Object3D)(l)?l.current.getWorldPosition(z):l,p,t,y,void 0,m)}})),o.createElement("group",(0,r.A)({ref:w},g),o.createElement(on.Provider,{value:M},e,n&&o.createElement(sn,{color:a})))}));function ln({defaultScene:e,defaultCamera:t,renderPriority:n=1}){const{gl:r,scene:a,camera:i}=(0,s.D)();let c;return(0,s.F)((()=>{c=r.autoClear,1===n&&(r.autoClear=!0,r.render(e,t)),r.autoClear=!1,r.clearDepth(),r.render(a,i),r.autoClear=c}),n),o.createElement("group",{onPointerOver:()=>null})}function un({children:e,renderPriority:t=1}){const{scene:n,camera:r}=(0,s.D)(),[a]=o.useState((()=>new i.Scene));return o.createElement(o.Fragment,null,(0,s.h)(o.createElement(o.Fragment,null,e,o.createElement(ln,{defaultScene:n,defaultCamera:r,renderPriority:t})),a,{events:{priority:t+1}}))}const dn=o.createContext({}),fn=()=>o.useContext(dn),mn=2*Math.PI,hn=new i.Object3D,pn=new i.Matrix4,[yn,gn]=[new i.Quaternion,new i.Quaternion],vn=new i.Vector3,xn=new i.Vector3,wn=e=>"getTarget"in e,bn=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:n=1,onUpdate:r,onTarget:a,children:c})=>{const l=(0,s.D)((e=>e.size)),u=(0,s.D)((e=>e.camera)),d=(0,s.D)((e=>e.controls)),f=(0,s.D)((e=>e.invalidate)),m=o.useRef(null),h=o.useRef(null),p=o.useRef(!1),y=o.useRef(0),g=o.useRef(new i.Vector3(0,0,0)),v=o.useRef(new i.Vector3(0,0,0));o.useEffect((()=>{v.current.copy(u.up),hn.up.copy(u.up)}),[u]);const x=o.useCallback((e=>{p.current=!0,(d||a)&&(g.current=(null==a?void 0:a())||(wn(d)?d.getTarget(g.current):null==d?void 0:d.target)),y.current=u.position.distanceTo(vn),yn.copy(u.quaternion),xn.copy(e).multiplyScalar(y.current).add(vn),hn.lookAt(xn),gn.copy(hn.quaternion),f()}),[d,u,a,f]);(0,s.F)(((e,t)=>{if(h.current&&m.current){var n;if(p.current)if(yn.angleTo(gn)<.01)p.current=!1,"minPolarAngle"in d&&u.up.copy(v.current);else{const e=t*mn;yn.rotateTowards(gn,e),u.position.set(0,0,1).applyQuaternion(yn).multiplyScalar(y.current).add(g.current),u.up.set(0,1,0).applyQuaternion(yn).normalize(),u.quaternion.copy(yn),wn(d)&&d.setPosition(u.position.x,u.position.y,u.position.z),r?r():d&&d.update(t),f()}pn.copy(u.matrix).invert(),null==(n=m.current)||n.quaternion.setFromRotationMatrix(pn)}}));const w=o.useMemo((()=>({tweenCamera:x})),[x]),[b,E]=t,M=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+b:l.width/2-b,z=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-E:-l.height/2+E;return o.createElement(un,{renderPriority:n},o.createElement(dn.Provider,{value:w},o.createElement(Bt,{makeDefault:!0,ref:h,position:[0,0,200]}),o.createElement("group",{ref:m,position:[M,z,0]},c)))},En="#999",Mn=["Right","Left","Top","Bottom","Front","Back"],zn=e=>new i.Vector3(...e).multiplyScalar(.38),Sn=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(zn),Tn=[.25,.25,.25],An=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(zn),_n=An.map((e=>e.toArray().map((e=>0==e?.5:.25)))),Dn=({hover:e,index:t,font:n="20px Inter var, Arial, sans-serif",faces:r=Mn,color:a="#f0f0f0",hoverColor:c=En,textColor:l="black",strokeColor:u="black",opacity:d=1})=>{const f=(0,s.D)((e=>e.gl)),m=o.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const o=e.getContext("2d");return o.fillStyle=a,o.fillRect(0,0,e.width,e.height),o.strokeStyle=u,o.strokeRect(0,0,e.width,e.height),o.font=n,o.textAlign="center",o.fillStyle=l,o.fillText(r[t].toUpperCase(),64,76),new i.CanvasTexture(e)}),[t,r,n,a,l,u]);return o.createElement("meshBasicMaterial",{map:m,"map-anisotropy":f.capabilities.getMaxAnisotropy()||1,attach:`material-${t}`,color:e?c:"white",transparent:!0,opacity:d})},Pn=e=>{const{tweenCamera:t}=fn(),[n,a]=o.useState(null);return o.createElement("mesh",{onPointerOut:e=>{e.stopPropagation(),a(null)},onPointerMove:e=>{e.stopPropagation(),a(Math.floor(e.faceIndex/2))},onClick:e.onClick||(e=>{e.stopPropagation(),t(e.face.normal)})},[...Array(6)].map(((t,a)=>o.createElement(Dn,(0,r.A)({key:a,index:a,hover:n===a},e)))),o.createElement("boxGeometry",null))},Cn=({onClick:e,dimensions:t,position:n,hoverColor:r=En})=>{const{tweenCamera:a}=fn(),[i,s]=o.useState(!1);return o.createElement("mesh",{scale:1.01,position:n,onPointerOver:e=>{e.stopPropagation(),s(!0)},onPointerOut:e=>{e.stopPropagation(),s(!1)},onClick:e||(e=>{e.stopPropagation(),a(n)})},o.createElement("meshBasicMaterial",{color:i?r:"white",transparent:!0,opacity:.6,visible:i}),o.createElement("boxGeometry",{args:t}))},Rn=e=>o.createElement("group",{scale:[60,60,60]},o.createElement(Pn,e),An.map(((t,n)=>o.createElement(Cn,(0,r.A)({key:n,position:t,dimensions:_n[n]},e)))),Sn.map(((t,n)=>o.createElement(Cn,(0,r.A)({key:n,position:t,dimensions:Tn},e)))));function Fn({scale:e=[.8,.05,.05],color:t,rotation:n}){return o.createElement("group",{rotation:n},o.createElement("mesh",{position:[.4,0,0]},o.createElement("boxGeometry",{args:e}),o.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function kn({onClick:e,font:t,disabled:n,arcStyle:a,label:c,labelColor:l,axisHeadScale:u=1,...d}){const f=(0,s.D)((e=>e.gl)),m=o.useMemo((()=>{const e=document.createElement("canvas");e.width=64,e.height=64;const n=e.getContext("2d");return n.beginPath(),n.arc(32,32,16,0,2*Math.PI),n.closePath(),n.fillStyle=a,n.fill(),c&&(n.font=t,n.textAlign="center",n.fillStyle=l,n.fillText(c,32,41)),new i.CanvasTexture(e)}),[a,c,l,t]),[h,p]=o.useState(!1),y=(c?1:.75)*(h?1.2:1)*u;return o.createElement("sprite",(0,r.A)({scale:y,onPointerOver:n?void 0:e=>{e.stopPropagation(),p(!0)},onPointerOut:n?void 0:e||(e=>{e.stopPropagation(),p(!1)})},d),o.createElement("spriteMaterial",{map:m,"map-anisotropy":f.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:c?1:.75,toneMapped:!1}))}const Bn=({hideNegativeAxes:e,hideAxisHeads:t,disabled:n,font:a="18px Inter var, Arial, sans-serif",axisColors:i=["#ff2060","#20df80","#2080ff"],axisHeadScale:s=1,axisScale:c,labels:l=["X","Y","Z"],labelColor:u="#000",onClick:d,...f})=>{const[m,h,p]=i,{tweenCamera:y}=fn(),g={font:a,disabled:n,labelColor:u,onClick:d,axisHeadScale:s,onPointerDown:n?void 0:e=>{y(e.object.position),e.stopPropagation()}};return o.createElement("group",(0,r.A)({scale:40},f),o.createElement(Fn,{color:m,rotation:[0,0,0],scale:c}),o.createElement(Fn,{color:h,rotation:[0,0,Math.PI/2],scale:c}),o.createElement(Fn,{color:p,rotation:[0,-Math.PI/2,0],scale:c}),!t&&o.createElement(o.Fragment,null,o.createElement(kn,(0,r.A)({arcStyle:m,position:[1,0,0],label:l[0]},g)),o.createElement(kn,(0,r.A)({arcStyle:h,position:[0,1,0],label:l[1]},g)),o.createElement(kn,(0,r.A)({arcStyle:p,position:[0,0,1],label:l[2]},g)),!e&&o.createElement(o.Fragment,null,o.createElement(kn,(0,r.A)({arcStyle:m,position:[-1,0,0]},g)),o.createElement(kn,(0,r.A)({arcStyle:h,position:[0,-1,0]},g)),o.createElement(kn,(0,r.A)({arcStyle:p,position:[0,0,-1]},g)))))},In=Ue({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new i.Color,sectionColor:new i.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new i.Vector3,worldPlanePosition:new i.Vector3},"\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform vec3 worldPlanePosition;\n    uniform float fadeDistance;\n    uniform bool infiniteGrid;\n    uniform bool followCamera;\n\n    void main() {\n      localPosition = position.xzy;\n      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n      \n      worldPosition = modelMatrix * vec4(localPosition, 1.0);\n      if (followCamera) {\n        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n        localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n      }\n\n      gl_Position = projectionMatrix * viewMatrix * worldPosition;\n    }\n  ",`\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform float cellSize;\n    uniform float sectionSize;\n    uniform vec3 cellColor;\n    uniform vec3 sectionColor;\n    uniform float fadeDistance;\n    uniform float fadeStrength;\n    uniform float fadeFrom;\n    uniform float cellThickness;\n    uniform float sectionThickness;\n\n    float getGrid(float size, float thickness) {\n      vec2 r = localPosition.xz / size;\n      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n      float line = min(grid.x, grid.y) + 1.0 - thickness;\n      return 1.0 - min(line, 1.0);\n    }\n\n    void main() {\n      float g1 = getGrid(cellSize, cellThickness);\n      float g2 = getGrid(sectionSize, sectionThickness);\n\n      vec3 from = worldCamProjPosition*vec3(fadeFrom);\n      float dist = distance(from, worldPosition.xyz);\n      float d = 1.0 - min(dist / fadeDistance, 1.0);\n      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n\n      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n      if (gl_FragColor.a <= 0.0) discard;\n\n      #include <tonemapping_fragment>\n      #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `),Ln=o.forwardRef((({args:e,cellColor:t="#000000",sectionColor:n="#2080ff",cellSize:a=.5,sectionSize:c=1,followCamera:l=!1,infiniteGrid:u=!1,fadeDistance:d=100,fadeStrength:f=1,fadeFrom:m=1,cellThickness:h=.5,sectionThickness:p=1,side:y=i.BackSide,...g},v)=>{(0,s.e)({GridMaterial:In});const x=o.useRef(null);o.useImperativeHandle(v,(()=>x.current),[]);const w=new i.Plane,b=new i.Vector3(0,1,0),E=new i.Vector3(0,0,0);(0,s.F)((e=>{w.setFromNormalAndCoplanarPoint(b,E).applyMatrix4(x.current.matrixWorld);const t=x.current.material,n=t.uniforms.worldCamProjPosition,r=t.uniforms.worldPlanePosition;w.projectPoint(e.camera.position,n.value),r.value.set(0,0,0).applyMatrix4(x.current.matrixWorld)}));const M={cellSize:a,sectionSize:c,cellColor:t,sectionColor:n,cellThickness:h,sectionThickness:p},z={fadeDistance:d,fadeStrength:f,fadeFrom:m,infiniteGrid:u,followCamera:l};return o.createElement("mesh",(0,r.A)({ref:x,frustumCulled:!1},g),o.createElement("gridMaterial",(0,r.A)({transparent:!0,"extensions-derivatives":!0,side:y},M,z)),o.createElement("planeGeometry",{args:e}))}));function Un(e,{path:t}){const[n]=(0,s.H)(i.CubeTextureLoader,[e],(e=>e.setPath(t)));return n}function On({children:e,files:t,...n}){const r=Un(t,{...n});return o.createElement(o.Fragment,null,null==e?void 0:e(r))}Un.preload=(e,{path:t})=>s.H.preload(i.CubeTextureLoader,[e],(e=>e.setPath(t)));var Nn=n("bXbU");function Vn(e){return(0,s.H)(Nn.w,e)}function jn({path:e,...t}){const n=Vn(e).children[0];return o.createElement(st,(0,r.A)({},t,{object:n}))}Vn.preload=e=>s.H.preload(Nn.w,e),Vn.clear=e=>s.H.clear(Nn.w,e);var Gn=n("9lgH");const Wn="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master";function Hn(e,t=`${Wn}/basis/`){const n=(0,s.D)((e=>e.gl)),r=(0,s.H)(Gn.p,Oe(e)?Object.values(e):e,(e=>{e.detectSupport(n),e.setTranscoderPath(t)}));if((0,o.useEffect)((()=>{(Array.isArray(r)?r:[r]).forEach(n.initTexture)}),[n,r]),Oe(e)){const t=Object.keys(e),n={};return t.forEach((e=>Object.assign(n,{[e]:r[t.indexOf(e)]}))),n}return r}Hn.preload=(e,t=`${Wn}/basis/`)=>s.H.preload(Gn.p,e,(e=>{e.setTranscoderPath(t)})),Hn.clear=e=>s.H.clear(Gn.p,e);const Xn=({children:e,input:t,basisPath:n})=>{const r=Hn(t,n);return o.createElement(o.Fragment,null,null==e?void 0:e(r))};var qn=n("LyZs");const $n=((e,t)=>"undefined"!==typeof window&&"function"===typeof(null==(e=window.document)?void 0:e.createElement)&&"string"===typeof(null==(t=window.navigator)?void 0:t.userAgent))();let Yn=null;function Kn(e,{unsuspend:t="loadedmetadata",start:r=!0,hls:a={},crossOrigin:c="anonymous",muted:l=!0,loop:u=!0,playsInline:d=!0,onVideoFrame:f,...m}={}){const h=(0,s.D)((e=>e.gl)),p=(0,o.useRef)(null),y=(0,we.DY)((()=>new Promise((async r=>{let o,s;"string"===typeof e?o=e:s=e;const f=Object.assign(document.createElement("video"),{src:o,srcObject:s,crossOrigin:c,loop:u,muted:l,playsInline:d,...m});if(o&&$n&&o.endsWith(".m3u8")){const e=p.current=await async function(...e){var t;null!==(t=Yn)&&void 0!==t||(Yn=await Promise.resolve().then(n.bind(n,"LyZs")));const r=Yn.default;return r.isSupported()?new r(...e):null}(a);e&&(e.on(qn.Events.MEDIA_ATTACHED,(()=>{e.loadSource(o)})),e.attachMedia(f))}const y=new i.VideoTexture(f);"colorSpace"in y?y.colorSpace=h.outputColorSpace:y.encoding=h.outputEncoding,f.addEventListener(t,(()=>r(y)))}))),[e]),g=y.source.data;return Qn(g,f),(0,o.useEffect)((()=>(r&&y.image.play(),()=>{p.current&&(p.current.destroy(),p.current=null)})),[y,r]),y}const Zn=(0,o.forwardRef)((({children:e,src:t,...n},r)=>{const a=Kn(t,n);return(0,o.useEffect)((()=>()=>{a.dispose()}),[a]),(0,o.useImperativeHandle)(r,(()=>a),[a]),o.createElement(o.Fragment,null,null==e?void 0:e(a))})),Qn=(e,t)=>{(0,o.useEffect)((()=>{if(!t)return;if(!e.requestVideoFrameCallback)return;let n;const r=(...o)=>{t(...o),n=e.requestVideoFrameCallback(r)};return e.requestVideoFrameCallback(r),()=>e.cancelVideoFrameCallback(n)}),[e,t])},Jn=(e,t)=>Array.isArray(e)?e[0]:e[null!==t&&void 0!==t?t:Object.keys(e)[0]][0],er=e=>{for(let t=3;t<e.length;t+=4)if(0!==e[t])return!1;return!0};function tr(e,t,n,r,a,c){const l=o.useRef((0,s.D)((e=>e.viewport))),u=o.useRef(null),d=o.useRef(0),f=o.useRef(e),m=o.useRef(t),h=o.useRef(n),[p,y]=(0,o.useState)(null),[g,v]=o.useState(new i.Texture),x=o.useMemo((()=>new i.TextureLoader),[]),[w,b]=(0,o.useState)(null),E=o.useCallback(((e,t,n)=>{const r=t*(l.current.aspect>e/t?l.current.width/e:l.current.height/t),o=e*(l.current.aspect>e/t?l.current.width/e:l.current.height/t)*n,a=r*n;let s=Math.min(1,o),c=Math.min(1,a);return o>1&&(s=1,c=a/o*1),new i.Vector3(s,c,1)}),[]),M=o.useCallback(((e,t)=>{if(e.image){const n=document.createElement("canvas"),r=n.getContext("2d",c);if(!r)throw new Error("Failed to get 2d context");n.width=e.image.width,n.height=e.image.height,r.drawImage(e.image,0,0);const o=e.image.width,a=e.image.height,i=Math.round(Math.sqrt(t*(o/a))),s=Math.round(t/i),l=o/i,u=a/s,d=[];for(let e=0;e<s;e++)for(let n=0;n<i;n++){if(e*i+n>=t){d.push({row:e,col:n});continue}const o=r.getImageData(n*l,e*u,l,u).data;er(o)&&d.push({row:e,col:n})}return{rows:s,columns:i,frameWidth:l,frameHeight:u,emptyFrames:d}}return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]}}),[c]),z=o.useCallback((e=>{const t=e=>{let t=null;for(const n of e){const{w:e,h:r}=n.frame,o=e*r;(!t||o>t.area)&&(t={w:e,h:r,area:o})}return e.map((e=>{const{w:n,h:r}=e.frame,o=n*r,a=t?o===t.area?1:Math.sqrt(o/t.area):1;return{...e,scaleRatio:a}}))};if(Array.isArray(e))return t(e);{const n={};for(const r in e)n[r]=t(e[r]);return n}}),[]),S=o.useCallback((()=>{const e={},t=u.current,n=h.current;if(t){if(n&&Array.isArray(t.frames)){for(let r=0;r<n.length;r++){e[n[r]]=[];for(const o of t.frames){const t=o.frame,a=o.sourceSize.w,i=o.sourceSize.h;"string"===typeof o.filename&&-1!==o.filename.toLowerCase().indexOf(n[r].toLowerCase())&&e[n[r]].push({...o,frame:t,sourceSize:{w:a,h:i}})}}for(const t in e){const n=z(e[t]);Array.isArray(n)&&(e[t]=n)}return e}if(n&&"object"===typeof t.frames){for(let r=0;r<n.length;r++){e[n[r]]=[];for(const o in t.frames){const a=t.frames[o],i=a.frame,s=a.sourceSize.w,c=a.sourceSize.h;"string"===typeof o&&-1!==o.toLowerCase().indexOf(n[r].toLowerCase())&&e[n[r]].push({...a,frame:i,sourceSize:{w:s,h:c}})}}for(const t in e){const n=z(e[t]);Array.isArray(n)&&(e[t]=n)}return e}{let e=[];return null!=t&&t.frames&&(e=Array.isArray(t.frames)?t.frames.map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h}))):Object.values(t.frames).flat().map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h})))),z(e)}}return[]}),[z,u]),T=o.useCallback(((e,t)=>{let n=new i.Vector3(1,1,1);if(null===e){if(t&&r){const e=t.image.width,o=t.image.height;d.current=r;const{rows:a,columns:i,frameWidth:s,frameHeight:c,emptyFrames:l}=M(t,r),f={frames:[],meta:{version:"1.0",size:{w:e,h:o},rows:a,columns:i,frameWidth:s,frameHeight:c,scale:"1"}};for(let t=0;t<a;t++)for(let e=0;e<i;e++)(null!==l&&void 0!==l?l:[]).some((n=>n.row===t&&n.col===e))||Array.isArray(f.frames)&&f.frames.push({frame:{x:e*s,y:t*c,w:s,h:c},scaleRatio:1,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:s,h:c},sourceSize:{w:s,h:c}});n=E(s,c,.1),u.current=f}u.current&&u.current.frames&&(u.current.frames=z(u.current.frames))}else if(t){u.current=e,u.current.frames=S(),d.current=Array.isArray(e.frames)?e.frames.length:Object.keys(e.frames).length;const{w:t,h:r}=Jn(e.frames).sourceSize;n=E(t,r,.1)}y(u.current),"encoding"in t?t.encoding=3001:"colorSpace"in t&&(t.colorSpace=i.SRGBColorSpace),v(t),b({spriteTexture:t,spriteData:u.current,aspect:n})}),[M,r,S,E,z]),A=o.useCallback(((e,t,n)=>{const r=fetch(e).then((e=>e.json())),o=new Promise((e=>{x.load(t,e)}));Promise.all([r,o]).then((e=>{n(e[0],e[1])}))}),[x]),_=o.useCallback((e=>{if(!e&&!f.current)throw new Error("Either textureUrl or input must be provided");const t=null!==e&&void 0!==e?e:f.current;if(!t)throw new Error("A valid texture URL must be provided");x.load(t,(e=>T(null,e)))}),[x,T]),D=o.useCallback(((e,t)=>{t&&e?A(t,e,T):_(e)}),[A,_,T]);return o.useLayoutEffect((()=>{m.current&&f.current?A(m.current,f.current,T):f.current&&_();const e=f.current;return()=>{e&&s.H.clear(i.TextureLoader,e)}}),[A,_,T]),o.useLayoutEffect((()=>{null==a||a(g,null!==p&&void 0!==p?p:null)}),[g,p,a]),{spriteObj:w,loadJsonAndTexture:D}}function nr(e,t,...n){const r=o.useRef(),a=(0,s.D)((e=>e.scene));return o.useLayoutEffect((()=>{let o;if(e&&null!=e&&e.current&&t&&(r.current=o=new t(e.current,...n)),o)return o.traverse((e=>e.raycast=()=>null)),a.add(o),()=>{r.current=void 0,a.remove(o),null==o.dispose||o.dispose()}}),[a,t,e,...n]),(0,s.F)((()=>{var e;null==(e=r.current)||null==e.update||e.update()})),r}tr.preload=e=>s.H.preload(i.TextureLoader,e),tr.clear=e=>s.H.clear(i.TextureLoader,e);const rr=({type:e,args:t=[]})=>{const n=o.useRef(null),r=o.useRef(null);return o.useLayoutEffect((()=>{r.current=n.current.parent})),nr(r,e,...t),o.createElement("object3D",{ref:n})};var or=n("MZFn"),ar=n.n(or);function ir(e,t){"function"===typeof e?e(t):null!=e&&(e.current=t)}function sr({showPanel:e=0,className:t,parent:n}){const r=function(e,t=[],n){const[r,a]=o.useState();return o.useLayoutEffect((()=>{const t=e();return a(t),ir(n,t),()=>ir(n,null)}),t),r}((()=>new(ar())),[]);return o.useEffect((()=>{if(r){const o=n&&n.current||document.body;r.showPanel(e),null==o||o.appendChild(r.dom);const a=(null!==t&&void 0!==t?t:"").split(" ").filter((e=>e));a.length&&r.dom.classList.add(...a);const i=(0,s.o)((()=>r.begin())),c=(0,s.p)((()=>r.end()));return()=>{a.length&&r.dom.classList.remove(...a),null==o||o.removeChild(r.dom),i(),c()}}}),[n,r,t,e]),null}var cr=n("l2gs");const lr=o.forwardRef((function({className:e,parent:t,id:n,clearStatsGlStyle:r,...a},i){const c=(0,s.D)((e=>e.gl)),l=o.useMemo((()=>{const e=new cr.A({...a});return e.init(c),e}),[c]);return o.useImperativeHandle(i,(()=>l.domElement),[l]),o.useEffect((()=>{if(l){const o=t&&t.current||document.body;null==o||o.appendChild(l.domElement),l.domElement.querySelectorAll("canvas").forEach((e=>{e.style.removeProperty("position")})),n&&(l.domElement.id=n),r&&l.domElement.removeAttribute("style"),l.domElement.removeAttribute("style");const a=(null!==e&&void 0!==e?e:"").split(" ").filter((e=>e));a.length&&l.domElement.classList.add(...a);const i=(0,s.p)((()=>l.update()));return()=>{a.length&&l.domElement.classList.remove(...a),null==o||o.removeChild(l.domElement),i()}}}),[t,l,e,n,r]),null}));function ur({size:e=256,frames:t=1/0}={}){const n=(0,s.D)((e=>e.viewport.dpr)),{width:r,height:a}=(0,s.D)((e=>e.size)),c=e||r*n,l=e||a*n,u=o.useMemo((()=>{const e=new i.DepthTexture(c,l);return e.format=i.DepthFormat,e.type=i.UnsignedShortType,{depthTexture:e}}),[c,l]);let d=0;const f=Ft(c,l,u);return(0,s.F)((e=>{(t===1/0||d<t)&&(e.gl.setRenderTarget(f),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),d++)})),f.depthTexture}function dr(e,t,n=1){const r=(0,s.D)((e=>e.viewport)),o=t*(r.aspect>e/t?r.width/e:r.height/t);return[e*(r.aspect>e/t?r.width/e:r.height/t)*n,o*n,1]}function fr(e,t){const n=(0,s.D)((e=>e.pointer)),[r]=o.useState((()=>{const r=new i.Raycaster;return t&&(0,s.k)(r,t,{}),function(t,o){r.setFromCamera(n,e instanceof i.Camera?e:e.current);const a=this.constructor.prototype.raycast.bind(this);a&&a(r,o)}}));return r}var mr=n("dzHe");const hr=e=>(0,we.DY)((()=>(0,mr.Z)(e)),["useDetectGPU"]);function pr({children:e,...t}){const n=hr(t);return o.createElement(o.Fragment,null,null==e?void 0:e(n))}const yr=2,gr=1.25,vr=32,xr=65535,wr=Math.pow(2,-24),br=Symbol("SKIP_GENERATION");function Er(e,t,n){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e)}function Mr(e){return e.index?e.index.count:e.attributes.position.count}function zr(e){return Mr(e)/3}function Sr(e,t=ArrayBuffer){return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}function Tr(e,t){const n=zr(e),r=t||e.drawRange,o=r.start/3,a=(r.start+r.count)/3,i=Math.max(0,o),s=Math.min(n,a)-i;return[{offset:Math.floor(i),count:Math.floor(s)}]}function Ar(e,t){if(!e.groups||!e.groups.length)return Tr(e,t);const n=[],r=new Set,o=t||e.drawRange,a=o.start/3,i=(o.start+o.count)/3;for(const c of e.groups){const e=c.start/3,t=(c.start+c.count)/3;r.add(Math.max(a,e)),r.add(Math.min(i,t))}const s=Array.from(r.values()).sort(((e,t)=>e-t));for(let c=0;c<s.length-1;c++){const e=s[c],t=s[c+1];n.push({offset:Math.floor(e),count:Math.floor(t-e)})}return n}function _r(e,t,n,r,o){let a=1/0,i=1/0,s=1/0,c=-1/0,l=-1/0,u=-1/0,d=1/0,f=1/0,m=1/0,h=-1/0,p=-1/0,y=-1/0;for(let g=6*t,v=6*(t+n);g<v;g+=6){const t=e[g+0],n=e[g+1],r=t-n,o=t+n;r<a&&(a=r),o>c&&(c=o),t<d&&(d=t),t>h&&(h=t);const v=e[g+2],x=e[g+3],w=v-x,b=v+x;w<i&&(i=w),b>l&&(l=b),v<f&&(f=v),v>p&&(p=v);const E=e[g+4],M=e[g+5],z=E-M,S=E+M;z<s&&(s=z),S>u&&(u=S),E<m&&(m=E),E>y&&(y=E)}r[0]=a,r[1]=i,r[2]=s,r[3]=c,r[4]=l,r[5]=u,o[0]=d,o[1]=f,o[2]=m,o[3]=h,o[4]=p,o[5]=y}function Dr(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function Pr(e){let t=-1,n=-1/0;for(let r=0;r<3;r++){const o=e[r+3]-e[r];o>n&&(n=o,t=r)}return t}function Cr(e,t){t.set(e)}function Rr(e,t,n){let r,o;for(let a=0;a<3;a++){const i=a+3;r=e[a],o=t[a],n[a]=r<o?r:o,r=e[i],o=t[i],n[i]=r>o?r:o}}function Fr(e,t,n){for(let r=0;r<3;r++){const o=t[e+2*r],a=t[e+2*r+1],i=o-a,s=o+a;i<n[r]&&(n[r]=i),s>n[r+3]&&(n[r+3]=s)}}function kr(e){const t=e[3]-e[0],n=e[4]-e[1],r=e[5]-e[2];return 2*(t*n+n*r+r*t)}const Br=(e,t)=>e.candidate-t.candidate,Ir=new Array(32).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),Lr=new Float32Array(6);class Ur{constructor(){this.boundingData=new Float32Array(6)}}function Or(e,t,n,r,o,a){let i=r,s=r+o-1;const c=a.pos,l=2*a.axis;for(;;){for(;i<=s&&n[6*i+l]<c;)i++;for(;i<=s&&n[6*s+l]>=c;)s--;if(!(i<s))return i;for(let e=0;e<3;e++){let n=t[3*i+e];t[3*i+e]=t[3*s+e],t[3*s+e]=n}for(let e=0;e<6;e++){let t=n[6*i+e];n[6*i+e]=n[6*s+e],n[6*s+e]=t}i++,s--}}function Nr(e,t,n,r,o,a){let i=r,s=r+o-1;const c=a.pos,l=2*a.axis;for(;;){for(;i<=s&&n[6*i+l]<c;)i++;for(;i<=s&&n[6*s+l]>=c;)s--;if(!(i<s))return i;{let t=e[i];e[i]=e[s],e[s]=t;for(let e=0;e<6;e++){let t=n[6*i+e];n[6*i+e]=n[6*s+e],n[6*s+e]=t}i++,s--}}}function Vr(e,t){return 65535===t[e+15]}function jr(e,t){return t[e+6]}function Gr(e,t){return t[e+14]}function Wr(e){return e+8}function Hr(e,t){return t[e+6]}function Xr(e,t){return t[e+7]}let qr,$r,Yr,Kr;const Zr=Math.pow(2,32);function Qr(e){return"count"in e?1:1+Qr(e.left)+Qr(e.right)}function Jr(e,t,n){return qr=new Float32Array(n),$r=new Uint32Array(n),Yr=new Uint16Array(n),Kr=new Uint8Array(n),eo(e,t)}function eo(e,t){const n=e/4,r=e/2,o="count"in t,a=t.boundingData;for(let i=0;i<6;i++)qr[n+i]=a[i];if(o){if(t.buffer){const r=t.buffer;Kr.set(new Uint8Array(r),e);for(let t=e,o=e+r.byteLength;t<o;t+=vr)Vr(t/2,Yr)||($r[t/4+6]+=n);return e+r.byteLength}{const o=t.offset,a=t.count;return $r[n+6]=o,Yr[r+14]=a,Yr[r+15]=xr,e+vr}}{const r=t.left,o=t.right,a=t.splitAxis;let i;if(i=eo(e+vr,r),i/4>Zr)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return $r[n+6]=i/4,i=eo(i,o),$r[n+7]=a,i}}function to(e,t){const n=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){const n=(e.index?e.index.count:e.attributes.position.count)/3,r=n>65536,o=r?4:2,a=t?new SharedArrayBuffer(n*o):new ArrayBuffer(n*o),i=r?new Uint32Array(a):new Uint16Array(a);for(let s=0,c=i.length;s<c;s++)i[s]=s;return i}(n,t.useSharedArrayBuffer),function(e,t){const n=zr(e),r=Ar(e,t).sort(((e,t)=>e.offset-t.offset)),o=r[r.length-1];o.count=Math.min(n-o.offset,o.count);let a=0;return r.forEach((({count:e})=>a+=e)),n!==a}(n,t.range)&&t.verbose),e._indirectBuffer||function(e,t){if(!e.index){const n=e.attributes.position.count,r=Sr(n,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new i.BufferAttribute(r,1));for(let e=0;e<n;e++)r[e]=e}}(n,t);const r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,o=function(e,t=null,n=null,r=null){const o=e.attributes.position,a=e.index?e.index.array:null,i=zr(e),s=o.normalized;let c;null===t?(c=new Float32Array(6*i*4),n=0,r=i):(c=t,n=n||0,r=r||i);const l=o.array,u=o.offset||0;let d=3;o.isInterleavedBufferAttribute&&(d=o.data.stride);const f=["getX","getY","getZ"];for(let m=n;m<n+r;m++){const e=3*m,t=6*m;let n=e+0,r=e+1,i=e+2;a&&(n=a[n],r=a[r],i=a[i]),s||(n=n*d+u,r=r*d+u,i=i*d+u);for(let a=0;a<3;a++){let e,u,d;s?(e=o[f[a]](n),u=o[f[a]](r),d=o[f[a]](i)):(e=l[n+a],u=l[r+a],d=l[i+a]);let m=e;u<m&&(m=u),d<m&&(m=d);let h=e;u>h&&(h=u),d>h&&(h=d);const p=(h-m)/2,y=2*a;c[t+y+0]=m+p,c[t+y+1]=p+(Math.abs(m)+p)*wr}}return c}(n),a=t.indirect?Tr(n,t.range):Ar(n,t.range);e._roots=a.map((n=>{const a=function(e,t,n,r,o){const{maxDepth:a,verbose:i,maxLeafTris:s,strategy:c,onProgress:l,indirect:u}=o,d=e._indirectBuffer,f=e.geometry,m=f.index?f.index.array:null,h=u?Nr:Or,p=zr(f),y=new Float32Array(6);let g=!1;const v=new Ur;return _r(t,n,r,v.boundingData,y),function e(n,r,o,i=null,l=0){if(!g&&l>=a&&(g=!0),o<=s||l>=a)return x(r+o),n.offset=r,n.count=o,n;const u=function(e,t,n,r,o,a){let i=-1,s=0;if(0===a)i=Pr(t),-1!==i&&(s=(t[i]+t[i+3])/2);else if(1===a)i=Pr(e),-1!==i&&(s=function(e,t,n,r){let o=0;for(let a=t,i=t+n;a<i;a++)o+=e[6*a+2*r];return o/n}(n,r,o,i));else if(a===yr){const a=kr(e);let c=gr*o;const l=6*r,u=6*(r+o);for(let e=0;e<3;e++){const r=t[e],d=(t[e+3]-r)/32;if(o<8){const t=[...Ir];t.length=o;let r=0;for(let o=l;o<u;o+=6,r++){const a=t[r];a.candidate=n[o+2*e],a.count=0;const{bounds:i,leftCacheBounds:s,rightCacheBounds:c}=a;for(let e=0;e<3;e++)c[e]=1/0,c[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0,i[e]=1/0,i[e+3]=-1/0;Fr(o,n,i)}t.sort(Br);let d=o;for(let e=0;e<d;e++){const n=t[e];for(;e+1<d&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),d--}for(let o=l;o<u;o+=6){const r=n[o+2*e];for(let e=0;e<d;e++){const a=t[e];r>=a.candidate?Fr(o,n,a.rightCacheBounds):(Fr(o,n,a.leftCacheBounds),a.count++)}}for(let n=0;n<d;n++){const r=t[n],l=r.count,u=o-r.count,d=r.leftCacheBounds,f=r.rightCacheBounds;let m=0;0!==l&&(m=kr(d)/a);let h=0;0!==u&&(h=kr(f)/a);const p=1+gr*(m*l+h*u);p<c&&(i=e,c=p,s=r.candidate)}}else{for(let e=0;e<32;e++){const t=Ir[e];t.count=0,t.candidate=r+d+e*d;const n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let o=l;o<u;o+=6){let t=~~((n[o+2*e]-r)/d);t>=32&&(t=31);const a=Ir[t];a.count++,Fr(o,n,a.bounds)}const t=Ir[31];Cr(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){const t=Ir[e],n=Ir[e+1];Rr(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let f=0;for(let n=0;n<31;n++){const t=Ir[n],r=t.count,l=t.bounds,u=Ir[n+1].rightCacheBounds;0!==r&&(0===f?Cr(l,Lr):Rr(l,Lr,Lr)),f+=r;let d=0,m=0;0!==f&&(d=kr(Lr)/a);const h=o-f;0!==h&&(m=kr(u)/a);const p=1+gr*(d*f+m*h);p<c&&(i=e,c=p,s=t.candidate)}}}}return{axis:i,pos:s}}(n.boundingData,i,t,r,o,c);if(-1===u.axis)return x(r+o),n.offset=r,n.count=o,n;const f=h(d,m,t,r,o,u);if(f===r||f===r+o)x(r+o),n.offset=r,n.count=o;else{n.splitAxis=u.axis;const a=new Ur,i=r,s=f-r;n.left=a,_r(t,i,s,a.boundingData,y),e(a,i,s,y,l+1);const c=new Ur,d=f,m=o-s;n.right=c,_r(t,d,m,c.boundingData,y),e(c,d,m,y,l+1)}return n}(v,n,r,y),v;function x(e){l&&l(e/p)}}(e,o,n.offset,n.count,t),i=Qr(a),s=new r(vr*i);return Jr(0,a,s),s}))}class no{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,r=-1/0;for(let o=0,a=e.length;o<a;o++){const a=e[o][t];n=a<n?a:n,r=a>r?a:r}this.min=n,this.max=r}setFromPoints(e,t){let n=1/0,r=-1/0;for(let o=0,a=t.length;o<a;o++){const a=t[o],i=e.dot(a);n=i<n?i:n,r=i>r?i:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}no.prototype.setFromBox=function(){const e=new i.Vector3;return function(t,n){const r=n.min,o=n.max;let a=1/0,i=-1/0;for(let s=0;s<=1;s++)for(let n=0;n<=1;n++)for(let c=0;c<=1;c++){e.x=r.x*s+o.x*(1-s),e.y=r.y*n+o.y*(1-n),e.z=r.z*c+o.z*(1-c);const l=t.dot(e);a=Math.min(l,a),i=Math.max(l,i)}this.min=a,this.max=i}}(),new no;const ro=function(){const e=new i.Vector3,t=new i.Vector3,n=new i.Vector3;return function(r,o,a){const i=r.start,s=e,c=o.start,l=t;n.subVectors(i,c),e.subVectors(r.end,r.start),t.subVectors(o.end,o.start);const u=n.dot(l),d=l.dot(s),f=l.dot(l),m=n.dot(s),h=s.dot(s)*f-d*d;let p,y;p=0!==h?(u*d-m*f)/h:0,y=(u+p*d)/f,a.x=p,a.y=y}}(),oo=function(){const e=new i.Vector2,t=new i.Vector3,n=new i.Vector3;return function(r,o,a,i){ro(r,o,e);let s=e.x,c=e.y;if(s>=0&&s<=1&&c>=0&&c<=1)return r.at(s,a),void o.at(c,i);if(s>=0&&s<=1)return c<0?o.at(0,i):o.at(1,i),void r.closestPointToPoint(i,!0,a);if(c>=0&&c<=1)return s<0?r.at(0,a):r.at(1,a),void o.closestPointToPoint(a,!0,i);{let e,l;e=s<0?r.start:r.end,l=c<0?o.start:o.end;const u=t,d=n;return r.closestPointToPoint(l,!0,t),o.closestPointToPoint(e,!0,n),u.distanceToSquared(l)<=d.distanceToSquared(e)?(a.copy(u),void i.copy(l)):(a.copy(e),void i.copy(d))}}}(),ao=function(){const e=new i.Vector3,t=new i.Vector3,n=new i.Plane,r=new i.Line3;return function(o,a){const{radius:i,center:s}=o,{a:c,b:l,c:u}=a;if(r.start=c,r.end=l,r.closestPointToPoint(s,!0,e).distanceTo(s)<=i)return!0;if(r.start=c,r.end=u,r.closestPointToPoint(s,!0,e).distanceTo(s)<=i)return!0;if(r.start=l,r.end=u,r.closestPointToPoint(s,!0,e).distanceTo(s)<=i)return!0;const d=a.getPlane(n);if(Math.abs(d.distanceToPoint(s))<=i){const e=d.projectPoint(s,t);if(a.containsPoint(e))return!0}return!1}}();function io(e){return Math.abs(e)<1e-15}class so extends i.Triangle{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new i.Vector3)),this.satBounds=new Array(4).fill().map((()=>new no)),this.points=[this.a,this.b,this.c],this.sphere=new i.Sphere,this.plane=new i.Plane,this.needsUpdate=!0}intersectsSphere(e){return ao(e,this)}update(){const e=this.a,t=this.b,n=this.c,r=this.points,o=this.satAxes,a=this.satBounds,i=o[0],s=a[0];this.getNormal(i),s.setFromPoints(i,r);const c=o[1],l=a[1];c.subVectors(e,t),l.setFromPoints(c,r);const u=o[2],d=a[2];u.subVectors(t,n),d.setFromPoints(u,r);const f=o[3],m=a[3];f.subVectors(n,e),m.setFromPoints(f,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(i,e),this.needsUpdate=!1}}so.prototype.closestPointToSegment=function(){const e=new i.Vector3,t=new i.Vector3,n=new i.Line3;return function(r,o=null,a=null){const{start:i,end:s}=r,c=this.points;let l,u=1/0;for(let d=0;d<3;d++){const i=(d+1)%3;n.start.copy(c[d]),n.end.copy(c[i]),oo(n,r,e,t),l=e.distanceToSquared(t),l<u&&(u=l,o&&o.copy(e),a&&a.copy(t))}return this.closestPointToPoint(i,e),l=i.distanceToSquared(e),l<u&&(u=l,o&&o.copy(e),a&&a.copy(i)),this.closestPointToPoint(s,e),l=s.distanceToSquared(e),l<u&&(u=l,o&&o.copy(e),a&&a.copy(s)),Math.sqrt(u)}}(),so.prototype.intersectsTriangle=function(){const e=new so,t=new Array(3),n=new Array(3),r=new no,o=new no,a=new i.Vector3,s=new i.Vector3,c=new i.Vector3,l=new i.Vector3,u=new i.Vector3,d=new i.Line3,f=new i.Line3,m=new i.Line3,h=new i.Vector3;function p(e,t,n){const r=e.points;let o=0,a=-1;for(let i=0;i<3;i++){const{start:e,end:c}=d;e.copy(r[i]),c.copy(r[(i+1)%3]),d.delta(s);const l=io(t.distanceToPoint(e));if(io(t.normal.dot(s))&&l){n.copy(d),o=2;break}const u=t.intersectLine(d,h);if(!u&&l&&h.copy(e),(u||l)&&!io(h.distanceTo(c))){if(o<=1)(1===o?n.start:n.end).copy(h),l&&(a=o);else if(o>=2){(1===a?n.start:n.end).copy(h),o=2;break}if(o++,2===o&&-1===a)break}}return o}return function(i,s=null,d=!1){this.needsUpdate&&this.update(),i.isExtendedTriangle?i.needsUpdate&&i.update():(e.copy(i),e.update(),i=e);const h=this.plane,y=i.plane;if(Math.abs(h.normal.dot(y.normal))>1-1e-10){const e=this.satBounds,c=this.satAxes;n[0]=i.a,n[1]=i.b,n[2]=i.c;for(let t=0;t<4;t++){const o=e[t],a=c[t];if(r.setFromPoints(a,n),o.isSeparated(r))return!1}const l=i.satBounds,u=i.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let n=0;n<4;n++){const e=l[n],o=u[n];if(r.setFromPoints(o,t),e.isSeparated(r))return!1}for(let i=0;i<4;i++){const e=c[i];for(let i=0;i<4;i++){const s=u[i];if(a.crossVectors(e,s),r.setFromPoints(a,t),o.setFromPoints(a,n),r.isSeparated(o))return!1}}return s&&(s.start.set(0,0,0),s.end.set(0,0,0)),!0}{const e=p(this,y,f);if(1===e&&i.containsPoint(f.end))return s&&(s.start.copy(f.end),s.end.copy(f.end)),!0;if(2!==e)return!1;const t=p(i,h,m);if(1===t&&this.containsPoint(m.end))return s&&(s.start.copy(m.end),s.end.copy(m.end)),!0;if(2!==t)return!1;if(f.delta(c),m.delta(l),c.dot(l)<0){let e=m.start;m.start=m.end,m.end=e}const n=f.start.dot(c),r=f.end.dot(c),o=m.start.dot(c),a=m.end.dot(c);return(n===a||o===r||r<o!==n<a)&&(s&&(u.subVectors(f.start,m.start),u.dot(c)>0?s.start.copy(f.start):s.start.copy(m.start),u.subVectors(f.end,m.end),u.dot(c)<0?s.end.copy(f.end):s.end.copy(m.end)),!0)}}}(),so.prototype.distanceToPoint=function(){const e=new i.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),so.prototype.distanceToTriangle=function(){const e=new i.Vector3,t=new i.Vector3,n=["a","b","c"],r=new i.Line3,o=new i.Line3;return function(a,i=null,s=null){const c=i||s?r:null;if(this.intersectsTriangle(a,c))return(i||s)&&(i&&c.getCenter(i),s&&c.getCenter(s)),0;let l=1/0;for(let t=0;t<3;t++){let r;const o=n[t],c=a[o];this.closestPointToPoint(c,e),r=c.distanceToSquared(e),r<l&&(l=r,i&&i.copy(e),s&&s.copy(c));const u=this[o];a.closestPointToPoint(u,e),r=u.distanceToSquared(e),r<l&&(l=r,i&&i.copy(u),s&&s.copy(e))}for(let u=0;u<3;u++){const c=n[u],d=n[(u+1)%3];r.set(this[c],this[d]);for(let u=0;u<3;u++){const c=n[u],d=n[(u+1)%3];o.set(a[c],a[d]),oo(r,o,e,t);const f=e.distanceToSquared(t);f<l&&(l=f,i&&i.copy(e),s&&s.copy(t))}}return Math.sqrt(l)}}();class co{constructor(e,t,n){this.isOrientedBox=!0,this.min=new i.Vector3,this.max=new i.Vector3,this.matrix=new i.Matrix4,this.invMatrix=new i.Matrix4,this.points=new Array(8).fill().map((()=>new i.Vector3)),this.satAxes=new Array(3).fill().map((()=>new i.Vector3)),this.satBounds=new Array(3).fill().map((()=>new no)),this.alignedSatBounds=new Array(3).fill().map((()=>new no)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}co.prototype.update=function(){const e=this.matrix,t=this.min,n=this.max,r=this.points;for(let c=0;c<=1;c++)for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const i=r[1*c|2*o|4*a];i.x=c?n.x:t.x,i.y=o?n.y:t.y,i.z=a?n.z:t.z,i.applyMatrix4(e)}const o=this.satBounds,a=this.satAxes,i=r[0];for(let c=0;c<3;c++){const e=a[c],t=o[c],n=r[1<<c];e.subVectors(i,n),t.setFromPoints(e,r)}const s=this.alignedSatBounds;s[0].setFromPointsField(r,"x"),s[1].setFromPointsField(r,"y"),s[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},co.prototype.intersectsBox=function(){const e=new no;return function(t){this.needsUpdate&&this.update();const n=t.min,r=t.max,o=this.satBounds,a=this.satAxes,i=this.alignedSatBounds;if(e.min=n.x,e.max=r.x,i[0].isSeparated(e))return!1;if(e.min=n.y,e.max=r.y,i[1].isSeparated(e))return!1;if(e.min=n.z,e.max=r.z,i[2].isSeparated(e))return!1;for(let s=0;s<3;s++){const n=a[s],r=o[s];if(e.setFromBox(n,t),r.isSeparated(e))return!1}return!0}}(),co.prototype.intersectsTriangle=function(){const e=new so,t=new Array(3),n=new no,r=new no,o=new i.Vector3;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);const i=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let e=0;e<3;e++){const r=i[e],o=s[e];if(n.setFromPoints(o,t),r.isSeparated(n))return!1}const c=a.satBounds,l=a.satAxes,u=this.points;for(let e=0;e<3;e++){const t=c[e],r=l[e];if(n.setFromPoints(r,u),t.isSeparated(n))return!1}for(let e=0;e<3;e++){const a=s[e];for(let e=0;e<4;e++){const i=l[e];if(o.crossVectors(a,i),n.setFromPoints(o,t),r.setFromPoints(o,u),n.isSeparated(r))return!1}}return!0}}(),co.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},co.prototype.distanceToPoint=function(){const e=new i.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),co.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map((()=>new i.Line3)),n=new Array(12).fill().map((()=>new i.Line3)),r=new i.Vector3,o=new i.Vector3;return function(a,i=0,s=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||c)&&(a.getCenter(o),this.closestPointToPoint(o,r),a.closestPointToPoint(r,o),s&&s.copy(r),c&&c.copy(o)),0;const l=i*i,u=a.min,d=a.max,f=this.points;let m=1/0;for(let e=0;e<8;e++){const t=f[e];o.copy(t).clamp(u,d);const n=t.distanceToSquared(o);if(n<m&&(m=n,s&&s.copy(t),c&&c.copy(o),n<l))return Math.sqrt(n)}let h=0;for(let r=0;r<3;r++)for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const i=(r+1)%3,s=(r+2)%3,c=1<<r|o<<i|a<<s,l=f[o<<i|a<<s],m=f[c];t[h].set(l,m);const p=e[r],y=e[i],g=e[s],v=n[h],x=v.start,w=v.end;x[p]=u[p],x[y]=o?u[y]:d[y],x[g]=a?u[g]:d[y],w[p]=d[p],w[y]=o?u[y]:d[y],w[g]=a?u[g]:d[y],h++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){o.x=e?d.x:u.x,o.y=t?d.y:u.y,o.z=n?d.z:u.z,this.closestPointToPoint(o,r);const a=o.distanceToSquared(r);if(a<m&&(m=a,s&&s.copy(r),c&&c.copy(o),a<l))return Math.sqrt(a)}for(let e=0;e<12;e++){const a=t[e];for(let e=0;e<12;e++){const t=n[e];oo(a,t,r,o);const i=r.distanceToSquared(o);if(i<m&&(m=i,s&&s.copy(r),c&&c.copy(o),i<l))return Math.sqrt(i)}}return Math.sqrt(m)}}();class lo{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class uo extends lo{constructor(){super((()=>new so))}}const fo=new uo,mo=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let t=null;this.setBuffer=n=>{t&&e.push(t),t=n,this.float32Array=new Float32Array(n),this.uint16Array=new Uint16Array(n),this.uint32Array=new Uint32Array(n)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}};let ho,po;const yo=[],go=new lo((()=>new i.Box3));function vo(e,t,n,r,o,a){ho=go.getPrimitive(),po=go.getPrimitive(),yo.push(ho,po),mo.setBuffer(e._roots[t]);const i=xo(0,e.geometry,n,r,o,a);mo.clearBuffer(),go.releasePrimitive(ho),go.releasePrimitive(po),yo.pop(),yo.pop();const s=yo.length;return s>0&&(po=yo[s-1],ho=yo[s-2]),i}function xo(e,t,n,r,o=null,a=0,i=0){const{float32Array:s,uint16Array:c,uint32Array:l}=mo;let u=2*e;if(Vr(u,c)){const d=jr(e,l),f=Gr(u,c);return Dr(e,s,ho),r(d,f,!1,i,a+e,ho)}{const m=Wr(e),h=Hr(e,l);let p,y,g,v,x=m,w=h;if(o&&(g=ho,v=po,Dr(x,s,g),Dr(w,s,v),p=o(g),y=o(v),y<p)){x=h,w=m;const A=p;p=y,y=A,g=v}g||(g=ho,Dr(x,s,g));const b=n(g,Vr(2*x,c),p,i+1,a+x);let E;if(2===b){const _=S(x);E=r(_,T(x)-_,!0,i+1,a+x,g)}else E=b&&xo(x,t,n,r,o,a,i+1);if(E)return!0;v=po,Dr(w,s,v);const M=n(v,Vr(2*w,c),y,i+1,a+w);let z;if(2===M){const D=S(w);z=r(D,T(w)-D,!0,i+1,a+w,v)}else z=M&&xo(w,t,n,r,o,a,i+1);return!!z;function S(e){const{uint16Array:t,uint32Array:n}=mo;let r=2*e;for(;!Vr(r,t);)r=2*(e=Wr(e));return jr(e,n)}function T(e){const{uint16Array:t,uint32Array:n}=mo;let r=2*e;for(;!Vr(r,t);)r=2*(e=Hr(e,n));return jr(e,n)+Gr(r,t)}}}const wo=new i.Vector3,bo=new i.Vector3,Eo=new i.Vector3,Mo=new i.Vector3,zo=new i.Vector3,So=new i.Vector2,To=new i.Vector2,Ao=new i.Vector2,_o=new i.Vector3,Do=new i.Vector3,Po=new i.Vector3,Co=new i.Vector3;function Ro(e,t,n,r,o,a,s){const c=3*r;let l=c+0,u=c+1,d=c+2;const f=e.index;e.index&&(l=f.getX(l),u=f.getX(u),d=f.getX(d));const{position:m,normal:h,uv:p,uv1:y}=e.attributes,g=function(e,t,n,r,o,a,s,c,l,u,d){Eo.fromBufferAttribute(t,a),Mo.fromBufferAttribute(t,s),zo.fromBufferAttribute(t,c);const f=function(e,t,n,r,o,a,s,c){let l;if(l=a===i.BackSide?e.intersectTriangle(r,n,t,!0,o):e.intersectTriangle(t,n,r,a!==i.DoubleSide,o),null===l)return null;const u=e.origin.distanceTo(o);return u<s||u>c?null:{distance:u,point:o.clone()}}(e,Eo,Mo,zo,Co,l,u,d);if(f){r&&(So.fromBufferAttribute(r,a),To.fromBufferAttribute(r,s),Ao.fromBufferAttribute(r,c),f.uv=i.Triangle.getInterpolation(Co,Eo,Mo,zo,So,To,Ao,new i.Vector2)),o&&(So.fromBufferAttribute(o,a),To.fromBufferAttribute(o,s),Ao.fromBufferAttribute(o,c),f.uv1=i.Triangle.getInterpolation(Co,Eo,Mo,zo,So,To,Ao,new i.Vector2)),n&&(_o.fromBufferAttribute(n,a),Do.fromBufferAttribute(n,s),Po.fromBufferAttribute(n,c),f.normal=i.Triangle.getInterpolation(Co,Eo,Mo,zo,_o,Do,Po,new i.Vector3),f.normal.dot(e.direction)>0&&f.normal.multiplyScalar(-1));const t={a:a,b:s,c:c,normal:new i.Vector3,materialIndex:0};i.Triangle.getNormal(Eo,Mo,zo,t.normal),f.face=t,f.faceIndex=a}return f}(n,m,h,p,y,l,u,d,t,a,s);return g?(g.faceIndex=r,o&&o.push(g),g):null}function Fo(e,t,n,r){const o=e.a,a=e.b,i=e.c;let s=t,c=t+1,l=t+2;n&&(s=n.getX(s),c=n.getX(c),l=n.getX(l)),o.x=r.getX(s),o.y=r.getY(s),o.z=r.getZ(s),a.x=r.getX(c),a.y=r.getY(c),a.z=r.getZ(c),i.x=r.getX(l),i.y=r.getY(l),i.z=r.getZ(l)}function ko(e,t,n,r,o,a,i){const{geometry:s}=n,{index:c}=s,l=s.attributes.position;for(let u=e,d=t+e;u<d;u++){let e;if(e=u,Fo(i,3*e,c,l),i.needsUpdate=!0,r(i,e,o,a))return!0}return!1}function Bo(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,r=n.index?n.index.array:null,o=n.attributes.position;let a,i,s,c,l=0;const u=e._roots;for(let f=0,m=u.length;f<m;f++)a=u[f],i=new Uint32Array(a),s=new Uint16Array(a),c=new Float32Array(a),d(0,l),l+=a.byteLength;function d(e,n,a=!1){const l=2*e;if(s[l+15]===xr){const t=i[e+6];let n=1/0,a=1/0,u=1/0,d=-1/0,f=-1/0,m=-1/0;for(let e=3*t,i=3*(t+s[l+14]);e<i;e++){let t=r[e];const i=o.getX(t),s=o.getY(t),c=o.getZ(t);i<n&&(n=i),i>d&&(d=i),s<a&&(a=s),s>f&&(f=s),c<u&&(u=c),c>m&&(m=c)}return(c[e+0]!==n||c[e+1]!==a||c[e+2]!==u||c[e+3]!==d||c[e+4]!==f||c[e+5]!==m)&&(c[e+0]=n,c[e+1]=a,c[e+2]=u,c[e+3]=d,c[e+4]=f,c[e+5]=m,!0)}{const r=e+8,o=i[e+6],s=r+n,l=o+n;let u=a,f=!1,m=!1;t?u||(f=t.has(s),m=t.has(l),u=!f&&!m):(f=!0,m=!0);const h=u||m;let p=!1;(u||f)&&(p=d(r,n,u));let y=!1;h&&(y=d(o,n,u));const g=p||y;if(g)for(let t=0;t<3;t++){const n=r+t,a=o+t,i=c[n],s=c[n+3],l=c[a],u=c[a+3];c[e+t]=i<l?i:l,c[e+t+3]=s>u?s:u}return g}}}function Io(e,t,n,r,o){let a,i,s,c,l,u;const d=1/n.direction.x,f=1/n.direction.y,m=1/n.direction.z,h=n.origin.x,p=n.origin.y,y=n.origin.z;let g=t[e],v=t[e+3],x=t[e+1],w=t[e+3+1],b=t[e+2],E=t[e+3+2];return d>=0?(a=(g-h)*d,i=(v-h)*d):(a=(v-h)*d,i=(g-h)*d),f>=0?(s=(x-p)*f,c=(w-p)*f):(s=(w-p)*f,c=(x-p)*f),!(a>c||s>i)&&((s>a||isNaN(a))&&(a=s),(c<i||isNaN(i))&&(i=c),m>=0?(l=(b-y)*m,u=(E-y)*m):(l=(E-y)*m,u=(b-y)*m),!(a>u||l>i)&&((l>a||a!==a)&&(a=l),(u<i||i!==i)&&(i=u),a<=o&&i>=r))}function Lo(e,t,n,r,o,a,i){mo.setBuffer(e._roots[t]),Uo(0,e,n,r,o,a,i),mo.clearBuffer()}function Uo(e,t,n,r,o,a,i){const{float32Array:s,uint16Array:c,uint32Array:l}=mo,u=2*e;if(Vr(u,c))!function(e,t,n,r,o,a,i,s){const{geometry:c,_indirectBuffer:l}=e;for(let u=r,d=r+o;u<d;u++)Ro(c,t,n,u,a,i,s)}(t,n,r,jr(e,l),Gr(u,c),o,a,i);else{const c=Wr(e);Io(c,s,r,a,i)&&Uo(c,t,n,r,o,a,i);const u=Hr(e,l);Io(u,s,r,a,i)&&Uo(u,t,n,r,o,a,i)}}const Oo=["x","y","z"];function No(e,t,n,r,o,a){mo.setBuffer(e._roots[t]);const i=Vo(0,e,n,r,o,a);return mo.clearBuffer(),i}function Vo(e,t,n,r,o,a){const{float32Array:i,uint16Array:s,uint32Array:c}=mo;let l=2*e;if(Vr(l,s))return function(e,t,n,r,o,a,i){const{geometry:s,_indirectBuffer:c}=e;let l=1/0,u=null;for(let d=r,f=r+o;d<f;d++){let e;e=Ro(s,t,n,d,null,a,i),e&&e.distance<l&&(u=e,l=e.distance)}return u}(t,n,r,jr(e,c),Gr(l,s),o,a);{const s=Xr(e,c),l=Oo[s],u=r.direction[l]>=0;let d,f;u?(d=Wr(e),f=Hr(e,c)):(d=Hr(e,c),f=Wr(e));const m=Io(d,i,r,o,a)?Vo(d,t,n,r,o,a):null;if(m){const e=m.point[l];if(u?e<=i[f+s]:e>=i[f+s+3])return m}const h=Io(f,i,r,o,a)?Vo(f,t,n,r,o,a):null;return m&&h?m.distance<=h.distance?m:h:m||h||null}}const jo=new i.Box3,Go=new so,Wo=new so,Ho=new i.Matrix4,Xo=new co,qo=new co;function $o(e,t,n,r){mo.setBuffer(e._roots[t]);const o=Yo(0,e,n,r);return mo.clearBuffer(),o}function Yo(e,t,n,r,o=null){const{float32Array:a,uint16Array:i,uint32Array:s}=mo;let c=2*e;if(null===o&&(n.boundingBox||n.computeBoundingBox(),Xo.set(n.boundingBox.min,n.boundingBox.max,r),o=Xo),!Vr(c,i)){const i=e+8,c=s[e+6];return Dr(i,a,jo),!(!o.intersectsBox(jo)||!Yo(i,t,n,r,o))||(Dr(c,a,jo),!(!o.intersectsBox(jo)||!Yo(c,t,n,r,o)))}{const o=t.geometry,l=o.index,u=o.attributes.position,d=n.index,f=n.attributes.position,m=jr(e,s),h=Gr(c,i);if(Ho.copy(r).invert(),n.boundsTree){Dr(e,a,qo),qo.matrix.copy(Ho),qo.needsUpdate=!0;const t=n.boundsTree.shapecast({intersectsBounds:e=>qo.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let t=3*m,n=3*(h+m);t<n;t+=3)if(Fo(Wo,t,l,u),Wo.needsUpdate=!0,e.intersectsTriangle(Wo))return!0;return!1}});return t}for(let e=3*m,t=3*(h+m);e<t;e+=3){Fo(Go,e,l,u),Go.a.applyMatrix4(Ho),Go.b.applyMatrix4(Ho),Go.c.applyMatrix4(Ho),Go.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Fo(Wo,e,d,f),Wo.needsUpdate=!0,Go.intersectsTriangle(Wo))return!0}}}const Ko=new i.Matrix4,Zo=new co,Qo=new co,Jo=new i.Vector3,ea=new i.Vector3,ta=new i.Vector3,na=new i.Vector3;function ra(e,t,n,r={},o={},a=0,i=1/0){t.boundingBox||t.computeBoundingBox(),Zo.set(t.boundingBox.min,t.boundingBox.max,n),Zo.needsUpdate=!0;const s=e.geometry,c=s.attributes.position,l=s.index,u=t.attributes.position,d=t.index,f=fo.getPrimitive(),m=fo.getPrimitive();let h=Jo,p=ea,y=null,g=null;o&&(y=ta,g=na);let v=1/0,x=null,w=null;return Ko.copy(n).invert(),Qo.matrix.copy(Ko),e.shapecast({boundsTraverseOrder:e=>Zo.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<i&&(t&&(Qo.min.copy(e.min),Qo.max.copy(e.max),Qo.needsUpdate=!0),!0),intersectsRange:(e,r)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>Qo.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<i,intersectsRange:(t,o)=>{for(let i=t,s=t+o;i<s;i++){Fo(m,3*i,d,u),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++){Fo(f,3*t,l,c),f.needsUpdate=!0;const e=f.distanceToTriangle(m,h,y);if(e<v&&(p.copy(h),g&&g.copy(y),v=e,x=t,w=i),e<a)return!0}}}});for(let o=0,i=zr(t);o<i;o++){Fo(m,3*o,d,u),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++){Fo(f,3*t,l,c),f.needsUpdate=!0;const e=f.distanceToTriangle(m,h,y);if(e<v&&(p.copy(h),g&&g.copy(y),v=e,x=t,w=o),e<a)return!0}}}}),fo.releasePrimitive(f),fo.releasePrimitive(m),v===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=v,r.faceIndex=x,o&&(o.point?o.point.copy(g):o.point=g.clone(),o.point.applyMatrix4(Ko),p.applyMatrix4(Ko),o.distance=p.sub(o.point).length(),o.faceIndex=w),r)}function oa(e,t,n,r,o,a,i){const{geometry:s}=n,{index:c}=s,l=s.attributes.position;for(let u=e,d=t+e;u<d;u++){let e;if(e=n.resolveTriangleIndex(u),Fo(i,3*e,c,l),i.needsUpdate=!0,r(i,e,o,a))return!0}return!1}function aa(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,r=n.index?n.index.array:null,o=n.attributes.position;let a,i,s,c,l=0;const u=e._roots;for(let f=0,m=u.length;f<m;f++)a=u[f],i=new Uint32Array(a),s=new Uint16Array(a),c=new Float32Array(a),d(0,l),l+=a.byteLength;function d(n,a,l=!1){const u=2*n;if(s[u+15]===xr){const t=i[n+6];let a=1/0,l=1/0,d=1/0,f=-1/0,m=-1/0,h=-1/0;for(let n=t,i=t+s[u+14];n<i;n++){const t=3*e.resolveTriangleIndex(n);for(let e=0;e<3;e++){let n=t+e;n=r?r[n]:n;const i=o.getX(n),s=o.getY(n),c=o.getZ(n);i<a&&(a=i),i>f&&(f=i),s<l&&(l=s),s>m&&(m=s),c<d&&(d=c),c>h&&(h=c)}}return(c[n+0]!==a||c[n+1]!==l||c[n+2]!==d||c[n+3]!==f||c[n+4]!==m||c[n+5]!==h)&&(c[n+0]=a,c[n+1]=l,c[n+2]=d,c[n+3]=f,c[n+4]=m,c[n+5]=h,!0)}{const e=n+8,r=i[n+6],o=e+a,s=r+a;let u=l,f=!1,m=!1;t?u||(f=t.has(o),m=t.has(s),u=!f&&!m):(f=!0,m=!0);const h=u||m;let p=!1;(u||f)&&(p=d(e,a,u));let y=!1;h&&(y=d(r,a,u));const g=p||y;if(g)for(let t=0;t<3;t++){const o=e+t,a=r+t,i=c[o],s=c[o+3],l=c[a],u=c[a+3];c[n+t]=i<l?i:l,c[n+t+3]=s>u?s:u}return g}}}function ia(e,t,n,r,o,a,i){mo.setBuffer(e._roots[t]),sa(0,e,n,r,o,a,i),mo.clearBuffer()}function sa(e,t,n,r,o,a,i){const{float32Array:s,uint16Array:c,uint32Array:l}=mo,u=2*e;if(Vr(u,c))!function(e,t,n,r,o,a,i,s){const{geometry:c,_indirectBuffer:l}=e;for(let u=r,d=r+o;u<d;u++)Ro(c,t,n,l?l[u]:u,a,i,s)}(t,n,r,jr(e,l),Gr(u,c),o,a,i);else{const c=Wr(e);Io(c,s,r,a,i)&&sa(c,t,n,r,o,a,i);const u=Hr(e,l);Io(u,s,r,a,i)&&sa(u,t,n,r,o,a,i)}}const ca=["x","y","z"];function la(e,t,n,r,o,a){mo.setBuffer(e._roots[t]);const i=ua(0,e,n,r,o,a);return mo.clearBuffer(),i}function ua(e,t,n,r,o,a){const{float32Array:i,uint16Array:s,uint32Array:c}=mo;let l=2*e;if(Vr(l,s))return function(e,t,n,r,o,a,i){const{geometry:s,_indirectBuffer:c}=e;let l=1/0,u=null;for(let d=r,f=r+o;d<f;d++){let e;e=Ro(s,t,n,c?c[d]:d,null,a,i),e&&e.distance<l&&(u=e,l=e.distance)}return u}(t,n,r,jr(e,c),Gr(l,s),o,a);{const s=Xr(e,c),l=ca[s],u=r.direction[l]>=0;let d,f;u?(d=Wr(e),f=Hr(e,c)):(d=Hr(e,c),f=Wr(e));const m=Io(d,i,r,o,a)?ua(d,t,n,r,o,a):null;if(m){const e=m.point[l];if(u?e<=i[f+s]:e>=i[f+s+3])return m}const h=Io(f,i,r,o,a)?ua(f,t,n,r,o,a):null;return m&&h?m.distance<=h.distance?m:h:m||h||null}}const da=new i.Box3,fa=new so,ma=new so,ha=new i.Matrix4,pa=new co,ya=new co;function ga(e,t,n,r){mo.setBuffer(e._roots[t]);const o=va(0,e,n,r);return mo.clearBuffer(),o}function va(e,t,n,r,o=null){const{float32Array:a,uint16Array:i,uint32Array:s}=mo;let c=2*e;if(null===o&&(n.boundingBox||n.computeBoundingBox(),pa.set(n.boundingBox.min,n.boundingBox.max,r),o=pa),!Vr(c,i)){const i=e+8,c=s[e+6];return Dr(i,a,da),!(!o.intersectsBox(da)||!va(i,t,n,r,o))||(Dr(c,a,da),!(!o.intersectsBox(da)||!va(c,t,n,r,o)))}{const o=t.geometry,l=o.index,u=o.attributes.position,d=n.index,f=n.attributes.position,m=jr(e,s),h=Gr(c,i);if(ha.copy(r).invert(),n.boundsTree){Dr(e,a,ya),ya.matrix.copy(ha),ya.needsUpdate=!0;const o=n.boundsTree.shapecast({intersectsBounds:e=>ya.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let n=m,r=h+m;n<r;n++)if(Fo(ma,3*t.resolveTriangleIndex(n),l,u),ma.needsUpdate=!0,e.intersectsTriangle(ma))return!0;return!1}});return o}for(let e=m,n=h+m;e<n;e++){const n=t.resolveTriangleIndex(e);Fo(fa,3*n,l,u),fa.a.applyMatrix4(ha),fa.b.applyMatrix4(ha),fa.c.applyMatrix4(ha),fa.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Fo(ma,e,d,f),ma.needsUpdate=!0,fa.intersectsTriangle(ma))return!0}}}const xa=new i.Matrix4,wa=new co,ba=new co,Ea=new i.Vector3,Ma=new i.Vector3,za=new i.Vector3,Sa=new i.Vector3;function Ta(e,t,n,r={},o={},a=0,i=1/0){t.boundingBox||t.computeBoundingBox(),wa.set(t.boundingBox.min,t.boundingBox.max,n),wa.needsUpdate=!0;const s=e.geometry,c=s.attributes.position,l=s.index,u=t.attributes.position,d=t.index,f=fo.getPrimitive(),m=fo.getPrimitive();let h=Ea,p=Ma,y=null,g=null;o&&(y=za,g=Sa);let v=1/0,x=null,w=null;return xa.copy(n).invert(),ba.matrix.copy(xa),e.shapecast({boundsTraverseOrder:e=>wa.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<i&&(t&&(ba.min.copy(e.min),ba.max.copy(e.max),ba.needsUpdate=!0),!0),intersectsRange:(r,o)=>{if(t.boundsTree){const s=t.boundsTree;return s.shapecast({boundsTraverseOrder:e=>ba.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<i,intersectsRange:(t,i)=>{for(let b=t,E=t+i;b<E;b++){const t=s.resolveTriangleIndex(b);Fo(m,3*t,d,u),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let n=r,i=r+o;n<i;n++){const t=e.resolveTriangleIndex(n);Fo(f,3*t,l,c),f.needsUpdate=!0;const r=f.distanceToTriangle(m,h,y);if(r<v&&(p.copy(h),g&&g.copy(y),v=r,x=n,w=b),r<a)return!0}}}})}for(let i=0,s=zr(t);i<s;i++){Fo(m,3*i,d,u),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let t=r,n=r+o;t<n;t++){const n=e.resolveTriangleIndex(t);Fo(f,3*n,l,c),f.needsUpdate=!0;const r=f.distanceToTriangle(m,h,y);if(r<v&&(p.copy(h),g&&g.copy(y),v=r,x=t,w=i),r<a)return!0}}}}),fo.releasePrimitive(f),fo.releasePrimitive(m),v===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=v,r.faceIndex=x,o&&(o.point?o.point.copy(g):o.point=g.clone(),o.point.applyMatrix4(xa),p.applyMatrix4(xa),o.distance=p.sub(o.point).length(),o.faceIndex=w),r)}const Aa=new mo.constructor,_a=new mo.constructor,Da=new lo((()=>new i.Box3)),Pa=new i.Box3,Ca=new i.Box3,Ra=new i.Box3,Fa=new i.Box3;let ka=!1;function Ba(e,t,n,r,o,a=0,i=0,s=0,c=0,l=null,u=!1){let d,f;u?(d=_a,f=Aa):(d=Aa,f=_a);const m=d.float32Array,h=d.uint32Array,p=d.uint16Array,y=f.float32Array,g=f.uint32Array,v=f.uint16Array,x=2*t,w=Vr(2*e,p),b=Vr(x,v);let E=!1;if(b&&w)E=u?o(jr(t,g),Gr(2*t,v),jr(e,h),Gr(2*e,p),c,i+t,s,a+e):o(jr(e,h),Gr(2*e,p),jr(t,g),Gr(2*t,v),s,a+e,c,i+t);else if(b){const l=Da.getPrimitive();Dr(t,y,l),l.applyMatrix4(n);const d=Wr(e),f=Hr(e,h);Dr(d,m,Pa),Dr(f,m,Ca);const p=l.intersectsBox(Pa),g=l.intersectsBox(Ca);E=p&&Ba(t,d,r,n,o,i,a,c,s+1,l,!u)||g&&Ba(t,f,r,n,o,i,a,c,s+1,l,!u),Da.releasePrimitive(l)}else{const d=Wr(t),f=Hr(t,g);Dr(d,y,Ra),Dr(f,y,Fa);const p=l.intersectsBox(Ra),v=l.intersectsBox(Fa);if(p&&v)E=Ba(e,d,n,r,o,a,i,s,c+1,l,u)||Ba(e,f,n,r,o,a,i,s,c+1,l,u);else if(p)if(w)E=Ba(e,d,n,r,o,a,i,s,c+1,l,u);else{const t=Da.getPrimitive();t.copy(Ra).applyMatrix4(n);const l=Wr(e),f=Hr(e,h);Dr(l,m,Pa),Dr(f,m,Ca);const p=t.intersectsBox(Pa),y=t.intersectsBox(Ca);E=p&&Ba(d,l,r,n,o,i,a,c,s+1,t,!u)||y&&Ba(d,f,r,n,o,i,a,c,s+1,t,!u),Da.releasePrimitive(t)}else if(v)if(w)E=Ba(e,f,n,r,o,a,i,s,c+1,l,u);else{const t=Da.getPrimitive();t.copy(Fa).applyMatrix4(n);const l=Wr(e),d=Hr(e,h);Dr(l,m,Pa),Dr(d,m,Ca);const p=t.intersectsBox(Pa),y=t.intersectsBox(Ca);E=p&&Ba(f,l,r,n,o,i,a,c,s+1,t,!u)||y&&Ba(f,d,r,n,o,i,a,c,s+1,t,!u),Da.releasePrimitive(t)}}return E}const Ia=new co,La=new i.Box3,Ua={strategy:0,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};class Oa{static serialize(e,t={}){t={cloneBuffers:!0,...t};const n=e.geometry,r=e._roots,o=e._indirectBuffer,a=n.getIndex();let i;return i=t.cloneBuffers?{roots:r.map((e=>e.slice())),index:a?a.array.slice():null,indirectBuffer:o?o.slice():null}:{roots:r,index:a?a.array:null,indirectBuffer:o},i}static deserialize(e,t,n={}){n={setIndex:!0,indirect:Boolean(e.indirectBuffer),...n};const{index:r,roots:o,indirectBuffer:a}=e,s=new Oa(t,{...n,[br]:!0});if(s._roots=o,s._indirectBuffer=a||null,n.setIndex){const n=t.getIndex();if(null===n){const n=new i.BufferAttribute(e.index,1,!1);t.setIndex(n)}else n.array!==r&&(n.array.set(r),n.needsUpdate=!0)}return s}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((t=Object.assign({...Ua,[br]:!1},t)).useSharedArrayBuffer&&"undefined"===typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[br]||(to(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new i.Box3))),this.resolveTriangleIndex=t.indirect?e=>this._indirectBuffer[e]:e=>e}refit(e=null){return(this.indirect?aa:Bo)(this,e)}traverse(e,t=0){const n=this._roots[t],r=new Uint32Array(n),o=new Uint16Array(n);!function t(a,i=0){const s=2*a,c=o[s+15]===xr;if(c){const t=r[a+6],l=o[s+14];e(i,c,new Float32Array(n,4*a,6),t,l)}else{const o=a+8,s=r[a+6],l=r[a+7];e(i,c,new Float32Array(n,4*a,6),l)||(t(o,i+1),t(s,i+1))}}(0)}raycast(e,t=i.FrontSide,n=0,r=1/0){const o=this._roots,a=this.geometry,s=[],c=t.isMaterial,l=Array.isArray(t),u=a.groups,d=c?t.side:t,f=this.indirect?ia:Lo;for(let i=0,m=o.length;i<m;i++){const o=l?t[u[i].materialIndex].side:d,a=s.length;if(f(this,i,o,e,s,n,r),l){const e=u[i].materialIndex;for(let t=a,n=s.length;t<n;t++)s[t].face.materialIndex=e}}return s}raycastFirst(e,t=i.FrontSide,n=0,r=1/0){const o=this._roots,a=this.geometry,s=t.isMaterial,c=Array.isArray(t);let l=null;const u=a.groups,d=s?t.side:t,f=this.indirect?la:No;for(let i=0,m=o.length;i<m;i++){const o=f(this,i,c?t[u[i].materialIndex].side:d,e,n,r);null!=o&&(null==l||o.distance<l.distance)&&(l=o,c&&(o.face.materialIndex=u[i].materialIndex))}return l}intersectsGeometry(e,t){let n=!1;const r=this._roots,o=this.indirect?ga:$o;for(let a=0,i=r.length;a<i&&(n=o(this,a,e,t),!n);a++);return n}shapecast(e){const t=fo.getPrimitive(),n=this.indirect?oa:ko;let{boundsTraverseOrder:r,intersectsBounds:o,intersectsRange:a,intersectsTriangle:i}=e;if(a&&i){const e=a;a=(r,o,a,s,c)=>!!e(r,o,a,s,c)||n(r,o,this,i,a,s,t)}else a||(a=i?(e,r,o,a)=>n(e,r,this,i,o,a,t):(e,t,n)=>n);let s=!1,c=0;const l=this._roots;for(let u=0,d=l.length;u<d;u++){const e=l[u];if(s=vo(this,u,o,a,r,c),s)break;c+=e.byteLength}return fo.releasePrimitive(t),s}bvhcast(e,t,n){let{intersectsRanges:r,intersectsTriangles:o}=n;const a=fo.getPrimitive(),s=this.geometry.index,c=this.geometry.attributes.position,l=this.indirect?e=>{const t=this.resolveTriangleIndex(e);Fo(a,3*t,s,c)}:e=>{Fo(a,3*e,s,c)},u=fo.getPrimitive(),d=e.geometry.index,f=e.geometry.attributes.position,m=e.indirect?t=>{const n=e.resolveTriangleIndex(t);Fo(u,3*n,d,f)}:e=>{Fo(u,3*e,d,f)};if(o){const e=(e,n,r,i,s,c,d,f)=>{for(let h=r,p=r+i;h<p;h++){m(h),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++)if(l(t),a.needsUpdate=!0,o(a,u,t,h,s,c,d,f))return!0}return!1};if(r){const t=r;r=function(n,r,o,a,i,s,c,l){return!!t(n,r,o,a,i,s,c,l)||e(n,r,o,a,i,s,c,l)}}else r=e}return function(e,t,n,r){if(ka)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");ka=!0;const o=e._roots,a=t._roots;let s,c=0,l=0;const u=(new i.Matrix4).copy(n).invert();for(let i=0,d=o.length;i<d;i++){Aa.setBuffer(o[i]),l=0;const e=Da.getPrimitive();Dr(0,Aa.float32Array,e),e.applyMatrix4(u);for(let t=0,o=a.length;t<o&&(_a.setBuffer(a[t]),s=Ba(0,0,n,u,r,c,l,0,0,e),_a.clearBuffer(),l+=a[t].length,!s);t++);if(Da.releasePrimitive(e),Aa.clearBuffer(),c+=o[i].length,s)break}return ka=!1,s}(this,e,t,r)}intersectsBox(e,t){return Ia.set(e.min,e.max,t),Ia.needsUpdate=!0,this.shapecast({intersectsBounds:e=>Ia.intersectsBox(e),intersectsTriangle:e=>Ia.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,n={},r={},o=0,a=1/0){return(this.indirect?Ta:ra)(this,e,t,n,r,o,a)}closestPointToPoint(e,t={},n=0,r=1/0){return function(e,t,n={},r=0,o=1/0){const a=r*r,i=o*o;let s=1/0,c=null;if(e.shapecast({boundsTraverseOrder:e=>(wo.copy(t).clamp(e.min,e.max),wo.distanceToSquared(t)),intersectsBounds:(e,t,n)=>n<s&&n<i,intersectsTriangle:(e,n)=>{e.closestPointToPoint(t,wo);const r=t.distanceToSquared(wo);return r<s&&(bo.copy(wo),s=r,c=n),r<a}}),s===1/0)return null;const l=Math.sqrt(s);return n.point?n.point.copy(bo):n.point=bo.clone(),n.distance=l,n.faceIndex=c,n}(this,e,t,n,r)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{Dr(0,new Float32Array(t),La),e.union(La)})),e}}const Na=i.BatchedMesh||null,Va=(parseInt(i.REVISION),new i.Ray),ja=new i.Vector3,Ga=new i.Matrix4,Wa=i.Mesh.prototype.raycast,Ha=null!==Na?Na.prototype.raycast:null,Xa=new i.Vector3,qa=new i.Mesh,$a=[];function Ya(e,t){this.isBatchedMesh?Ka.call(this,e,t):Za.call(this,e,t)}function Ka(e,t){if(this.boundsTrees){const n=this.boundsTrees,r=this._drawInfo,o=this._drawRanges,a=this.matrixWorld;qa.material=this.material,qa.geometry=this.geometry;const s=qa.geometry.boundsTree,c=qa.geometry.drawRange;null===qa.geometry.boundingSphere&&(qa.geometry.boundingSphere=new i.Sphere);for(let i=0,l=r.length;i<l;i++){if(!this.getVisibleAt(i))continue;const s=r[i].geometryIndex;if(qa.geometry.boundsTree=n[s],this.getMatrixAt(i,qa.matrixWorld).premultiply(a),!qa.geometry.boundsTree){this.getBoundingBoxAt(s,qa.geometry.boundingBox),this.getBoundingSphereAt(s,qa.geometry.boundingSphere);const e=o[s];qa.geometry.setDrawRange(e.start,e.count)}qa.raycast(e,$a);for(let e=0,n=$a.length;e<n;e++){const n=$a[e];n.object=this,n.batchId=i,t.push(n)}$a.length=0}qa.geometry.boundsTree=s,qa.geometry.drawRange=c,qa.material=null,qa.geometry=null}else Ha.call(this,e,t)}function Za(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;Ga.copy(this.matrixWorld).invert(),Va.copy(e.ray).applyMatrix4(Ga),Xa.setFromMatrixScale(this.matrixWorld),ja.copy(Va.direction).multiply(Xa);const n=ja.length(),r=e.near/n,o=e.far/n,a=this.geometry.boundsTree;if(!0===e.firstHitOnly){const n=Er(a.raycastFirst(Va,this.material,r,o),this,e);n&&t.push(n)}else{const n=a.raycast(Va,this.material,r,o);for(let r=0,o=n.length;r<o;r++){const o=Er(n[r],this,e);o&&t.push(o)}}}else Wa.call(this,e,t)}function Qa(e={}){return this.boundsTree=new Oa(this,e),this.boundsTree}function Ja(){this.boundsTree=null}const ei=e=>e.isMesh;function ti(e,t){t={strategy:yr,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...t},o.useEffect((()=>{if(e.current){e.current.raycast=Ya;const n=e.current.geometry;return n.computeBoundsTree=Qa,n.disposeBoundsTree=Ja,n.computeBoundsTree(t),()=>{n.boundsTree&&n.disposeBoundsTree()}}}),[e,JSON.stringify(t)])}const ni=o.forwardRef((({enabled:e=!0,firstHitOnly:t=!1,children:n,strategy:a=yr,verbose:c=!1,setBoundingBox:l=!0,maxDepth:u=40,maxLeafTris:d=10,indirect:f=!1,...m},h)=>{const p=o.useRef(null),y=(0,s.D)((e=>e.raycaster));return o.useImperativeHandle(h,(()=>p.current),[]),o.useEffect((()=>{if(e){const e={strategy:a,verbose:c,setBoundingBox:l,maxDepth:u,maxLeafTris:d,indirect:f},n=p.current;return y.firstHitOnly=t,n.traverse((t=>{ei(t)&&!t.geometry.boundsTree&&t.raycast===i.Mesh.prototype.raycast&&(t.raycast=Ya,t.geometry.computeBoundsTree=Qa,t.geometry.disposeBoundsTree=Ja,t.geometry.computeBoundsTree(e))})),()=>{delete y.firstHitOnly,n.traverse((e=>{ei(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=i.Mesh.prototype.raycast)}))}}}),[]),o.createElement("group",(0,r.A)({ref:p},m),n)}));function ri(...e){const t=o.useRef([]);return t.current=e.map((e=>o.useContext(e))),o.useMemo((()=>({children:n})=>e.reduceRight(((e,n,r)=>o.createElement(n.Provider,{value:t.current[r],children:e})),n)),[])}function oi(e,t){const n=o.useRef(),[r]=o.useState((()=>t?t instanceof i.Object3D?{current:t}:t:n)),[a]=o.useState((()=>new i.AnimationMixer(void 0)));o.useLayoutEffect((()=>{t&&(r.current=t instanceof i.Object3D?t:t.current),a._root=r.current}));const c=o.useRef({}),l=o.useMemo((()=>{const t={};return e.forEach((e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(r.current)return c.current[e.name]||(c.current[e.name]=a.clipAction(e,r.current))},configurable:!0}))),{ref:r,clips:e,actions:t,names:e.map((e=>e.name)),mixer:a}}),[e]);return(0,s.F)(((e,t)=>a.update(t))),o.useEffect((()=>{const e=r.current;return()=>{c.current={},a.stopAllAction(),Object.values(l.actions).forEach((t=>{e&&a.uncacheAction(t,e)}))}}),[e]),l}function ai(e){const t=o.useRef(null),n=o.useRef(!1),r=o.useRef(!1),a=o.useRef(e);return o.useLayoutEffect((()=>{a.current=e}),[e]),o.useEffect((()=>{const e=t.current;if(e){const t=(0,s.o)((()=>(n.current=!1,!0))),o=e.onBeforeRender;e.onBeforeRender=()=>n.current=!0;const i=(0,s.p)((()=>(n.current!==r.current&&(null==a.current||a.current(r.current=n.current)),!0)));return()=>{e.onBeforeRender=o,t(),i()}}}),[]),t}const ii="\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n  vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n  #ifdef BOX_PROJECTED_ENV_MAP\n    vWorldPosition = worldPosition.xyz;\n  #endif\n#endif\n",si="\n#ifdef BOX_PROJECTED_ENV_MAP\n  uniform vec3 envMapSize;\n  uniform vec3 envMapPosition;\n  varying vec3 vWorldPosition;\n    \n  vec3 parallaxCorrectNormal( vec3 v, vec3 cubeSize, vec3 cubePos ) {\n    vec3 nDir = normalize( v );\n    vec3 rbmax = ( .5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbmin = ( -.5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbminmax;\n    rbminmax.x = ( nDir.x > 0. ) ? rbmax.x : rbmin.x;\n    rbminmax.y = ( nDir.y > 0. ) ? rbmax.y : rbmin.y;\n    rbminmax.z = ( nDir.z > 0. ) ? rbmax.z : rbmin.z;\n    float correction = min( min( rbminmax.x, rbminmax.y ), rbminmax.z );\n    vec3 boxIntersection = vWorldPosition + nDir * correction;    \n    return boxIntersection - cubePos;\n  }\n#endif\n",ci="\n#ifdef BOX_PROJECTED_ENV_MAP\n  worldNormal = parallaxCorrectNormal( worldNormal, envMapSize, envMapPosition );\n#endif\n",li="\n#ifdef BOX_PROJECTED_ENV_MAP\n  reflectVec = parallaxCorrectNormal( reflectVec, envMapSize, envMapPosition );\n#endif\n";function ui(e=new i.Vector3,t=new i.Vector3){const[n]=o.useState((()=>({position:new i.Vector3,size:new i.Vector3})));(0,s.k)(n,{position:e,size:t});const r=o.useRef(null),a=o.useMemo((()=>({ref:r,onBeforeCompile:e=>function(e,t,n){e.defines.BOX_PROJECTED_ENV_MAP=!0,e.uniforms.envMapPosition={value:t},e.uniforms.envMapSize={value:n},e.vertexShader=`\n  varying vec3 vWorldPosition;\n  ${e.vertexShader.replace("#include <worldpos_vertex>",ii)}`,e.fragmentShader=`\n    ${si}\n    ${e.fragmentShader.replace("#include <envmap_physical_pars_fragment>",i.ShaderChunk.envmap_physical_pars_fragment).replace("vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );",`vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n         ${ci}\n         `).replace("reflectVec = inverseTransformDirection( reflectVec, viewMatrix );",`reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n         ${li}\n        `)}`}(e,n.position,n.size),customProgramCacheKey:()=>JSON.stringify(n.position.toArray())+JSON.stringify(n.size.toArray())})),[...n.position.toArray(),...n.size.toArray()]);return o.useLayoutEffect((()=>{r.current.needsUpdate=!0}),[n]),a}const di=new i.Box3,fi=new i.Vector3,mi=({anchor:e,...t})=>{const n=o.useRef(null),a=o.useRef(null);return o.useEffect((()=>{var e;null!=(e=n.current)&&null!=(e=e.parent)&&e.parent&&(a.current=n.current.parent,n.current.parent.parent.add(n.current))}),[]),(0,s.F)((()=>{a.current&&(di.setFromObject(a.current),di.getSize(fi),n.current.position.set(a.current.position.x+fi.x*(Array.isArray(e)?e[0]:e.x)/2,a.current.position.y+fi.y*(Array.isArray(e)?e[1]:e.y)/2,a.current.position.z+fi.z*(Array.isArray(e)?e[2]:e.z)/2))})),o.createElement("group",(0,r.A)({ref:n},t))},hi=e=>Math.sqrt(1-Math.pow(e-1,2));class pi{constructor({size:e=256,maxAge:t=750,radius:n=.3,intensity:r=.2,interpolate:o=0,smoothing:a=0,minForce:i=.3,blend:s="screen",ease:c=hi}={}){this.size=e,this.maxAge=t,this.radius=n,this.intensity=r,this.ease=c,this.interpolate=o,this.smoothing=a,this.minForce=i,this.blend=s,this.trail=[],this.force=0,this.initTexture()}initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.size;const e=this.canvas.getContext("2d");if(null===e)throw new Error("2D not available");this.ctx=e,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new i.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height=`${this.canvas.width}px`}update(e){this.clear(),this.trail.forEach(((t,n)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(n,1)})),this.trail.length||(this.force=0),this.trail.forEach((e=>{this.drawTouch(e)})),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){const t=this.trail[this.trail.length-1];if(t){const n=t.x-e.x,r=t.y-e.y,o=n*n+r*r,a=Math.max(this.minForce,Math.min(1e4*o,1));if(this.force=function(e,t,n=.9){return t*n+e*(1-n)}(a,this.force,this.smoothing),this.interpolate){const e=Math.ceil(o/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let o=1;o<e;o++)this.trail.push({x:t.x-n/e*o,y:t.y-r/e*o,age:0,force:a})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){const t={x:e.x*this.size,y:(1-e.y)*this.size};let n=1;n=e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)),n*=e.force,this.ctx.globalCompositeOperation=this.blend;const r=this.size*this.radius*n,o=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*r),t.x,t.y,Math.max(0,r));o.addColorStop(0,`rgba(255, 255, 255, ${this.intensity})`),o.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=o,this.ctx.arc(t.x,t.y,Math.max(0,r),0,2*Math.PI),this.ctx.fill()}}function yi(e={}){const{size:t,maxAge:n,radius:r,intensity:a,interpolate:i,smoothing:c,minForce:l,blend:u,ease:d}=e,f=(0,o.useMemo)((()=>new pi(e)),[t,n,r,a,i,c,l,u,d]);(0,s.F)(((e,t)=>{f.update(t)}));const m=(0,o.useCallback)((e=>f.addTouch(e.uv)),[f]);return[f.texture,m]}const gi=({children:e,...t})=>{const n=yi(t);return o.createElement(o.Fragment,null,null==e?void 0:e(n))},vi=o.forwardRef((function({children:e,disable:t,disableX:n,disableY:a,disableZ:s,left:c,right:l,top:u,bottom:d,front:f,back:m,onCentered:h,precise:p=!0,cacheKey:y=0,...g},v){const x=o.useRef(null),w=o.useRef(null),b=o.useRef(null);return o.useLayoutEffect((()=>{w.current.matrixWorld.identity();const e=(new i.Box3).setFromObject(b.current,p),r=new i.Vector3,o=new i.Sphere,y=e.max.x-e.min.x,g=e.max.y-e.min.y,v=e.max.z-e.min.z;e.getCenter(r),e.getBoundingSphere(o);const E=u?g/2:d?-g/2:0,M=c?-y/2:l?y/2:0,z=f?v/2:m?-v/2:0;w.current.position.set(t||n?0:-r.x+M,t||a?0:-r.y+E,t||s?0:-r.z+z),"undefined"!==typeof h&&h({parent:x.current.parent,container:x.current,width:y,height:g,depth:v,boundingBox:e,boundingSphere:o,center:r,verticalAlignment:E,horizontalAlignment:M,depthAlignment:z})}),[y,h,u,c,f,t,n,a,s,p,l,d,m]),o.useImperativeHandle(v,(()=>x.current),[]),o.createElement("group",(0,r.A)({ref:x},g),o.createElement("group",{ref:w},o.createElement("group",{ref:b},e)))})),xi=o.forwardRef((({font:e,color:t="#cbcbcb",bevelSize:n=.04,debug:r=!1,children:a,...i},s)=>{const[c,l]=o.useState(0),u=o.useCallback(((e=1)=>l(c+e)),[c]),d=o.useCallback(((e=1)=>l(c-e)),[c]),f=o.useMemo((()=>({incr:u,decr:d})),[u,d]);return o.useImperativeHandle(s,(()=>f),[f]),o.createElement("group",i,o.createElement(o.Suspense,{fallback:null},o.createElement(vi,{top:!0,cacheKey:JSON.stringify({counter:c,font:e})},o.createElement(De,{bevelEnabled:!0,bevelSize:n,font:e},r?o.createElement("meshNormalMaterial",{wireframe:!0}):o.createElement("meshStandardMaterial",{color:t}),c))),a)}));var wi=n("zG99");const bi=(e,t)=>{"updateRanges"in e?e.updateRanges[0]=t:e.updateRange=t},Ei=3e3,Mi=3001,zi=new i.Matrix4,Si=new i.Matrix4,Ti=[],Ai=new i.Mesh;class _i extends i.Group{constructor(){super(),this.color=new i.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){const n=this.instance.current;if(!n)return;if(!n.geometry||!n.material)return;Ai.geometry=n.geometry;const r=n.matrixWorld,o=n.userData.instances.indexOf(this.instanceKey);if(!(-1===o||o>n.count)){n.getMatrixAt(o,zi),Si.multiplyMatrices(r,zi),Ai.matrixWorld=Si,n.material instanceof i.Material?Ai.material.side=n.material.side:Ai.material.side=n.material[0].side,Ai.raycast(e,Ti);for(let e=0,n=Ti.length;e<n;e++){const n=Ti[e];n.instanceId=o,n.object=this,t.push(n)}Ti.length=0}}}const Di=o.createContext(null),Pi=new i.Matrix4,Ci=new i.Matrix4,Ri=new i.Matrix4,Fi=new i.Vector3,ki=new i.Quaternion,Bi=new i.Vector3,Ii=o.forwardRef((({context:e,children:t,...n},a)=>{o.useMemo((()=>(0,s.e)({PositionMesh:_i})),[]);const i=o.useRef();o.useImperativeHandle(a,(()=>i.current),[]);const{subscribe:c,getParent:l}=o.useContext(e||Di);return o.useLayoutEffect((()=>c(i)),[]),o.createElement("positionMesh",(0,r.A)({instance:l(),instanceKey:i,ref:i},n),t)})),Li=o.forwardRef((({context:e,children:t,range:n,limit:a=1e3,frames:c=1/0,...l},u)=>{const[{localContext:d,instance:f}]=o.useState((()=>{const e=o.createContext(null);return{localContext:e,instance:o.forwardRef(((t,n)=>o.createElement(Ii,(0,r.A)({context:e},t,{ref:n}))))}})),m=o.useRef(null);o.useImperativeHandle(u,(()=>m.current),[]);const[h,p]=o.useState([]),[[y,g]]=o.useState((()=>{const e=new Float32Array(16*a);for(let t=0;t<a;t++)Ri.identity().toArray(e,16*t);return[e,new Float32Array([...new Array(3*a)].map((()=>1)))]}));o.useEffect((()=>{m.current.instanceMatrix.needsUpdate=!0}));let v=0,x=0;const w=o.useRef([]);o.useLayoutEffect((()=>{w.current=Object.entries(m.current.geometry.attributes).filter((([e,t])=>t.isInstancedBufferAttribute))})),(0,s.F)((()=>{if(c===1/0||v<c){m.current.updateMatrix(),m.current.updateMatrixWorld(),Pi.copy(m.current.matrixWorld).invert(),x=Math.min(a,void 0!==n?n:a,h.length),m.current.count=x,bi(m.current.instanceMatrix,{offset:0,count:16*x}),bi(m.current.instanceColor,{offset:0,count:3*x});for(let e=0;e<h.length;e++){const t=h[e].current;t.matrixWorld.decompose(Fi,ki,Bi),Ci.compose(Fi,ki,Bi).premultiply(Pi),Ci.toArray(y,16*e),m.current.instanceMatrix.needsUpdate=!0,t.color.toArray(g,3*e),m.current.instanceColor.needsUpdate=!0}v++}}));const b=o.useMemo((()=>({getParent:()=>m,subscribe:e=>(p((t=>[...t,e])),()=>p((t=>t.filter((t=>t.current!==e.current)))))})),[]);return o.createElement("instancedMesh",(0,r.A)({userData:{instances:h,limit:a,frames:c},matrixAutoUpdate:!1,ref:m,args:[null,null,0],raycast:()=>null},l),o.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:y.length/16,array:y,itemSize:16,usage:i.DynamicDrawUsage}),o.createElement("instancedBufferAttribute",{attach:"instanceColor",count:g.length/3,array:g,itemSize:3,usage:i.DynamicDrawUsage}),"function"===typeof t?o.createElement(d.Provider,{value:b},t(f)):e?o.createElement(e.Provider,{value:b},t):o.createElement(Di.Provider,{value:b},t))})),Ui=o.forwardRef((function({meshes:e,children:t,...n},a){const i=Array.isArray(e);if(!i)for(const r of Object.keys(e))e[r].isMesh||delete e[r];return o.createElement("group",{ref:a},o.createElement(wi.A,{components:(i?e:Object.values(e)).map((({geometry:e,material:t})=>o.createElement(Li,(0,r.A)({key:e.uuid,geometry:e,material:t},n))))},(n=>i?t(...n):t(Object.keys(e).filter((t=>e[t].isMesh)).reduce(((e,t,r)=>({...e,[t]:n[r]})),{})))))}));function Oi(){const e=o.createContext(null);return[o.forwardRef(((t,n)=>o.createElement(Li,(0,r.A)({ref:n,context:e},t)))),o.forwardRef(((t,n)=>o.createElement(Ii,(0,r.A)({ref:n,context:e},t))))]}const Ni=o.forwardRef((({name:e,defaultValue:t,normalized:n,usage:r=i.DynamicDrawUsage},a)=>{const c=o.useRef(null);o.useImperativeHandle(a,(()=>c.current),[]),o.useLayoutEffect((()=>{const n=c.current.__r3f.parent;n.geometry.attributes[e]=c.current;const r=Array.isArray(t)?t:[t],o=Array.from({length:n.userData.limit},(()=>r)).flat();return c.current.array=new Float32Array(o),c.current.itemSize=r.length,c.current.count=o.length/c.current.itemSize,()=>{delete n.geometry.attributes[e]}}),[e]);let l=0;return(0,s.F)((()=>{const t=c.current.__r3f.parent;if(t.userData.frames===1/0||l<t.userData.frames){for(let n=0;n<t.userData.instances.length;n++){const r=t.userData.instances[n].current[e];void 0!==r&&(c.current.set(Array.isArray(r)?r:"function"===typeof r.toArray?r.toArray():[r],n*c.current.itemSize),c.current.needsUpdate=!0)}l++}})),o.createElement("instancedBufferAttribute",{ref:c,usage:r,normalized:n})})),Vi=o.createContext(null);function ji(){return o.useContext(Vi)}const Gi=new i.PlaneGeometry(1,1),Wi=o.forwardRef((({startFrame:e=0,endFrame:t,fps:n=30,frameName:a="",textureDataURL:c,textureImageURL:l,loop:u=!1,numberOfFrames:d=1,autoPlay:f=!0,animationNames:m,onStart:h,onEnd:p,onLoopEnd:y,onFrame:g,play:v,pause:x=!1,flipX:w=!1,alphaTest:b=0,children:E,asSprite:M=!1,offset:z,playBackwards:S=!1,resetOnEnd:T=!1,maxItems:A=1,instanceItems:_=[[0,0,0]],spriteDataset:D,canvasRenderingContext2DSettings:P,roundFramePosition:C=!1,meshProps:R={},...F},k)=>{const B=o.useRef(new i.Group),I=o.useRef(null),L=o.useRef(null),U=o.useRef(null),O=o.useRef(window.performance.now()),N=o.useRef(e),V=o.useRef(a),j=n>0?1e3/n:0,[G,W]=o.useState(new i.Texture),H=o.useRef(0),[X,q]=o.useState(new i.Vector3(1,1,1)),$=w?-1:1,Y=o.useRef(x),K=o.useRef(z),Z=o.useRef(!1),{spriteObj:Q,loadJsonAndTexture:ee}=tr(null,null,m,d,void 0,P),te=o.useRef(a),ne=o.useCallback(((e,t)=>{if(null===t)d&&(H.current=d,S&&(N.current=d-1),I.current=t);else{var n,r;I.current=t,I.current&&Array.isArray(I.current.frames)?H.current=I.current.frames.length:I.current&&"object"===typeof I.current&&te.current?H.current=I.current.frames[te.current].length:H.current=0,S&&(N.current=H.current-1);const{w:o,h:a}=Jn(null!==(n=null==(r=I.current)?void 0:r.frames)&&void 0!==n?n:[],te.current).sourceSize,i=ae(o,a);q(i),L.current&&(L.current.map=e)}W(e)}),[d,S]),re=o.useCallback((()=>{if(!I.current)return;const{meta:{size:e},frames:t}=I.current,{w:n,h:r}=Array.isArray(t)?t[0].sourceSize:a&&t[a]?t[a][0].sourceSize:{w:0,h:0};L.current&&L.current.map&&(L.current.map.wrapS=L.current.map.wrapT=i.RepeatWrapping,L.current.map.center.set(0,0),L.current.map.repeat.set(1*$/(e.w/n),1/(e.h/r)));const o=1/((e.h-1)/r);L.current&&L.current.map&&(L.current.map.offset.x=0,L.current.map.offset.y=1-o),h&&h({currentFrameName:null!==a&&void 0!==a?a:"",currentFrame:N.current})}),[$,a,h]),oe=o.useMemo((()=>({current:K.current,offset:K.current,imageUrl:l,hasEnded:!1,ref:k})),[l,k]);o.useImperativeHandle(k,(()=>B.current),[]),o.useLayoutEffect((()=>{K.current=z}),[z]);const ae=(e,t)=>{var n;const r=new i.Vector3,o=t/e;return r.set(1,o,1),null==(n=U.current)||n.scale.copy(r),r};o.useEffect((()=>{var e;D?ne(null==D||null==(e=D.spriteTexture)?void 0:e.clone(),D.spriteData):l&&c&&ee(l,c)}),[ee,D,c,l,ne]),o.useEffect((()=>{var e;Q&&ne(null==Q||null==(e=Q.spriteTexture)?void 0:e.clone(),null==Q?void 0:Q.spriteData)}),[Q,ne]),o.useEffect((()=>{var e;oe.hasEnded=!1,I.current&&!0===S?N.current=(null!==(e=I.current.frames.length)&&void 0!==e?e:0)-1:N.current=0}),[S,oe]),o.useLayoutEffect((()=>{re()}),[G,w,re]),o.useEffect((()=>{f&&(Y.current=!1)}),[f]),o.useLayoutEffect((()=>{if(V.current!==a&&a&&(N.current=0,V.current=a,oe.hasEnded=!1,j<=0&&(N.current=t||e||0),I.current)){const{w:e,h:t}=Jn(I.current.frames,a).sourceSize,n=ae(e,t);q(n)}}),[a,j,oe,t,e]);const ie=(e,t,n,r)=>{var o=void 0===z?oe.current:z;const a=N.current;let i=0,s=0;ae(e,t);const c=C?Math.round((n.w-1)/e):(n.w-1)/e,l=C?Math.round((n.h-1)/t):(n.h-1)/t;if(!r[a])return;const{frame:{x:u,y:d},sourceSize:{w:f,h:m}}=r[a],h=1/c,p=1/l;if(L.current&&L.current.map&&(i=$>0?h*(u/f):h*(u/f)-L.current.map.repeat.x,s=Math.abs(1-p)-p*(d/m),L.current.map.offset.x=i,L.current.map.offset.y=s),void 0!==o&&null!==o){let e=Math.floor(o*r.length);e=Math.max(0,Math.min(e,r.length-1)),isNaN(e)&&(e=0),N.current=e}else S?N.current-=1:N.current+=1};return(0,s.F)(((n,r)=>{var o,i;null!=(o=I.current)&&o.frames&&null!=(i=L.current)&&i.map&&(Y.current||oe.hasEnded||!f&&!v||((()=>{if(null===(n=I.current)||!("meta"in n)||!("frames"in n))return;var n;const{meta:{size:r},frames:o}=I.current,{w:i,h:s}=Jn(o,a).sourceSize,c=Array.isArray(o)?o:a?o[a]:[],l=t||c.length-1;var d=void 0===z?oe.current:z;if(j<=0)return N.current=t||e||0,void ie(i,s,r,c);const f=window.performance.now(),m=f-O.current;if(!(m<=j)){var g=S?N.current<0:N.current>l,v=S?N.current===l:0===N.current,x=S?N.current<0:N.current>=l;if(g){if(N.current=u&&null!==e&&void 0!==e?e:0,S&&(N.current=l),u?null==y||y({currentFrameName:null!==a&&void 0!==a?a:"",currentFrame:N.current}):(null==p||p({currentFrameName:null!==a&&void 0!==a?a:"",currentFrame:N.current}),oe.hasEnded=!T,T&&(Y.current=!0)),!u)return}else v&&(null==h||h({currentFrameName:null!==a&&void 0!==a?a:"",currentFrame:N.current}));void 0!==d&&x?!1===Z.current&&(null==p||p({currentFrameName:null!==a&&void 0!==a?a:"",currentFrame:N.current}),Z.current=!0):Z.current=!1,m<=j||(O.current=f-m%j,ie(i,s,r,c))}})(),null==g||g({currentFrameName:V.current,currentFrame:N.current})))})),o.createElement("group",(0,r.A)({},F,{ref:B,scale:function(e=new i.Vector3(1,1,1),t=1){return"number"===typeof t?e.multiplyScalar(t):Array.isArray(t)?e.multiply(new i.Vector3(...t)):t instanceof i.Vector3?e.multiply(t):void 0}(X,F.scale)}),o.createElement(Vi.Provider,{value:oe},M&&o.createElement(J,null,o.createElement("mesh",(0,r.A)({ref:U,scale:1,geometry:Gi},R),o.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:i.DoubleSide,ref:L,map:G,transparent:!0,alphaTest:null!==b&&void 0!==b?b:0}))),!M&&o.createElement(Li,(0,r.A)({geometry:Gi,limit:null!==A&&void 0!==A?A:1},R),o.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:i.DoubleSide,ref:L,map:G,transparent:!0,alphaTest:null!==b&&void 0!==b?b:0}),(null!==_&&void 0!==_?_:[0]).map(((e,t)=>o.createElement(Ii,(0,r.A)({key:t,ref:1===(null==_?void 0:_.length)?U:null,position:e,scale:1},R))))),E))}));var Hi=n("LS7f");const Xi=o.forwardRef((({children:e,curve:t},n)=>{const[r]=o.useState((()=>new i.Scene)),[a,c]=o.useState(),l=o.useRef(null);return o.useLayoutEffect((()=>{l.current=new Hi.nl(r.children[0]),c(l.current.object3D)}),[e]),o.useEffect((()=>{var e;t&&(null==(e=l.current)||e.updateCurve(0,t))}),[t]),o.useImperativeHandle(n,(()=>l.current)),o.createElement(o.Fragment,null,(0,s.h)(e,r),a&&o.createElement("primitive",{object:a}))}));class qi extends i.MeshPhysicalMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`\n      uniform float time;\n      uniform float radius;\n      uniform float distort;\n      #define GLSLIFY 1\nvec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        float updateTime = time / 50.0;\n        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));\n        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));\n        ")}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}const $i=o.forwardRef((({speed:e=1,...t},n)=>{const[a]=o.useState((()=>new qi));return(0,s.F)((t=>a&&(a.time=t.clock.elapsedTime*e))),o.createElement("primitive",(0,r.A)({object:a,ref:n,attach:"material"},t))}));class Yi extends i.MeshStandardMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`\n      uniform float time;\n      uniform float factor;\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n        float c = cos( theta );\n        float s = sin( theta );\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n        vec3 transformed = vec3( position ) * m;\n        vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const Ki=o.forwardRef((({speed:e=1,...t},n)=>{const[a]=o.useState((()=>new Yi));return(0,s.F)((t=>a&&(a.time=t.clock.elapsedTime*e))),o.createElement("primitive",(0,r.A)({object:a,ref:n,attach:"material"},t))}));class Zi extends i.ShaderMaterial{constructor(e=new i.Vector2){super({uniforms:{inputBuffer:new i.Uniform(null),depthBuffer:new i.Uniform(null),resolution:new i.Uniform(new i.Vector2),texelSize:new i.Uniform(new i.Vector2),halfTexelSize:new i.Uniform(new i.Vector2),kernel:new i.Uniform(0),scale:new i.Uniform(1),cameraNear:new i.Uniform(0),cameraFar:new i.Uniform(1),minDepthThreshold:new i.Uniform(0),maxDepthThreshold:new i.Uniform(1),depthScale:new i.Uniform(0),depthToBlurRatioBias:new i.Uniform(.25)},fragmentShader:`#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n          #include <tonemapping_fragment>\n          #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n        }`,vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:i.NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class Qi{constructor({gl:e,resolution:t,width:n=500,height:r=500,minDepthThreshold:o=0,maxDepthThreshold:a=1,depthScale:s=0,depthToBlurRatioBias:c=.25}){this.renderToScreen=!1,this.renderTargetA=new i.WebGLRenderTarget(t,t,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:i.HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Zi,this.convolutionMaterial.setTexelSize(1/n,1/r),this.convolutionMaterial.setResolution(new i.Vector2(n,r)),this.scene=new i.Scene,this.camera=new i.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=o,this.convolutionMaterial.uniforms.maxDepthThreshold.value=a,this.convolutionMaterial.uniforms.depthScale.value=s,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=c,this.convolutionMaterial.defines.USE_DEPTH=s>0;const l=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),u=new Float32Array([0,0,2,0,0,2]),d=new i.BufferGeometry;d.setAttribute("position",new i.BufferAttribute(l,3)),d.setAttribute("uv",new i.BufferAttribute(u,2)),this.screen=new i.Mesh(d,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const r=this.scene,o=this.camera,a=this.renderTargetA,i=this.renderTargetB;let s=this.convolutionMaterial,c=s.uniforms;c.depthBuffer.value=t.depthTexture;const l=s.kernel;let u,d,f,m=t;for(d=0,f=l.length-1;d<f;++d)u=0===(1&d)?a:i,c.kernel.value=l[d],c.inputBuffer.value=m.texture,e.setRenderTarget(u),e.render(r,o),m=u;c.kernel.value=l[d],c.inputBuffer.value=m.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,o)}}class Ji extends i.MeshStandardMaterial{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;\n      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader=`\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;\n        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n\n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n\n      vec4 merge = base;\n\n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n\n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}}const es=o.forwardRef((({mixBlur:e=0,mixStrength:t=1,resolution:n=256,blur:a=[0,0],minDepthThreshold:c=.9,maxDepthThreshold:l=1,depthScale:u=0,depthToBlurRatioBias:d=.25,mirror:f=0,distortion:m=1,mixContrast:h=1,distortionMap:p,reflectorOffset:y=0,...g},v)=>{(0,s.e)({MeshReflectorMaterialImpl:Ji});const x=(0,s.D)((({gl:e})=>e)),w=(0,s.D)((({camera:e})=>e)),b=(0,s.D)((({scene:e})=>e)),E=(a=Array.isArray(a)?a:[a,a])[0]+a[1]>0,M=o.useRef(null);o.useImperativeHandle(v,(()=>M.current),[]);const[z]=o.useState((()=>new i.Plane)),[S]=o.useState((()=>new i.Vector3)),[T]=o.useState((()=>new i.Vector3)),[A]=o.useState((()=>new i.Vector3)),[_]=o.useState((()=>new i.Matrix4)),[D]=o.useState((()=>new i.Vector3(0,0,-1))),[P]=o.useState((()=>new i.Vector4)),[C]=o.useState((()=>new i.Vector3)),[R]=o.useState((()=>new i.Vector3)),[F]=o.useState((()=>new i.Vector4)),[k]=o.useState((()=>new i.Matrix4)),[B]=o.useState((()=>new i.PerspectiveCamera)),I=o.useCallback((()=>{var e;const t=M.current.parent||(null==(e=M.current)?void 0:e.__r3f.parent);if(!t)return;if(T.setFromMatrixPosition(t.matrixWorld),A.setFromMatrixPosition(w.matrixWorld),_.extractRotation(t.matrixWorld),S.set(0,0,1),S.applyMatrix4(_),T.addScaledVector(S,y),C.subVectors(T,A),C.dot(S)>0)return;C.reflect(S).negate(),C.add(T),_.extractRotation(w.matrixWorld),D.set(0,0,-1),D.applyMatrix4(_),D.add(A),R.subVectors(T,D),R.reflect(S).negate(),R.add(T),B.position.copy(C),B.up.set(0,1,0),B.up.applyMatrix4(_),B.up.reflect(S),B.lookAt(R),B.far=w.far,B.updateMatrixWorld(),B.projectionMatrix.copy(w.projectionMatrix),k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(B.projectionMatrix),k.multiply(B.matrixWorldInverse),k.multiply(t.matrixWorld),z.setFromNormalAndCoplanarPoint(S,T),z.applyMatrix4(B.matrixWorldInverse),P.set(z.normal.x,z.normal.y,z.normal.z,z.constant);const n=B.projectionMatrix;F.x=(Math.sign(P.x)+n.elements[8])/n.elements[0],F.y=(Math.sign(P.y)+n.elements[9])/n.elements[5],F.z=-1,F.w=(1+n.elements[10])/n.elements[14],P.multiplyScalar(2/P.dot(F)),n.elements[2]=P.x,n.elements[6]=P.y,n.elements[10]=P.z+1,n.elements[14]=P.w}),[w,y]),[L,U,O,N]=o.useMemo((()=>{const r={minFilter:i.LinearFilter,magFilter:i.LinearFilter,type:i.HalfFloatType},o=new i.WebGLRenderTarget(n,n,r);o.depthBuffer=!0,o.depthTexture=new i.DepthTexture(n,n),o.depthTexture.format=i.DepthFormat,o.depthTexture.type=i.UnsignedShortType;const s=new i.WebGLRenderTarget(n,n,r);return[o,s,new Qi({gl:x,resolution:n,width:a[0],height:a[1],minDepthThreshold:c,maxDepthThreshold:l,depthScale:u,depthToBlurRatioBias:d}),{mirror:f,textureMatrix:k,mixBlur:e,tDiffuse:o.texture,tDepth:o.depthTexture,tDiffuseBlur:s.texture,hasBlur:E,mixStrength:t,minDepthThreshold:c,maxDepthThreshold:l,depthScale:u,depthToBlurRatioBias:d,distortion:m,distortionMap:p,mixContrast:h,"defines-USE_BLUR":E?"":void 0,"defines-USE_DEPTH":u>0?"":void 0,"defines-USE_DISTORTION":p?"":void 0}]}),[x,a,k,n,f,E,e,t,c,l,u,d,m,p,h]);return(0,s.F)((()=>{var e;const t=M.current.parent||(null==(e=M.current)?void 0:e.__r3f.parent);if(!t)return;t.visible=!1;const n=x.xr.enabled,r=x.shadowMap.autoUpdate;I(),x.xr.enabled=!1,x.shadowMap.autoUpdate=!1,x.setRenderTarget(L),x.state.buffers.depth.setMask(!0),x.autoClear||x.clear(),x.render(b,B),E&&O.render(x,L,U),x.xr.enabled=n,x.shadowMap.autoUpdate=r,t.visible=!0,x.setRenderTarget(null)})),o.createElement("meshReflectorMaterialImpl",(0,r.A)({attach:"material",key:"key"+N["defines-USE_BLUR"]+N["defines-USE_DEPTH"]+N["defines-USE_DISTORTION"],ref:M},N,g))}));function ts(e){switch(e){case 1:return i.RedIntegerFormat;case 2:return i.RGIntegerFormat;case 3:case 4:return i.RGBAIntegerFormat}}class ns extends i.DataTexture{constructor(){super(),this.minFilter=i.NearestFilter,this.magFilter=i.NearestFilter,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(e){const t=this.overrideItemSize,n=e.itemSize,r=e.count;if(null!==t){if(n*r%t!==0)throw new Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");e.itemSize=t,e.count=r*n/t}const o=e.itemSize,a=e.count,s=e.normalized,c=e.array.constructor,l=c.BYTES_PER_ELEMENT;let u,d,f,m,h=this._forcedType,p=o;if(null===h)switch(c){case Float32Array:h=i.FloatType;break;case Uint8Array:case Uint16Array:case Uint32Array:h=i.UnsignedIntType;break;case Int8Array:case Int16Array:case Int32Array:h=i.IntType}let y=function(e){switch(e){case 1:return"R";case 2:return"RG";case 3:case 4:return"RGBA"}throw new Error}(o);switch(h){case i.FloatType:f=1,d=function(e){switch(e){case 1:return i.RedFormat;case 2:return i.RGFormat;case 3:case 4:return i.RGBAFormat}}(o),s&&1===l?(m=c,y+="8",c===Uint8Array?u=i.UnsignedByteType:(u=i.ByteType,y+="_SNORM")):(m=Float32Array,y+="32F",u=i.FloatType);break;case i.IntType:y+=8*l+"I",f=s?Math.pow(2,8*c.BYTES_PER_ELEMENT-1):1,d=ts(o),1===l?(m=Int8Array,u=i.ByteType):2===l?(m=Int16Array,u=i.ShortType):(m=Int32Array,u=i.IntType);break;case i.UnsignedIntType:y+=8*l+"UI",f=s?Math.pow(2,8*c.BYTES_PER_ELEMENT-1):1,d=ts(o),1===l?(m=Uint8Array,u=i.UnsignedByteType):2===l?(m=Uint16Array,u=i.UnsignedShortType):(m=Uint32Array,u=i.UnsignedIntType)}3!==p||d!==i.RGBAFormat&&d!==i.RGBAIntegerFormat||(p=4);const g=Math.ceil(Math.sqrt(a))||1,v=new m(p*g*g),x=e.normalized;e.normalized=!1;for(let i=0;i<a;i++){const t=p*i;v[t]=e.getX(i)/f,o>=2&&(v[t+1]=e.getY(i)/f),o>=3&&(v[t+2]=e.getZ(i)/f,4===p&&(v[t+3]=1)),o>=4&&(v[t+3]=e.getW(i)/f)}e.normalized=x,this.internalFormat=y,this.format=d,this.type=u,this.image.width=g,this.image.height=g,this.image.data=v,this.needsUpdate=!0,this.dispose(),e.itemSize=n,e.count=r}}class rs extends ns{constructor(){super(),this._forcedType=i.UnsignedIntType}}class os extends ns{constructor(){super(),this._forcedType=i.FloatType}}class as{constructor(){this.index=new rs,this.position=new os,this.bvhBounds=new i.DataTexture,this.bvhContents=new i.DataTexture,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(e){const{geometry:t}=e;if(function(e,t,n){const r=e._roots;if(1!==r.length)throw new Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");const o=r[0],a=new Uint16Array(o),s=new Uint32Array(o),c=new Float32Array(o),l=o.byteLength/vr,u=2*Math.ceil(Math.sqrt(l/2)),d=new Float32Array(4*u*u),f=Math.ceil(Math.sqrt(l)),m=new Uint32Array(2*f*f);for(let i=0;i<l;i++){const e=i*vr/4,t=2*e,n=e;for(let r=0;r<3;r++)d[8*i+0+r]=c[n+0+r],d[8*i+4+r]=c[n+3+r];if(Vr(t,a)){const n=Gr(t,a),r=jr(e,s),o=4294901760|n;m[2*i+0]=o,m[2*i+1]=r}else{const t=4*Hr(e,s)/vr,n=Xr(e,s);m[2*i+0]=n,m[2*i+1]=t}}t.image.data=d,t.image.width=u,t.image.height=u,t.format=i.RGBAFormat,t.type=i.FloatType,t.internalFormat="RGBA32F",t.minFilter=i.NearestFilter,t.magFilter=i.NearestFilter,t.generateMipmaps=!1,t.needsUpdate=!0,t.dispose(),n.image.data=m,n.image.width=f,n.image.height=f,n.format=i.RGIntegerFormat,n.type=i.UnsignedIntType,n.internalFormat="RG32UI",n.minFilter=i.NearestFilter,n.magFilter=i.NearestFilter,n.generateMipmaps=!1,n.needsUpdate=!0,n.dispose()}(e,this.bvhBounds,this.bvhContents),this.position.updateFrom(t.attributes.position),e.indirect){const n=e._indirectBuffer;if(null===this._cachedIndexAttr||this._cachedIndexAttr.count!==n.length)if(t.index)this._cachedIndexAttr=t.index.clone();else{const e=Sr(Mr(t));this._cachedIndexAttr=new i.BufferAttribute(e,1,!1)}!function(e,t,n){const r=n.array,o=e.index?e.index.array:null;for(let a=0,i=t.length;a<i;a++){const e=3*a,n=3*t[a];for(let t=0;t<3;t++)r[e+t]=o?o[n+t]:n+t}}(t,n,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(t.index)}dispose(){const{index:e,position:t,bvhBounds:n,bvhContents:r}=this;e&&e.dispose(),t&&t.dispose(),n&&n.dispose(),r&&r.dispose()}}const is=Ue({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new as,color:new i.Color("white"),opacity:1,resolution:new i.Vector2,viewMatrixInverse:new i.Matrix4,projectionMatrixInverse:new i.Matrix4},"\n  uniform mat4 viewMatrixInverse;\n\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_vertex>\n\n  void main() {\n    #include <color_vertex>\n\n    vec4 transformedNormal = vec4(normal, 0.0);\n    vec4 transformedPosition = vec4(position, 1.0);\n    #ifdef USE_INSTANCING\n      transformedNormal = instanceMatrix * transformedNormal;\n      transformedPosition = instanceMatrix * transformedPosition;\n    #endif\n\n    #ifdef USE_INSTANCING\n      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);\n    #else\n      vModelMatrixInverse = inverse(modelMatrix);\n    #endif\n\n    vWorldPosition = (modelMatrix * transformedPosition).xyz;\n    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;\n  }",`\n  #define ENVMAP_TYPE_CUBE_UV\n  precision highp isampler2D;\n  precision highp usampler2D;\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    uniform samplerCube envMap;\n  #else\n    uniform sampler2D envMap;\n  #endif\n\n  uniform float bounces;\n  \nstruct BVH {\n\n\tusampler2D index;\n\tsampler2D position;\n\n\tsampler2D bvhBounds;\n\tusampler2D bvhContents;\n\n};\n\n  \n\t\n\n// A stack of uint32 indices can can store the indices for\n// a perfectly balanced tree with a depth up to 31. Lower stack\n// depth gets higher performance.\n//\n// However not all trees are balanced. Best value to set this to\n// is the trees max depth.\n#ifndef BVH_STACK_DEPTH\n#define BVH_STACK_DEPTH 60\n#endif\n\n#ifndef INFINITY\n#define INFINITY 1e20\n#endif\n\n// Utilities\nuvec4 uTexelFetch1D( usampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nivec4 iTexelFetch1D( isampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 texelFetch1D( sampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {\n\n\treturn\n\t\tbarycoord.x * texelFetch1D( tex, faceIndices.x ) +\n\t\tbarycoord.y * texelFetch1D( tex, faceIndices.y ) +\n\t\tbarycoord.z * texelFetch1D( tex, faceIndices.z );\n\n}\n\nvoid ndcToCameraRay(\n\tvec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,\n\tout vec3 rayOrigin, out vec3 rayDirection\n) {\n\n\t// get camera look direction and near plane for camera clipping\n\tvec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );\n\tvec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );\n\tfloat near = abs( nearVector.z / nearVector.w );\n\n\t// get the camera direction and position from camera matrices\n\tvec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );\n\tdirection /= direction.w;\n\tdirection = cameraWorld * direction - origin;\n\n\t// slide the origin along the ray until it sits at the near clip plane position\n\torigin.xyz += direction.xyz * near / dot( direction, lookDirection );\n\n\trayOrigin = origin.xyz;\n\trayDirection = direction.xyz;\n\n}\n\n\t\n\n#ifndef TRI_INTERSECT_EPSILON\n#define TRI_INTERSECT_EPSILON 1e-5\n#endif\n\n// Raycasting\nbool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {\n\n\t// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/\n\t// https://tavianator.com/2011/ray_box.html\n\tvec3 invDir = 1.0 / rayDirection;\n\n\t// find intersection distances for each plane\n\tvec3 tMinPlane = invDir * ( boundsMin - rayOrigin );\n\tvec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );\n\n\t// get the min and max distances from each intersection\n\tvec3 tMinHit = min( tMaxPlane, tMinPlane );\n\tvec3 tMaxHit = max( tMaxPlane, tMinPlane );\n\n\t// get the furthest hit distance\n\tvec2 t = max( tMinHit.xx, tMinHit.yz );\n\tfloat t0 = max( t.x, t.y );\n\n\t// get the minimum hit distance\n\tt = min( tMaxHit.xx, tMaxHit.yz );\n\tfloat t1 = min( t.x, t.y );\n\n\t// set distance to 0.0 if the ray starts inside the box\n\tdist = max( t0, 0.0 );\n\n\treturn t1 >= dist;\n\n}\n\nbool intersectsTriangle(\n\tvec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,\n\tout vec3 barycoord, out vec3 norm, out float dist, out float side\n) {\n\n\t// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d\n\tvec3 edge1 = b - a;\n\tvec3 edge2 = c - a;\n\tnorm = cross( edge1, edge2 );\n\n\tfloat det = - dot( rayDirection, norm );\n\tfloat invdet = 1.0 / det;\n\n\tvec3 AO = rayOrigin - a;\n\tvec3 DAO = cross( AO, rayDirection );\n\n\tvec4 uvt;\n\tuvt.x = dot( edge2, DAO ) * invdet;\n\tuvt.y = - dot( edge1, DAO ) * invdet;\n\tuvt.z = dot( AO, norm ) * invdet;\n\tuvt.w = 1.0 - uvt.x - uvt.y;\n\n\t// set the hit information\n\tbarycoord = uvt.wxy; // arranged in A, B, C order\n\tdist = uvt.z;\n\tside = sign( det );\n\tnorm = side * normalize( norm );\n\n\t// add an epsilon to avoid misses between triangles\n\tuvt += vec4( TRI_INTERSECT_EPSILON );\n\n\treturn all( greaterThanEqual( uvt, vec4( 0.0 ) ) );\n\n}\n\nbool intersectTriangles(\n\t// geometry info and triangle range\n\tsampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,\n\n\t// ray\n\tvec3 rayOrigin, vec3 rayDirection,\n\n\t// outputs\n\tinout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n\tinout float side, inout float dist\n) {\n\n\tbool found = false;\n\tvec3 localBarycoord, localNormal;\n\tfloat localDist, localSide;\n\tfor ( uint i = offset, l = offset + count; i < l; i ++ ) {\n\n\t\tuvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;\n\t\tvec3 a = texelFetch1D( positionAttr, indices.x ).rgb;\n\t\tvec3 b = texelFetch1D( positionAttr, indices.y ).rgb;\n\t\tvec3 c = texelFetch1D( positionAttr, indices.z ).rgb;\n\n\t\tif (\n\t\t\tintersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )\n\t\t\t&& localDist < minDistance\n\t\t) {\n\n\t\t\tfound = true;\n\t\t\tminDistance = localDist;\n\n\t\t\tfaceIndices = uvec4( indices.xyz, i );\n\t\t\tfaceNormal = localNormal;\n\n\t\t\tside = localSide;\n\t\t\tbarycoord = localBarycoord;\n\t\t\tdist = localDist;\n\n\t\t}\n\n\t}\n\n\treturn found;\n\n}\n\nbool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {\n\n\tuint cni2 = currNodeIndex * 2u;\n\tvec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;\n\tvec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;\n\treturn intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );\n\n}\n\n// use a macro to hide the fact that we need to expand the struct into separate fields\n#define\tbvhIntersectFirstHit(\t\tbvh,\t\trayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\t)\t_bvhIntersectFirstHit(\t\tbvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,\t\trayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\t)\n\nbool _bvhIntersectFirstHit(\n\t// bvh info\n\tsampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,\n\n\t// ray\n\tvec3 rayOrigin, vec3 rayDirection,\n\n\t// output variables split into separate variables due to output precision\n\tinout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n\tinout float side, inout float dist\n) {\n\n\t// stack needs to be twice as long as the deepest tree we expect because\n\t// we push both the left and right child onto the stack every traversal\n\tint ptr = 0;\n\tuint stack[ BVH_STACK_DEPTH ];\n\tstack[ 0 ] = 0u;\n\n\tfloat triangleDistance = INFINITY;\n\tbool found = false;\n\twhile ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {\n\n\t\tuint currNodeIndex = stack[ ptr ];\n\t\tptr --;\n\n\t\t// check if we intersect the current bounds\n\t\tfloat boundsHitDistance;\n\t\tif (\n\t\t\t! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )\n\t\t\t|| boundsHitDistance > triangleDistance\n\t\t) {\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tuvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;\n\t\tbool isLeaf = bool( boundsInfo.x & 0xffff0000u );\n\n\t\tif ( isLeaf ) {\n\n\t\t\tuint count = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint offset = boundsInfo.y;\n\n\t\t\tfound = intersectTriangles(\n\t\t\t\tbvh_position, bvh_index, offset, count,\n\t\t\t\trayOrigin, rayDirection, triangleDistance,\n\t\t\t\tfaceIndices, faceNormal, barycoord, side, dist\n\t\t\t) || found;\n\n\t\t} else {\n\n\t\t\tuint leftIndex = currNodeIndex + 1u;\n\t\t\tuint splitAxis = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint rightIndex = boundsInfo.y;\n\n\t\t\tbool leftToRight = rayDirection[ splitAxis ] >= 0.0;\n\t\t\tuint c1 = leftToRight ? leftIndex : rightIndex;\n\t\t\tuint c2 = leftToRight ? rightIndex : leftIndex;\n\n\t\t\t// set c2 in the stack so we traverse it later. We need to keep track of a pointer in\n\t\t\t// the stack while we traverse. The second pointer added is the one that will be\n\t\t\t// traversed first\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c2;\n\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c1;\n\n\t\t}\n\n\t}\n\n\treturn found;\n\n}\n\n\n  uniform BVH bvh;\n  uniform float ior;\n  uniform bool correctMips;\n  uniform vec2 resolution;\n  uniform float fresnel;\n  uniform mat4 modelMatrix;\n  uniform mat4 projectionMatrixInverse;\n  uniform mat4 viewMatrixInverse;\n  uniform float aberrationStrength;\n  uniform vec3 color;\n  uniform float opacity;\n\n  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {\n    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );\n  }\n\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {\n    vec3 rayOrigin = ro;\n    vec3 rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = vWorldPosition + rayDirection * 0.001;\n    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;\n    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);\n    for(float i = 0.0; i < bounces; i++) {\n      uvec4 faceIndices = uvec4( 0u );\n      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );\n      vec3 barycoord = vec3( 0.0 );\n      float side = 1.0;\n      float dist = 0.0;\n      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );\n      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);\n      vec3 tempDir = refract(rayDirection, faceNormal, ior);\n      if (length(tempDir) != 0.0) {\n        rayDirection = tempDir;\n        break;\n      }\n      rayDirection = reflect(rayDirection, faceNormal);\n      rayOrigin = hitPos + rayDirection * 0.01;\n    }\n    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);\n    return rayDirection;\n  }\n\n  #include <common>\n  #include <cube_uv_reflection_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));\n    }\n  #else\n    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      vec2 uvv = equirectUv( rayDirection );\n      vec2 smoothUv = equirectUv( directionCamPerfect );\n      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));\n    }\n  #endif\n\n  void main() {\n    vec2 uv = gl_FragCoord.xy / resolution;\n    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;\n    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;\n    directionCamPerfect = normalize(directionCamPerfect);\n    vec3 normal = vNormal;\n    vec3 rayOrigin = cameraPosition;\n    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);\n\n    vec4 diffuseColor = vec4(color, opacity);\n    #include <color_fragment>\n\n    #ifdef CHROMATIC_ABERRATIONS\n      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      #ifdef FAST_CHROMA\n        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));\n        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));\n      #else\n        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);\n        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);\n      #endif\n      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;\n      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;\n      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;\n      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);\n    #else\n      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;\n    #endif\n\n    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);\n    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;\n    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);\n\n    #include <tonemapping_fragment>\n    #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n  }`),ss=e=>e&&e.isCubeTexture;function cs({aberrationStrength:e=0,fastChroma:t=!0,envMap:n,...a}){(0,s.e)({MeshRefractionMaterial:is});const i=(0,o.useRef)(),{size:c}=(0,s.D)(),l=(0,o.useMemo)((()=>{var r,o;const a={},i=ss(n),s=(null!==(r=i?null==(o=n.image[0])?void 0:o.width:n.image.width)&&void 0!==r?r:1024)/4,c=Math.floor(Math.log2(s)),l=Math.pow(2,c),u=3*Math.max(l,112),d=4*l;return i&&(a.ENVMAP_TYPE_CUBEM=""),a.CUBEUV_TEXEL_WIDTH=""+1/u,a.CUBEUV_TEXEL_HEIGHT=""+1/d,a.CUBEUV_MAX_MIP=`${c}.0`,e>0&&(a.CHROMATIC_ABERRATIONS=""),t&&(a.FAST_CHROMA=""),a}),[e,t]);return(0,o.useLayoutEffect)((()=>{var e;const t=null==(e=i.current)||null==(e=e.__r3f)||null==(e=e.parent)?void 0:e.geometry;t&&(i.current.bvh=new as,i.current.bvh.updateFrom(new Oa(t.clone().toNonIndexed(),{strategy:yr})))}),[]),(0,s.F)((({camera:e})=>{i.current.viewMatrixInverse=e.matrixWorld,i.current.projectionMatrixInverse=e.projectionMatrixInverse})),o.createElement("meshRefractionMaterial",(0,r.A)({key:JSON.stringify(l),defines:l,ref:i,resolution:[c.width,c.height],aberrationStrength:e,envMap:n},a))}const ls=Ue({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class us extends i.MeshPhysicalMaterial{constructor(e=6,t=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new i.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=n=>{n.uniforms={...n.uniforms,...this.uniforms},this.anisotropy>0&&(n.defines.USE_ANISOTROPY=""),t?n.defines.USE_SAMPLER="":n.defines.USE_TRANSMISSION="",n.fragmentShader="\n      uniform float chromaticAberration;         \n      uniform float anisotropicBlur;      \n      uniform float time;\n      uniform float distortion;\n      uniform float distortionScale;\n      uniform float temporalDistortion;\n      uniform sampler2D buffer;\n\n      vec3 random3(vec3 c) {\n        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n        vec3 r;\n        r.z = fract(512.0*j);\n        j *= .125;\n        r.x = fract(512.0*j);\n        j *= .125;\n        r.y = fract(512.0*j);\n        return r-0.5;\n      }\n\n      uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n      }\n\n      // Compound versions of the hashing algorithm I whipped together.\n      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }\n      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }\n      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }\n\n      // Construct a float with half-open range [0:1] using low 23 bits.\n      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n      float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n      }\n\n      // Pseudo-random value in half-open range [0:1].\n      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float rand(float seed) {\n        float result = randomBase(vec3(gl_FragCoord.xy, seed));\n        return result;\n      }\n\n      const float F3 =  0.3333333;\n      const float G3 =  0.1666667;\n\n      float snoise(vec3 p) {\n        vec3 s = floor(p + dot(p, vec3(F3)));\n        vec3 x = p - s + dot(s, vec3(G3));\n        vec3 e = step(vec3(0.0), x - x.yzx);\n        vec3 i1 = e*(1.0 - e.zxy);\n        vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n        vec3 x1 = x - i1 + G3;\n        vec3 x2 = x - i2 + 2.0*G3;\n        vec3 x3 = x - 1.0 + 3.0*G3;\n        vec4 w, d;\n        w.x = dot(x, x);\n        w.y = dot(x1, x1);\n        w.z = dot(x2, x2);\n        w.w = dot(x3, x3);\n        w = max(0.6 - w, 0.0);\n        d.x = dot(random3(s), x);\n        d.y = dot(random3(s + i1), x1);\n        d.z = dot(random3(s + i2), x2);\n        d.w = dot(random3(s + 1.0), x3);\n        w *= w;\n        w *= w;\n        d *= w;\n        return dot(d, vec4(52.0));\n      }\n\n      float snoiseFractal(vec3 m) {\n        return 0.5333333* snoise(m)\n              +0.2666667* snoise(2.0*m)\n              +0.1333333* snoise(4.0*m)\n              +0.0666667* snoise(8.0*m);\n      }\n"+n.fragmentShader,n.fragmentShader=n.fragmentShader.replace("#include <transmission_pars_fragment>","\n        #ifdef USE_TRANSMISSION\n          // Transmission code is based on glTF-Sampler-Viewer\n          // https://github.com/KhronosGroup/glTF-Sample-Viewer\n          uniform float _transmission;\n          uniform float thickness;\n          uniform float attenuationDistance;\n          uniform vec3 attenuationColor;\n          #ifdef USE_TRANSMISSIONMAP\n            uniform sampler2D transmissionMap;\n          #endif\n          #ifdef USE_THICKNESSMAP\n            uniform sampler2D thicknessMap;\n          #endif\n          uniform vec2 transmissionSamplerSize;\n          uniform sampler2D transmissionSamplerMap;\n          uniform mat4 modelMatrix;\n          uniform mat4 projectionMatrix;\n          varying vec3 vWorldPosition;\n          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n            // Direction of refracted light.\n            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n            // Compute rotation-independant scaling of the model matrix.\n            vec3 modelScale;\n            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n            // The thickness is specified in local space.\n            return normalize( refractionVector ) * thickness * modelScale;\n          }\n          float applyIorToRoughness( const in float roughness, const in float ior ) {\n            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n            // an IOR of 1.5 results in the default amount of microfacet refraction.\n            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n          }\n          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            \n            #ifdef USE_SAMPLER\n              #ifdef texture2DLodEXT\n                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #else\n                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #endif\n            #else\n              return texture2D(buffer, fragCoord.xy);\n            #endif\n          }\n          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n            if ( isinf( attenuationDistance ) ) {\n              // Attenuation distance is +\u221e, i.e. the transmitted color is not attenuated at all.\n              return radiance;\n            } else {\n              // Compute light attenuation using Beer's law.\n              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n              return transmittance * radiance;\n            }\n          }\n          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n            const in vec3 attenuationColor, const in float attenuationDistance ) {\n            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n            vec3 refractedRayExit = position + transmissionRay;\n            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n            vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n            refractionCoords += 1.0;\n            refractionCoords /= 2.0;\n            // Sample framebuffer to get pixel the refracted ray hits.\n            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n            // Get the specular component.\n            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n          }\n        #endif\n"),n.fragmentShader=n.fragmentShader.replace("#include <transmission_fragment>",`  \n        // Improve the refraction to use the world pos\n        material.transmission = _transmission;\n        material.transmissionAlpha = 1.0;\n        material.thickness = thickness;\n        material.attenuationDistance = attenuationDistance;\n        material.attenuationColor = attenuationColor;\n        #ifdef USE_TRANSMISSIONMAP\n          material.transmission *= texture2D( transmissionMap, vUv ).r;\n        #endif\n        #ifdef USE_THICKNESSMAP\n          material.thickness *= texture2D( thicknessMap, vUv ).g;\n        #endif\n        \n        vec3 pos = vWorldPosition;\n        float runningSeed = 0.0;\n        vec3 v = normalize( cameraPosition - pos );\n        vec3 n = inverseTransformDirection( normal, viewMatrix );\n        vec3 transmission = vec3(0.0);\n        float transmissionR, transmissionB, transmissionG;\n        float randomCoords = rand(runningSeed++);\n        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);\n        vec3 distortionNormal = vec3(0.0);\n        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;\n        if (distortion > 0.0) {\n          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));\n        }\n        for (float i = 0.0; i < ${e}.0; i ++) {\n          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);\n          transmissionR = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).r;\n          transmissionG = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${e})) , material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).g;\n          transmissionB = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${e})), material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).b;\n          transmission.r += transmissionR;\n          transmission.g += transmissionG;\n          transmission.b += transmissionB;\n        }\n        transmission /= ${e}.0;\n        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n`)},Object.keys(this.uniforms).forEach((e=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})))}}const ds=o.forwardRef((({buffer:e,transmissionSampler:t=!1,backside:n=!1,side:a=i.FrontSide,transmission:c=1,thickness:l=0,backsideThickness:u=0,backsideEnvMapIntensity:d=1,samples:f=10,resolution:m,backsideResolution:h,background:p,anisotropy:y,anisotropicBlur:g,...v},x)=>{(0,s.e)({MeshTransmissionMaterial:us});const w=o.useRef(null),[b]=o.useState((()=>new ls)),E=Ft(h||m),M=Ft(m);let z,S,T,A;return(0,s.F)((e=>{w.current.time=e.clock.elapsedTime,w.current.buffer!==M.texture||t||(A=w.current.__r3f.parent,A&&(T=e.gl.toneMapping,z=e.scene.background,S=w.current.envMapIntensity,e.gl.toneMapping=i.NoToneMapping,p&&(e.scene.background=p),A.material=b,n&&(e.gl.setRenderTarget(E),e.gl.render(e.scene,e.camera),A.material=w.current,A.material.buffer=E.texture,A.material.thickness=u,A.material.side=i.BackSide,A.material.envMapIntensity=d),e.gl.setRenderTarget(M),e.gl.render(e.scene,e.camera),A.material=w.current,A.material.thickness=l,A.material.side=a,A.material.buffer=M.texture,A.material.envMapIntensity=S,e.scene.background=z,e.gl.setRenderTarget(null),e.gl.toneMapping=T))})),o.useImperativeHandle(x,(()=>w.current),[]),o.createElement("meshTransmissionMaterial",(0,r.A)({args:[f,t],ref:w},v,{buffer:e||M.texture,_transmission:c,anisotropicBlur:null!==g&&void 0!==g?g:y,transmission:t?c:0,thickness:l,side:a}))})),fs=o.forwardRef(((e,t)=>((0,s.e)({DiscardMaterialImpl:ls}),o.createElement("discardMaterialImpl",(0,r.A)({ref:t},e)))));function ms(e){const t=o.useRef(null);return o.useLayoutEffect((()=>{var e;const n=null==(e=t.current)?void 0:e.parent,r=null==n?void 0:n.geometry;if(r){const e=n.material;n.material=t.current.__r3f.objects;const o=[...r.groups];return r.clearGroups(),n.material.forEach(((e,t)=>{t<n.material.length-1&&(e.depthWrite=!1),r.addGroup(0,1/0,t)})),()=>{n.material=e,r.groups=o}}})),o.createElement("group",(0,r.A)({ref:t},e))}const hs=je>=154?"opaque_fragment":"output_fragment";class ps extends i.PointsMaterial{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:n}=t.capabilities;e.fragmentShader=e.fragmentShader.replace(`#include <${hs}>`,`\n        ${n?`#include <${hs}>`:`#extension GL_OES_standard_derivatives : enable\n#include <${hs}>`}\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n      `)}}}const ys=o.forwardRef(((e,t)=>{const[n]=o.useState((()=>new ps(null)));return o.createElement("primitive",(0,r.A)({},e,{object:n,ref:t,attach:"material"}))})),gs=({focus:e=0,size:t=25,samples:n=10}={})=>`\n#define PENUMBRA_FILTER_SIZE float(${t})\n#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))\nvec3 randRGB(vec2 uv) {\n  return vec3(\n    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),\n    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),\n    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)\n  );\n}\n\nvec3 lowPassRandRGB(vec2 uv) {\n  // 3x3 convolution (average)\n  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9\n  vec3 result = vec3(0);\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));\n  result *= 0.111111111; // 1.0 / 9.0\n  return result;\n}\nvec3 highPassRandRGB(vec2 uv) {\n  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal\n  // hp(x) = x - lp(x)\n  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;\n}\n\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\nfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n  return (zReceiver - zBlocker) / zBlocker;\n}\nfloat findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float blockerDepthSum = float(${e});\n  float blockers = 0.0;\n\n  int j = 0;\n  vec2 offset = vec2(0.);\n  float depth = 0.;\n\n  #pragma unroll_loop_start\n  for(int i = 0; i < ${n}; i ++) {\n    offset = (vogelDiskSample(j, ${n}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;\n    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));\n    if (depth < compare) {\n      blockerDepthSum += depth;\n      blockers++;\n    }\n    j++;\n  }\n  #pragma unroll_loop_end\n\n  if (blockers > 0.0) {\n    return blockerDepthSum / blockers;\n  }\n  return -1.0;\n}\n\n        \nfloat vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float shadow = 0.0f;\n  int j = 0;\n  vec2 vogelSample = vec2(0.0);\n  vec2 offset = vec2(0.0);\n  #pragma unroll_loop_start\n  for (int i = 0; i < ${n}; i++) {\n    vogelSample = vogelDiskSample(j, ${n}, angle) * texelSize;\n    offset = vogelSample * (1.0 + filterRadius * float(${t}));\n    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    j++;\n  }\n  #pragma unroll_loop_end\n  return shadow * 1.0 / ${n}.0;\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\n  vec2 uv = coords.xy;\n  float zReceiver = coords.z; // Assumed to be eye-space z in this code\n  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;\n  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);\n  if (avgBlockerDepth == -1.0) {\n    return 1.0;\n  }\n  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);\n}`;function vs(e,t,n){t.traverse((t=>{t.material&&(e.properties.remove(t.material),null==t.material.dispose||t.material.dispose())})),e.info.programs.length=0,e.compile(t,n)}function xs({focus:e=0,samples:t=10,size:n=25}){const r=(0,s.D)((e=>e.gl)),a=(0,s.D)((e=>e.scene)),c=(0,s.D)((e=>e.camera));return o.useEffect((()=>{const o=i.ShaderChunk.shadowmap_pars_fragment;return i.ShaderChunk.shadowmap_pars_fragment=i.ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+gs({size:n,samples:t,focus:e})).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),vs(r,a,c),()=>{i.ShaderChunk.shadowmap_pars_fragment=o,vs(r,a,c)}}),[e,n,t]),null}function ws(e,t){const n=e+"Geometry";return o.forwardRef((({args:e,children:a,...i},s)=>{const c=o.useRef(null);return o.useImperativeHandle(s,(()=>c.current)),o.useLayoutEffect((()=>{null==t||t(c.current)})),o.createElement("mesh",(0,r.A)({ref:c},i),o.createElement(n,{attach:"geometry",args:e}),a)}))}const bs=ws("box"),Es=ws("circle"),Ms=ws("cone"),zs=ws("cylinder"),Ss=ws("sphere"),Ts=ws("plane"),As=ws("tube"),_s=ws("torus"),Ds=ws("torusKnot"),Ps=ws("tetrahedron"),Cs=ws("ring"),Rs=ws("polyhedron"),Fs=ws("icosahedron"),ks=ws("octahedron"),Bs=ws("dodecahedron"),Is=ws("extrude"),Ls=ws("lathe"),Us=ws("capsule"),Os=ws("shape",(({geometry:e})=>{const t=e.attributes.position,n=(new i.Box3).setFromBufferAttribute(t),r=new i.Vector3;n.getSize(r);const o=[];let a=0,s=0,c=0,l=0;for(let i=0;i<t.count;i++)a=t.getX(i),s=t.getY(i),c=(a-n.min.x)/r.x,l=(s-n.min.y)/r.y,o.push(c,l);e.setAttribute("uv",new i.Float32BufferAttribute(o,2))})),Ns=1e-5,Vs=o.forwardRef((function({args:[e=1,t=1,n=1]=[],radius:a=.05,steps:s=1,smoothness:c=4,bevelSegments:l=4,creaseAngle:u=.4,children:d,...f},m){const h=o.useMemo((()=>function(e,t,n){const r=new i.Shape,o=n-Ns;return r.absarc(Ns,Ns,Ns,-Math.PI/2,-Math.PI,!0),r.absarc(Ns,t-2*o,Ns,Math.PI,Math.PI/2,!0),r.absarc(e-2*o,t-2*o,Ns,Math.PI/2,0,!0),r.absarc(e-2*o,Ns,Ns,0,-Math.PI/2,!0),r}(e,t,a)),[e,t,a]),p=o.useMemo((()=>({depth:n-2*a,bevelEnabled:!0,bevelSegments:2*l,steps:s,bevelSize:a-Ns,bevelThickness:a,curveSegments:c})),[n,a,c]),y=o.useRef(null);return o.useLayoutEffect((()=>{y.current&&(y.current.center(),(0,Me.pb)(y.current,u))}),[h,p]),o.createElement("mesh",(0,r.A)({ref:m},f),o.createElement("extrudeGeometry",{ref:y,args:[h,p]}),d)}));function js(){const e=new i.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.boundingSphere=new i.Sphere,e.boundingSphere.set(new i.Vector3,1/0),e.setAttribute("position",new i.BufferAttribute(t,2)),e}const Gs=o.forwardRef((function({children:e,...t},n){const a=o.useMemo(js,[]);return o.createElement("mesh",(0,r.A)({ref:n,geometry:a,frustumCulled:!1},t),e)})),Ws=o.forwardRef((({children:e,width:t,height:n,depth:a,box3:s,precise:c=!0,...l},u)=>{const d=o.useRef(null),f=o.useRef(null),m=o.useRef(null);return o.useLayoutEffect((()=>{f.current.matrixWorld.identity();let e=s||(new i.Box3).setFromObject(m.current,c);const r=e.max.x-e.min.x,o=e.max.y-e.min.y,l=e.max.z-e.min.z;let u=Math.max(r,o,l);t&&(u=r),n&&(u=o),a&&(u=l),f.current.scale.setScalar(1/u)}),[t,n,a,s,c]),o.useImperativeHandle(u,(()=>d.current),[]),o.createElement("group",(0,r.A)({ref:d},l),o.createElement("group",{ref:f},o.createElement("group",{ref:m},e)))}));var Hs=function(e){return e[e.NONE=0]="NONE",e[e.START=1]="START",e[e.ACTIVE=2]="ACTIVE",e}(Hs||{});const Xs=e=>e&&e.isOrthographicCamera,qs=e=>e&&e.isBox3,$s=e=>1-Math.exp(-5*e)+.007*e,Ys=o.createContext(null);function Ks({children:e,maxDuration:t=1,margin:n=1.2,observe:r,fit:a,clip:c,interpolateFunc:l=$s,onFit:u}){const d=o.useRef(null),{camera:f,size:m,invalidate:h}=(0,s.D)(),p=(0,s.D)((e=>e.controls)),y=o.useRef(u);y.current=u;const g=o.useRef({camPos:new i.Vector3,camRot:new i.Quaternion,camZoom:1}),v=o.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),x=o.useRef(Hs.NONE),w=o.useRef(0),[b]=o.useState((()=>new i.Box3)),E=o.useMemo((()=>{function e(){const e=b.getSize(new i.Vector3),t=b.getCenter(new i.Vector3),r=Math.max(e.x,e.y,e.z),o=Xs(f)?4*r:r/(2*Math.atan(Math.PI*f.fov/360)),a=Xs(f)?4*r:o/f.aspect,s=n*Math.max(o,a);return{box:b,size:e,center:t,distance:s}}return{getSize:e,refresh(e){if(qs(e))b.copy(e);else{const t=e||d.current;if(!t)return this;t.updateWorldMatrix(!0,!0),b.setFromObject(t)}if(b.isEmpty()){const e=f.position.length()||10;b.setFromCenterAndSize(new i.Vector3,new i.Vector3(e,e,e))}return g.current.camPos.copy(f.position),g.current.camRot.copy(f.quaternion),Xs(f)&&(g.current.camZoom=f.zoom),v.current.camPos=void 0,v.current.camRot=void 0,v.current.camZoom=void 0,v.current.camUp=void 0,v.current.target=void 0,this},reset(){const{center:t,distance:n}=e(),r=f.position.clone().sub(t).normalize();v.current.camPos=t.clone().addScaledVector(r,n),v.current.target=t.clone();const o=(new i.Matrix4).lookAt(v.current.camPos,v.current.target,f.up);return v.current.camRot=(new i.Quaternion).setFromRotationMatrix(o),x.current=Hs.START,w.current=0,this},moveTo(e){return v.current.camPos=Array.isArray(e)?new i.Vector3(...e):e.clone(),x.current=Hs.START,w.current=0,this},lookAt({target:e,up:t}){v.current.target=Array.isArray(e)?new i.Vector3(...e):e.clone(),v.current.camUp=t?Array.isArray(t)?new i.Vector3(...t):t.clone():f.up.clone();const n=(new i.Matrix4).lookAt(v.current.camPos||f.position,v.current.target,v.current.camUp);return v.current.camRot=(new i.Quaternion).setFromRotationMatrix(n),x.current=Hs.START,w.current=0,this},to({position:e,target:t}){return this.moveTo(e).lookAt({target:t})},fit(){if(!Xs(f))return this.reset();let e=0,t=0;const r=[new i.Vector3(b.min.x,b.min.y,b.min.z),new i.Vector3(b.min.x,b.max.y,b.min.z),new i.Vector3(b.min.x,b.min.y,b.max.z),new i.Vector3(b.min.x,b.max.y,b.max.z),new i.Vector3(b.max.x,b.max.y,b.max.z),new i.Vector3(b.max.x,b.max.y,b.min.z),new i.Vector3(b.max.x,b.min.y,b.max.z),new i.Vector3(b.max.x,b.min.y,b.min.z)],o=v.current.camPos||f.position,a=v.current.target||(null==p?void 0:p.target),s=v.current.camUp||f.up,c=a?(new i.Matrix4).lookAt(o,a,s).setPosition(o).invert():f.matrixWorldInverse;for(const n of r)n.applyMatrix4(c),e=Math.max(e,Math.abs(n.y)),t=Math.max(t,Math.abs(n.x));e*=2,t*=2;const l=(f.top-f.bottom)/e,u=(f.right-f.left)/t;return v.current.camZoom=Math.min(l,u)/n,x.current=Hs.START,w.current=0,y.current&&y.current(this.getSize()),this},clip(){const{distance:t}=e();return f.near=t/100,f.far=100*t,f.updateProjectionMatrix(),p&&(p.maxDistance=10*t,p.update()),h(),this}}}),[b,f,p,n,h]);o.useLayoutEffect((()=>{if(p){const e=()=>{if(p&&v.current.target&&x.current!==Hs.NONE){const e=(new i.Vector3).setFromMatrixColumn(f.matrix,2),t=g.current.camPos.distanceTo(p.target),n=(v.current.camPos||g.current.camPos).distanceTo(v.current.target),r=(1-w.current)*t+w.current*n;p.target.copy(f.position).addScaledVector(e,-r),p.update()}x.current=Hs.NONE};return p.addEventListener("start",e),()=>p.removeEventListener("start",e)}}),[p]);const M=o.useRef(0);return o.useLayoutEffect((()=>{(r||0===M.current++)&&(E.refresh(),a&&E.reset().fit(),c&&E.clip())}),[m,c,a,r,f,p]),(0,s.F)(((e,n)=>{if(x.current===Hs.START)x.current=Hs.ACTIVE,h();else if(x.current===Hs.ACTIVE){if(w.current+=n/t,w.current>=1)v.current.camPos&&f.position.copy(v.current.camPos),v.current.camRot&&f.quaternion.copy(v.current.camRot),v.current.camUp&&f.up.copy(v.current.camUp),v.current.camZoom&&Xs(f)&&(f.zoom=v.current.camZoom),f.updateMatrixWorld(),f.updateProjectionMatrix(),p&&v.current.target&&(p.target.copy(v.current.target),p.update()),x.current=Hs.NONE;else{const e=l(w.current);v.current.camPos&&f.position.lerpVectors(g.current.camPos,v.current.camPos,e),v.current.camRot&&f.quaternion.slerpQuaternions(g.current.camRot,v.current.camRot,e),v.current.camUp&&f.up.set(0,1,0).applyQuaternion(f.quaternion),v.current.camZoom&&Xs(f)&&(f.zoom=(1-e)*g.current.camZoom+e*v.current.camZoom),f.updateMatrixWorld(),f.updateProjectionMatrix()}h()}})),o.createElement("group",{ref:d},o.createElement(Ys.Provider,{value:E},e))}function Zs(){return o.useContext(Ys)}var Qs=n("qMPC");const Js=o.forwardRef((({intensity:e=1,decay:t,decayRate:n=.65,maxYaw:r=.1,maxPitch:a=.1,maxRoll:i=.1,yawFrequency:c=.1,pitchFrequency:l=.1,rollFrequency:u=.1},d)=>{const f=(0,s.D)((e=>e.camera)),m=(0,s.D)((e=>e.controls)),h=o.useRef(e),p=o.useRef(f.rotation.clone()),[y]=o.useState((()=>new Qs.h)),[g]=o.useState((()=>new Qs.h)),[v]=o.useState((()=>new Qs.h)),x=()=>{(h.current<0||h.current>1)&&(h.current=h.current<0?0:1)};return o.useImperativeHandle(d,(()=>({getIntensity:()=>h.current,setIntensity:e=>{h.current=e,x()}})),[]),o.useEffect((()=>{if(m){const e=()=>{p.current=f.rotation.clone()};return m.addEventListener("change",e),e(),()=>{m.removeEventListener("change",e)}}}),[f,m]),(0,s.F)(((e,o)=>{const s=Math.pow(h.current,2),d=r*s*y.noise(e.clock.elapsedTime*c,1),m=a*s*g.noise(e.clock.elapsedTime*l,1),w=i*s*v.noise(e.clock.elapsedTime*u,1);f.rotation.set(p.current.x+m,p.current.y+d,p.current.z+w),t&&h.current>0&&(h.current-=n*o,x())})),null})),ec=o.forwardRef((({children:e,enabled:t=!0,speed:n=1,rotationIntensity:r=1,floatIntensity:a=1,floatingRange:c=[-.1,.1],autoInvalidate:l=!1,...u},d)=>{const f=o.useRef(null);o.useImperativeHandle(d,(()=>f.current),[]);const m=o.useRef(1e4*Math.random());return(0,s.F)((e=>{var o,s;if(!t||0===n)return;l&&e.invalidate();const u=m.current+e.clock.elapsedTime;f.current.rotation.x=Math.cos(u/4*n)/8*r,f.current.rotation.y=Math.sin(u/4*n)/8*r,f.current.rotation.z=Math.sin(u/4*n)/20*r;let d=Math.sin(u/4*n)/10;d=i.MathUtils.mapLinear(d,-.1,.1,null!==(o=null==c?void 0:c[0])&&void 0!==o?o:-.1,null!==(s=null==c?void 0:c[1])&&void 0!==s?s:.1),f.current.position.y=d*a,f.current.updateMatrix()})),o.createElement("group",u,o.createElement("group",{ref:f,matrixAutoUpdate:!1},e))}));var tc=n("bn0K"),nc=n("jA9d"),rc=n("uiA+");const oc=(e,t,n)=>{let r;switch(e){case i.UnsignedByteType:r=new Uint8ClampedArray(t*n*4);break;case i.HalfFloatType:r=new Uint16Array(t*n*4);break;case i.UnsignedIntType:r=new Uint32Array(t*n*4);break;case i.ByteType:r=new Int8Array(t*n*4);break;case i.ShortType:r=new Int16Array(t*n*4);break;case i.IntType:r=new Int32Array(t*n*4);break;case i.FloatType:r=new Float32Array(t*n*4);break;default:throw new Error("Unsupported data type")}return r};let ac;class ic{constructor(e){var t,n,r,o,a,s,c,l,u,d,f,m,h,p,y,g;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const v={format:i.RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:void 0!==(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)?null===(n=e.renderTargetOptions)||void 0===n?void 0:n.anisotropy:1,generateMipmaps:void 0!==(null===(r=e.renderTargetOptions)||void 0===r?void 0:r.generateMipmaps)&&(null===(o=e.renderTargetOptions)||void 0===o?void 0:o.generateMipmaps),magFilter:void 0!==(null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter)?null===(s=e.renderTargetOptions)||void 0===s?void 0:s.magFilter:i.LinearFilter,minFilter:void 0!==(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.minFilter)?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter:i.LinearFilter,samples:void 0!==(null===(u=e.renderTargetOptions)||void 0===u?void 0:u.samples)?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.samples:void 0,wrapS:void 0!==(null===(f=e.renderTargetOptions)||void 0===f?void 0:f.wrapS)?null===(m=e.renderTargetOptions)||void 0===m?void 0:m.wrapS:i.ClampToEdgeWrapping,wrapT:void 0!==(null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapT)?null===(p=e.renderTargetOptions)||void 0===p?void 0:p.wrapT:i.ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=ic.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new i.Scene,this._camera=new i.OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((e,t,n,r)=>{if(void 0!==ac)return ac;const o=new i.WebGLRenderTarget(1,1,r);t.setRenderTarget(o);const a=new i.Mesh(new i.PlaneGeometry,new i.MeshBasicMaterial({color:16777215}));t.render(a,n),t.setRenderTarget(null);const s=oc(e,o.width,o.height);return t.readRenderTargetPixels(o,0,0,o.width,o.height,s),o.dispose(),a.geometry.dispose(),a.material.dispose(),ac=0!==s[0],ac})(this._type,this._renderer,this._camera,v)){let e;this._type===i.HalfFloatType&&(e=this._renderer.extensions.has("EXT_color_buffer_float")?i.FloatType:void 0),void 0!==e?this._type=e:this._supportsReadPixels=!1}this._quad=new i.Mesh(new i.PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new i.WebGLRenderTarget(this.width,this.height,v),this._renderTarget.texture.mapping=void 0!==(null===(y=e.renderTargetOptions)||void 0===y?void 0:y.mapping)?null===(g=e.renderTargetOptions)||void 0===g?void 0:g.mapping:i.UVMapping}static instantiateRenderer(){const e=new i.WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=oc(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new i.DataTexture(this.toArray(),this.width,this.height,i.RGBAFormat,this._type,(null===e||void 0===e?void 0:e.mapping)||i.UVMapping,(null===e||void 0===e?void 0:e.wrapS)||i.ClampToEdgeWrapping,(null===e||void 0===e?void 0:e.wrapT)||i.ClampToEdgeWrapping,(null===e||void 0===e?void 0:e.magFilter)||i.LinearFilter,(null===e||void 0===e?void 0:e.minFilter)||i.LinearFilter,(null===e||void 0===e?void 0:e.anisotropy)||1,i.LinearSRGBColorSpace);return t.generateMipmaps=void 0!==(null===e||void 0===e?void 0:e.generateMipmaps)&&(null===e||void 0===e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof i.ShaderMaterial&&Object.values(this.material.uniforms).forEach((e=>{e.value instanceof i.Texture&&e.value.dispose()})),Object.values(this.material).forEach((e=>{e instanceof i.Texture&&e.dispose()})),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class sc extends i.ShaderMaterial{constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:o,maxDisplayBoost:a,hdrCapacityMin:s,hdrCapacityMax:c,sdr:l,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:u},gamma:{value:new i.Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:(new i.Vector3).fromArray(t)},offsetSdr:{value:(new i.Vector3).fromArray(n)},gainMapMin:{value:(new i.Vector3).fromArray(r)},gainMapMax:{value:(new i.Vector3).fromArray(o)},weightFactor:{value:(Math.log2(a)-s)/(c-s)}},blending:i.NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=s,this._hdrCapacityMax=c,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class cc extends Error{}class lc extends Error{}const uc=(e,t,n)=>{const r=new RegExp(`${t}="([^"]*)"`,"i").exec(e);if(r)return r[1];const o=new RegExp(`<${t}[^>]*>([\\s\\S]*?)</${t}>`,"i").exec(e);if(o){const e=o[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return e&&3===e.length?e.map((e=>e.replace(/<\/?rdf:li>/g,""))):o[1].trim()}if(void 0!==n)return n;throw new Error(`Can't find ${t} in gainmap metadata`)};class dc{constructor(e){this.options={debug:!(!e||void 0===e.debug)&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise(((t,n)=>{this.options.debug;const r=new DataView(e.buffer);if(65496!==r.getUint16(0))return void n(new Error("Not a valid jpeg"));const o=r.byteLength;let a,i=2,s=0;for(;i<o;){if(++s>250)return void n(new Error(`Found no marker after ${s} loops \ud83d\ude35`));if(255!==r.getUint8(i))return void n(new Error(`Not a valid marker at offset 0x${i.toString(16)}, found: 0x${r.getUint8(i).toString(16)}`));if(a=r.getUint8(i+1),226===a){const e=i+4;if(1297106432===r.getUint32(e)){const o=e+4;let a;if(18761===r.getUint16(o))a=!1;else{if(19789!==r.getUint16(o))return void n(new Error("No valid endianness marker found in TIFF header"));a=!0}if(42!==r.getUint16(o+2,!a))return void n(new Error("Not valid TIFF data! (no 0x002A marker)"));const i=r.getUint32(o+4,!a);if(i<8)return void n(new Error("Not valid TIFF data! (First offset less than 8)"));const s=o+i,c=r.getUint16(s,!a),l=s+2;let u=0;for(let e=l;e<l+12*c;e+=12)45057===r.getUint16(e,!a)&&(u=r.getUint32(e+8,!a));const d=s+2+12*c+4,f=[];for(let e=d;e<d+16*u;e+=16){const t={MPType:r.getUint32(e,!a),size:r.getUint32(e+4,!a),dataOffset:r.getUint32(e+8,!a),dependantImages:r.getUint32(e+12,!a),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=o+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,f.push(t)}if(this.options.extractNonFII&&f.length){const e=new Blob([r]),n=[];for(const t of f){if(t.isFII&&!this.options.extractFII)continue;const r=e.slice(t.start,t.end+1,"image/jpeg");n.push(r)}t(n)}}}i+=2+r.getUint16(i+2)}}))}}const fc=e=>new Promise(((t,n)=>{const r=document.createElement("img");r.onload=()=>{t(r)},r.onerror=e=>{n(e)},r.src=URL.createObjectURL(e)}));class mc extends i.Loader{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new i.LoadingManager}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer;const e=new sc({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new i.Texture,sdr:new i.Texture});return new ic({width:16,height:16,type:i.HalfFloatType,colorSpace:i.LinearSRGBColorSpace,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,n,r){const o=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([n],{type:"image/jpeg"});let s,c,l=!1;if("undefined"===typeof createImageBitmap){const e=await Promise.all([o?fc(o):Promise.resolve(void 0),fc(a)]);c=e[0],s=e[1],l=!0}else{const e=await Promise.all([o?createImageBitmap(o,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);c=e[0],s=e[1]}const u=new i.Texture(c||new ImageData(2,2),i.UVMapping,i.ClampToEdgeWrapping,i.ClampToEdgeWrapping,i.LinearFilter,i.LinearMipMapLinearFilter,i.RGBAFormat,i.UnsignedByteType,1,i.LinearSRGBColorSpace);u.flipY=l,u.needsUpdate=!0;const d=new i.Texture(s,i.UVMapping,i.ClampToEdgeWrapping,i.ClampToEdgeWrapping,i.LinearFilter,i.LinearMipMapLinearFilter,i.RGBAFormat,i.UnsignedByteType,1,i.SRGBColorSpace);d.flipY=l,d.needsUpdate=!0,e.width=s.width,e.height=s.height,e.material.gainMap=u,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class hc extends mc{load([e,t,n],r,o,a){const s=this.prepareQuadRenderer();let c,l,u;const d=async()=>{if(c&&l&&u){try{await this.render(s,u,c,l)}catch(o){return this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),"function"===typeof a&&a(o),void s.disposeOnDemandRenderer()}"function"===typeof r&&r(s),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),s.disposeOnDemandRenderer()}};let f=!0,m=0,h=0,p=!0,y=0,g=0,v=!0,x=0,w=0;const b=()=>{"function"===typeof o&&o(new ProgressEvent("progress",{lengthComputable:f&&p&&v,loaded:h+g+w,total:m+y+x}))};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const E=new i.FileLoader(this._internalLoadingManager);E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(e,(async e=>{if("string"===typeof e)throw new Error("Invalid sdr buffer");c=e,await d()}),(e=>{f=e.lengthComputable,h=e.loaded,m=e.total,b()}),(t=>{this.manager.itemError(e),"function"===typeof a&&a(t)}));const M=new i.FileLoader(this._internalLoadingManager);M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(t,(async e=>{if("string"===typeof e)throw new Error("Invalid gainmap buffer");l=e,await d()}),(e=>{p=e.lengthComputable,g=e.loaded,y=e.total,b()}),(e=>{this.manager.itemError(t),"function"===typeof a&&a(e)}));const z=new i.FileLoader(this._internalLoadingManager);return z.setRequestHeader(this.requestHeader),z.setPath(this.path),z.setWithCredentials(this.withCredentials),z.load(n,(async e=>{if("string"!==typeof e)throw new Error("Invalid metadata string");u=JSON.parse(e),await d()}),(e=>{v=e.lengthComputable,w=e.loaded,x=e.total,b()}),(e=>{this.manager.itemError(n),"function"===typeof a&&a(e)})),s}}class pc extends mc{load(e,t,n,r){const o=this.prepareQuadRenderer(),a=new i.FileLoader(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,(async n=>{if("string"===typeof n)throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const a=new Uint8Array(n);let i,s,c;try{const e=await(async e=>{const t=(e=>{let t;t="undefined"!==typeof TextDecoder?(new TextDecoder).decode(e):e.toString();let n=t.indexOf("<x:xmpmeta");for(;-1!==n;){const e=t.indexOf("x:xmpmeta>",n),o=t.slice(n,e+10);try{const e=uc(o,"hdrgm:GainMapMin","0"),t=uc(o,"hdrgm:GainMapMax"),n=uc(o,"hdrgm:Gamma","1"),r=uc(o,"hdrgm:OffsetSDR","0.015625"),a=uc(o,"hdrgm:OffsetHDR","0.015625"),i=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(o),s=i?i[1]:"0",c=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(o);if(!c)throw new Error("Incomplete gainmap metadata");const l=c[1];return{gainMapMin:Array.isArray(e)?e.map((e=>parseFloat(e))):[parseFloat(e),parseFloat(e),parseFloat(e)],gainMapMax:Array.isArray(t)?t.map((e=>parseFloat(e))):[parseFloat(t),parseFloat(t),parseFloat(t)],gamma:Array.isArray(n)?n.map((e=>parseFloat(e))):[parseFloat(n),parseFloat(n),parseFloat(n)],offsetSdr:Array.isArray(r)?r.map((e=>parseFloat(e))):[parseFloat(r),parseFloat(r),parseFloat(r)],offsetHdr:Array.isArray(a)?a.map((e=>parseFloat(e))):[parseFloat(a),parseFloat(a),parseFloat(a)],hdrCapacityMin:parseFloat(s),hdrCapacityMax:parseFloat(l)}}catch(r){}n=t.indexOf("<x:xmpmeta",e)}})(e);if(!t)throw new lc("Gain map XMP metadata not found");const n=new dc({extractFII:!0,extractNonFII:!0}),r=await n.extract(e);if(2!==r.length)throw new cc("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:t}})(a);i=e.sdr,s=e.gainMap,c=e.metadata}catch(l){if(!(l instanceof lc||l instanceof cc))throw l;c={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},i=a}try{await this.render(o,c,i,s)}catch(u){return this.manager.itemError(e),"function"===typeof r&&r(u),void o.disposeOnDemandRenderer()}"function"===typeof t&&t(o),this.manager.itemEnd(e),o.disposeOnDemandRenderer()}),n,(t=>{this.manager.itemError(e),"function"===typeof r&&r(t)})),o}}const yc={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},gc="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",vc=e=>Array.isArray(e),xc=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function wc({files:e=xc,path:t="",preset:n,encoding:r,extensions:a}={}){let c=null,l=!1;n&&(Mc(n),e=yc[n],t=gc),l=vc(e);const{extension:u,isCubemap:d}=zc(e);if(c=Sc(u),!c)throw new Error("useEnvironment: Unrecognized file extension: "+e);const f=(0,s.D)((e=>e.gl));(0,o.useLayoutEffect)((()=>{"webp"!==u&&"jpg"!==u&&"jpeg"!==u||f.domElement.addEventListener("webglcontextlost",(function(){s.H.clear(c,l?[e]:e)}),{once:!0})}),[e,f.domElement]);const m=(0,s.H)(c,l?[e]:e,(e=>{"webp"!==u&&"jpg"!==u&&"jpeg"!==u||e.setRenderer(f),null==e.setPath||e.setPath(t),a&&a(e)}));let h=l?m[0]:m;var p;return"jpg"!==u&&"jpeg"!==u&&"webp"!==u||(h=null==(p=h.renderTarget)?void 0:p.texture),h.mapping=d?i.CubeReflectionMapping:i.EquirectangularReflectionMapping,"colorSpace"in h?h.colorSpace=(null!==r&&void 0!==r?r:d)?"srgb":"srgb-linear":h.encoding=(null!==r&&void 0!==r?r:d)?Mi:Ei,h}const bc={files:xc,path:"",preset:void 0,extensions:void 0};wc.preload=e=>{const t={...bc,...e};let{files:n,path:r=""}=t;const{preset:o,extensions:a}=t;o&&(Mc(o),n=yc[o],r=gc);const{extension:i}=zc(n);if("webp"===i||"jpg"===i||"jpeg"===i)throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=Sc(i);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+n);s.H.preload(c,vc(n)?[n]:n,(e=>{null==e.setPath||e.setPath(r),a&&a(e)}))};const Ec={files:xc,preset:void 0};function Mc(e){if(!(e in yc))throw new Error("Preset must be one of: "+Object.keys(yc).join(", "))}function zc(e){var t;const n=vc(e)&&6===e.length,r=vc(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),o=vc(e)?e[0]:e;return{extension:n?"cube":r?"webp":o.startsWith("data:application/exr")?"exr":o.startsWith("data:application/hdr")?"hdr":o.startsWith("data:image/jpeg")?"jpg":null==(t=o.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function Sc(e){return"cube"===e?i.CubeTextureLoader:"hdr"===e?nc.Y:"exr"===e?rc.H:"jpg"===e||"jpeg"===e?pc:"webp"===e?hc:null}wc.clear=e=>{const t={...Ec,...e};let{files:n}=t;const{preset:r}=t;r&&(Mc(r),n=yc[r]);const{extension:o}=zc(n),a=Sc(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+n);s.H.clear(a,vc(n)?[n]:n)};const Tc=e=>{return(t=e).current&&t.current.isScene?e.current:e;var t};function Ac(e,t,n,r,o={}){var a,i,c,l;o={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...o};const u=Tc(t||n),d=u.background,f=u.environment,m={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:null!==(a=null==(i=u.backgroundRotation)||null==i.clone?void 0:i.clone())&&void 0!==a?a:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:null!==(c=null==(l=u.environmentRotation)||null==l.clone?void 0:l.clone())&&void 0!==c?c:[0,0,0]};return"only"!==e&&(u.environment=r),e&&(u.background=r),(0,s.k)(u,o),()=>{"only"!==e&&(u.environment=f),e&&(u.background=d),(0,s.k)(u,m)}}function _c({scene:e,background:t=!1,map:n,...r}){const a=(0,s.D)((e=>e.scene));return o.useLayoutEffect((()=>{if(n)return Ac(t,e,a,n,r)})),null}function Dc({background:e=!1,scene:t,blur:n,backgroundBlurriness:r,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:c,environmentRotation:l,...u}){const d=wc(u),f=(0,s.D)((e=>e.scene));return o.useLayoutEffect((()=>Ac(e,t,f,d,{backgroundBlurriness:null!==n&&void 0!==n?n:r,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:c,environmentRotation:l}))),o.useEffect((()=>()=>{d.dispose()}),[d]),null}function Pc({children:e,near:t=.1,far:n=1e3,resolution:r=256,frames:a=1,map:c,background:l=!1,blur:u,backgroundBlurriness:d,backgroundIntensity:f,backgroundRotation:m,environmentIntensity:h,environmentRotation:p,scene:y,files:g,path:v,preset:x,extensions:w}){const b=(0,s.D)((e=>e.gl)),E=(0,s.D)((e=>e.scene)),M=o.useRef(null),[z]=o.useState((()=>new i.Scene)),S=o.useMemo((()=>{const e=new i.WebGLCubeRenderTarget(r);return e.texture.type=i.HalfFloatType,e}),[r]);o.useEffect((()=>()=>{S.dispose()}),[S]),o.useLayoutEffect((()=>{if(1===a){const e=b.autoClear;b.autoClear=!0,M.current.update(b,z),b.autoClear=e}return Ac(l,y,E,S.texture,{backgroundBlurriness:null!==u&&void 0!==u?u:d,backgroundIntensity:f,backgroundRotation:m,environmentIntensity:h,environmentRotation:p})}),[e,z,S.texture,y,E,l,a,b]);let T=1;return(0,s.F)((()=>{if(a===1/0||T<a){const e=b.autoClear;b.autoClear=!0,M.current.update(b,z),b.autoClear=e,T++}})),o.createElement(o.Fragment,null,(0,s.h)(o.createElement(o.Fragment,null,e,o.createElement("cubeCamera",{ref:M,args:[t,n,S]}),g||x?o.createElement(Dc,{background:!0,files:g,preset:x,path:v,extensions:w}):c?o.createElement(_c,{background:!0,map:c,extensions:w}):null),z))}function Cc(e){var t,n,a,i;const c=wc(e),l=e.map||c;o.useMemo((()=>(0,s.e)({GroundProjectedEnvImpl:tc.L})),[]),o.useEffect((()=>()=>{c.dispose()}),[c]);const u=o.useMemo((()=>[l]),[l]),d=null==(t=e.ground)?void 0:t.height,f=null==(n=e.ground)?void 0:n.radius,m=null!==(a=null==(i=e.ground)?void 0:i.scale)&&void 0!==a?a:1e3;return o.createElement(o.Fragment,null,o.createElement(_c,(0,r.A)({},e,{map:l})),o.createElement("groundProjectedEnvImpl",{args:u,scale:m,height:d,radius:f}))}function Rc(e){return e.ground?o.createElement(Cc,e):e.map?o.createElement(_c,e):e.children?o.createElement(Pc,e):o.createElement(Dc,e)}var Fc=n("FbkE"),kc=n("uzUo");const Bc=o.forwardRef((({scale:e=10,frames:t=1/0,opacity:n=1,width:a=1,height:c=1,blur:l=1,near:u=0,far:d=10,resolution:f=512,smooth:m=!0,color:h="#000000",depthWrite:p=!1,renderOrder:y,...g},v)=>{const x=o.useRef(null),w=(0,s.D)((e=>e.scene)),b=(0,s.D)((e=>e.gl)),E=o.useRef(null);a*=Array.isArray(e)?e[0]:e||1,c*=Array.isArray(e)?e[1]:e||1;const[M,z,S,T,A,_,D]=o.useMemo((()=>{const e=new i.WebGLRenderTarget(f,f),t=new i.WebGLRenderTarget(f,f);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;const n=new i.PlaneGeometry(a,c).rotateX(Math.PI/2),r=new i.Mesh(n),o=new i.MeshDepthMaterial;o.depthTest=o.depthWrite=!1,o.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new i.Color(h)}},e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const s=new i.ShaderMaterial(Fc.F),l=new i.ShaderMaterial(kc.r);return l.depthTest=s.depthTest=!1,[e,n,o,r,s,l,t]}),[f,a,c,e,h]),P=e=>{T.visible=!0,T.material=A,A.uniforms.tDiffuse.value=M.texture,A.uniforms.h.value=1*e/256,b.setRenderTarget(D),b.render(T,E.current),T.material=_,_.uniforms.tDiffuse.value=D.texture,_.uniforms.v.value=1*e/256,b.setRenderTarget(M),b.render(T,E.current),T.visible=!1};let C,R,F=0;return(0,s.F)((()=>{E.current&&(t===1/0||F<t)&&(F++,C=w.background,R=w.overrideMaterial,x.current.visible=!1,w.background=null,w.overrideMaterial=S,b.setRenderTarget(M),b.render(w,E.current),P(l),m&&P(.4*l),b.setRenderTarget(null),x.current.visible=!0,w.overrideMaterial=R,w.background=C)})),o.useImperativeHandle(v,(()=>x.current),[]),o.createElement("group",(0,r.A)({"rotation-x":Math.PI/2},g,{ref:x}),o.createElement("mesh",{renderOrder:y,geometry:z,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},o.createElement("meshBasicMaterial",{transparent:!0,map:M.texture,opacity:n,depthWrite:p})),o.createElement("orthographicCamera",{ref:E,args:[-a/2,a/2,c/2,-c/2,u,d]}))})),Ic=o.createContext(null),Lc=Ue({color:new i.Color,blend:2,alphaTest:.75,opacity:0,map:null},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vUv = uv;\n   }",`varying vec2 vUv;\n   uniform sampler2D map;\n   uniform vec3 color;\n   uniform float opacity;\n   uniform float alphaTest;\n   uniform float blend;\n   void main() {\n     vec4 sampledDiffuseColor = texture2D(map, vUv);\n     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);\n     #include <tonemapping_fragment>\n     #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),Uc=o.forwardRef((({children:e,temporal:t,frames:n=40,limit:r=1/0,blend:a=20,scale:i=10,opacity:c=1,alphaTest:l=.75,color:u="black",colorBlend:d=2,resolution:f=1024,toneMapped:m=!0,...h},p)=>{(0,s.e)({SoftShadowMaterial:Lc});const y=(0,s.D)((e=>e.gl)),g=(0,s.D)((e=>e.scene)),v=(0,s.D)((e=>e.camera)),x=(0,s.D)((e=>e.invalidate)),w=o.useRef(null),b=o.useRef(null),[E]=o.useState((()=>new Nc(y,g,f)));o.useLayoutEffect((()=>{E.configure(w.current)}),[]);const M=o.useMemo((()=>({lights:new Map,temporal:!!t,frames:Math.max(2,n),blend:Math.max(2,n===1/0?a:n),count:0,getMesh:()=>w.current,reset:()=>{E.clear();const e=w.current.material;e.opacity=0,e.alphaTest=0,M.count=0},update:(e=1)=>{const t=w.current.material;M.temporal?(t.opacity=Math.min(c,t.opacity+c/M.blend),t.alphaTest=Math.min(l,t.alphaTest+l/M.blend)):(t.opacity=c,t.alphaTest=l),b.current.visible=!0,E.prepare();for(let n=0;n<e;n++)M.lights.forEach((e=>e.update())),E.update(v,M.blend);b.current.visible=!1,E.finish()}})),[E,v,g,t,n,a,c,l]);return o.useLayoutEffect((()=>{M.reset(),M.temporal||M.frames===1/0||M.update(M.blend)})),o.useImperativeHandle(p,(()=>M),[M]),(0,s.F)((()=>{(M.temporal||M.frames===1/0)&&M.count<M.frames&&M.count<r&&(x(),M.update(),M.count++)})),o.createElement("group",h,o.createElement("group",{traverse:()=>null,ref:b},o.createElement(Ic.Provider,{value:M},e)),o.createElement("mesh",{receiveShadow:!0,ref:w,scale:i,rotation:[-Math.PI/2,0,0]},o.createElement("planeGeometry",null),o.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:m,color:u,blend:d,map:E.progressiveLightMap2.texture})))})),Oc=o.forwardRef((({castShadow:e=!0,bias:t=.001,mapSize:n=512,size:a=5,near:s=.5,far:c=500,frames:l=1,position:u=[0,0,0],radius:d=1,amount:f=8,intensity:m=(je>=155?Math.PI:1),ambient:h=.5,...p},y)=>{const g=o.useRef(null),v=new i.Vector3(...u).length(),x=o.useContext(Ic),w=o.useCallback((()=>{let e;if(g.current)for(let t=0;t<g.current.children.length;t++)if(e=g.current.children[t],Math.random()>h)e.position.set(u[0]+i.MathUtils.randFloatSpread(d),u[1]+i.MathUtils.randFloatSpread(d),u[2]+i.MathUtils.randFloatSpread(d));else{let t=Math.acos(2*Math.random()-1)-Math.PI/2,n=2*Math.PI*Math.random();e.position.set(Math.cos(t)*Math.cos(n)*v,Math.abs(Math.cos(t)*Math.sin(n)*v),Math.sin(t)*v)}}),[d,h,v,...u]),b=o.useMemo((()=>({update:w})),[w]);return o.useImperativeHandle(y,(()=>b),[b]),o.useLayoutEffect((()=>{var e;const t=g.current;return x&&(null==(e=x.lights)||e.set(t.uuid,b)),()=>{var e;null==x||null==(e=x.lights)||e.delete(t.uuid)}}),[x,b]),o.createElement("group",(0,r.A)({ref:g},p),Array.from({length:f},((r,i)=>o.createElement("directionalLight",{key:i,castShadow:e,"shadow-bias":t,"shadow-mapSize":[n,n],intensity:m/f},o.createElement("orthographicCamera",{attach:"shadow-camera",args:[-a,a,a,-a,s,c]})))))}));class Nc{constructor(e,t,n=1024){this.renderer=e,this.res=n,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new i.Color,this.clearAlpha=0;const r={type:i.HalfFloatType,magFilter:i.NearestFilter,minFilter:i.NearestFilter};this.progressiveLightMap1=new i.WebGLRenderTarget(this.res,this.res,r),this.progressiveLightMap2=new i.WebGLRenderTarget(this.res,this.res,r),this.discardMat=new ls,this.targetMat=new i.MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=e=>{e.vertexShader="varying vec2 vUv;\n"+e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv;\n"+e.fragmentShader.slice(0,t)+"uniform sampler2D previousShadowMap;\n\tuniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+"\nvec3 texelOld = texture2D(previousShadowMap, vUv).rgb;\n        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);\n      }",e.uniforms.previousShadowMap=this.previousShadowMap,e.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse((e=>{!function(e){return!!e.geometry}(e)?function(e){return e.isLight}(e)&&this.lights.push({object:e,intensity:e.intensity}):this.meshes.push({object:e,material:e.material})}))}prepare(){this.lights.forEach((e=>e.object.intensity=0)),this.meshes.forEach((e=>e.object.material=this.discardMat))}finish(){this.lights.forEach((e=>e.object.intensity=e.intensity)),this.meshes.forEach((e=>e.object.material=e.material))}configure(e){this.object=e}update(e,t=100){if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;const n=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,r=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,o=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(n),this.previousShadowMap.value=r.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=o}}const Vc={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function jc({radius:e,adjustCamera:t}){const n=Zs();return o.useEffect((()=>{t&&n.refresh().clip().fit()}),[e,t]),null}function Gc({children:e,center:t,adjustCamera:n=!0,intensity:a=.5,shadows:i="contact",environment:s="city",preset:c="rembrandt",...l}){var u,d,f,m,h,p,y,g;const v="string"===typeof c?Vc[c]:c,[{radius:x,height:w},b]=o.useState({radius:0,width:0,height:0,depth:0}),E=null!==(u=null==i?void 0:i.bias)&&void 0!==u?u:-1e-4,M=null!==(d=null==i?void 0:i.normalBias)&&void 0!==d?d:0,z=null!==(f=null==i?void 0:i.size)&&void 0!==f?f:1024,S=null!==(m=null==i?void 0:i.offset)&&void 0!==m?m:0,T="contact"===i||"contact"===(null==i?void 0:i.type),A="accumulative"===i||"accumulative"===(null==i?void 0:i.type),_={..."object"===typeof i?i:{}},D=s?"string"===typeof s?{preset:s}:s:null,P=o.useCallback((e=>{const{width:n,height:r,depth:o,boundingSphere:a}=e;b({radius:a.radius,width:n,height:r,depth:o}),null!=t&&t.onCentered&&t.onCentered(e)}),[]);return o.createElement(o.Fragment,null,o.createElement("ambientLight",{intensity:a/3}),o.createElement("spotLight",{penumbra:1,position:[v.main[0]*x,v.main[1]*x,v.main[2]*x],intensity:2*a,castShadow:!!i,"shadow-bias":E,"shadow-normalBias":M,"shadow-mapSize":z}),o.createElement("pointLight",{position:[v.fill[0]*x,v.fill[1]*x,v.fill[2]*x],intensity:a}),o.createElement(Ks,(0,r.A)({fit:!!n,clip:!!n,margin:Number(n),observe:!0},l),o.createElement(jc,{radius:x,adjustCamera:n}),o.createElement(vi,(0,r.A)({},t,{position:[0,S/2,0],onCentered:P}),e)),o.createElement("group",{position:[0,-w/2-S/2,0]},T&&o.createElement(Bc,(0,r.A)({scale:4*x,far:x,blur:2},_)),A&&o.createElement(Uc,(0,r.A)({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*x},_),o.createElement(Oc,{amount:null!==(h=_.amount)&&void 0!==h?h:8,radius:null!==(p=_.radius)&&void 0!==p?p:x,ambient:null!==(y=_.ambient)&&void 0!==y?y:.5,intensity:null!==(g=_.intensity)&&void 0!==g?g:1,position:[v.main[0]*x,v.main[1]*x,v.main[2]*x],size:4*x,bias:-E,mapSize:z}))),s&&o.createElement(Rc,D))}const Wc=e=>0===e?0:Math.pow(2,10*e-10);function Hc({children:e,floor:t=.25,segments:n=20,receiveShadow:r,...a}){const i=o.useRef(null);return o.useLayoutEffect((()=>{let e=0;const r=n/n/2,o=i.current.attributes.position;for(let a=0;a<n+1;a++)for(let i=0;i<n+1;i++)o.setXYZ(e++,a/n-r+(0===a?-t:0),i/n-r,Wc(a/n));o.needsUpdate=!0,i.current.computeVertexNormals()}),[n,t]),o.createElement("group",a,o.createElement("mesh",{receiveShadow:r,rotation:[-Math.PI/2,0,Math.PI/2]},o.createElement("planeGeometry",{ref:i,args:[1,1,n,n]}),e))}const Xc=o.forwardRef((({fog:e=!1,renderOrder:t,depthWrite:n=!1,colorStop:a=0,color:s="black",opacity:c=.5,...l},u)=>{const d=o.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const t=e.getContext("2d"),n=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return n.addColorStop(a,new i.Color(s).getStyle()),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height),e}),[s,a]);return o.createElement("mesh",(0,r.A)({renderOrder:t,ref:u,"rotation-x":-Math.PI/2},l),o.createElement("planeGeometry",null),o.createElement("meshBasicMaterial",{transparent:!0,opacity:c,fog:e,depthWrite:n,side:i.DoubleSide},o.createElement("canvasTexture",{attach:"map",args:[d]})))}));var qc=n("cZpV");function $c(e=i.FrontSide){const t={value:new i.Matrix4};return Object.assign(new i.MeshNormalMaterial({side:e}),{viewMatrix:t,onBeforeCompile:e=>{e.uniforms.viewMatrix=t,e.fragmentShader="vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n         }\n"+e.fragmentShader.replace("#include <normal_fragment_maps>","#include <normal_fragment_maps>\n           normal = inverseTransformDirection( normal, viewMatrix );\n")}})}const Yc=Ue({causticsTexture:null,causticsTextureB:null,color:new i.Color,lightProjMatrix:new i.Matrix4,lightViewMatrix:new i.Matrix4},"varying vec3 vWorldPosition;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vec4 worldPosition = modelMatrix * vec4(position, 1.);\n     vWorldPosition = worldPosition.xyz;\n   }",`varying vec3 vWorldPosition;\n  uniform vec3 color;\n  uniform sampler2D causticsTexture;\n  uniform sampler2D causticsTextureB;\n  uniform mat4 lightProjMatrix;\n  uniform mat4 lightViewMatrix;\n   void main() {\n    // Apply caustics\n    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);\n    lightSpacePos.xyz /= lightSpacePos.w;\n    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;\n    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;\n    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;\n    gl_FragColor = vec4((front + back) * color, 1.0);\n    #include <tonemapping_fragment>\n    #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),Kc=Ue({cameraMatrixWorld:new i.Matrix4,cameraProjectionMatrixInv:new i.Matrix4,normalTexture:null,depthTexture:null,lightDir:new i.Vector3(0,1,0),lightPlaneNormal:new i.Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new i.Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},"\n  varying vec2 vUv;\n  void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }","\n  uniform mat4 cameraMatrixWorld;\n  uniform mat4 cameraProjectionMatrixInv;\n  uniform vec3 lightDir;\n  uniform vec3 lightPlaneNormal;\n  uniform float lightPlaneConstant;\n  uniform float near;\n  uniform float far;\n  uniform float time;\n  uniform float worldRadius;\n  uniform float resolution;\n  uniform float size;\n  uniform float intensity;\n  uniform float ior;\n  precision highp isampler2D;\n  precision highp usampler2D;\n  uniform sampler2D normalTexture;\n  uniform sampler2D depthTexture;\n  uniform float bounces;\n  varying vec2 vUv;\n  vec3 WorldPosFromDepth(float depth, vec2 coord) {\n    float z = depth * 2.0 - 1.0;\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;\n    // Perspective division\n    viewSpacePosition /= viewSpacePosition.w;\n    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;\n    return worldSpacePosition.xyz;\n  }\n  float sdPlane( vec3 p, vec3 n, float h ) {\n    // n must be normalized\n    return dot(p,n) + h;\n  }\n  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n  }\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {\n    rayOrigin = ro;\n    rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = pos + rayDirection * 0.1;\n    return rayDirection;\n  }\n  void main() {\n    // Each sample consists of random offset in the x and y direction\n    float caustic = 0.0;\n    float causticTexelSize = (1.0 / resolution) * size * 2.0;\n    float texelsNeeded = worldRadius / causticTexelSize;\n    float sampleRadius = texelsNeeded / resolution;\n    float sum = 0.0;\n    if (texture2D(depthTexture, vUv).x == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 uv1 = vUv + offset1 * sampleRadius;\n    vec2 uv2 = vUv + offset2 * sampleRadius;\n    vec2 uv3 = vUv + offset3 * sampleRadius;\n    vec2 uv4 = vUv + offset4 * sampleRadius;\n    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;\n    float depth1 = texture2D(depthTexture, uv1, -10.0).x;\n    float depth2 = texture2D(depthTexture, uv2, -10.0).x;\n    float depth3 = texture2D(depthTexture, uv3, -10.0).x;\n    float depth4 = texture2D(depthTexture, uv4, -10.0).x;\n    // Sanity check the depths\n    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec3 pos1 = WorldPosFromDepth(depth1, uv1);\n    vec3 pos2 = WorldPosFromDepth(depth2, uv2);\n    vec3 pos3 = WorldPosFromDepth(depth3, uv3);\n    vec3 pos4 = WorldPosFromDepth(depth4, uv4);\n    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);\n    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);\n    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);\n    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);\n    vec3 endPos1, endPos2, endPos3, endPos4;\n    vec3 endDir1, endDir2, endDir3, endDir4;\n    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);\n    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);\n    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);\n    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);\n    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));\n    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));\n    vec3 finalPos1 = endPos1 + endDir1 * t1;\n    vec3 finalPos2 = endPos2 + endDir2 * t2;\n    vec3 finalPos3 = endPos3 + endDir3 * t3;\n    vec3 finalPos4 = endPos4 + endDir4 * t4;\n    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));\n    caustic += intensity * (lightPosArea / finalArea);\n    // Calculate the area of the triangle in light spaces\n    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);\n  }"),Zc={depth:!0,minFilter:i.LinearFilter,magFilter:i.LinearFilter,type:i.UnsignedByteType},Qc={minFilter:i.LinearMipmapLinearFilter,magFilter:i.LinearFilter,type:i.FloatType,generateMipmaps:!0},Jc=o.forwardRef((({debug:e,children:t,frames:n=1,ior:a=1.1,color:c="white",causticsOnly:l=!1,backside:u=!1,backsideIOR:d=1.1,worldRadius:f=.3125,intensity:m=.05,resolution:h=2024,lightSource:p=[5,5,5],...y},g)=>{(0,s.e)({CausticsProjectionMaterial:Yc});const v=o.useRef(null),x=o.useRef(null),w=o.useRef(null),b=o.useRef(null),E=(0,s.D)((e=>e.gl)),M=nr(e&&x,i.CameraHelper),z=Ft(h,h,Zc),S=Ft(h,h,Zc),T=Ft(h,h,Qc),A=Ft(h,h,Qc),[_]=o.useState((()=>$c())),[D]=o.useState((()=>$c(i.BackSide))),[P]=o.useState((()=>new Kc)),[C]=o.useState((()=>new qc.F(P)));o.useLayoutEffect((()=>{v.current.updateWorldMatrix(!1,!0)}));let R=0;const F=new i.Vector3,k=new i.Frustum,B=new i.Matrix4,I=new i.Plane,L=new i.Vector3,U=new i.Vector3,O=new i.Box3,N=new i.Vector3,V=[],j=[],G=[],W=[],H=new i.Vector3;for(let r=0;r<8;r++)V.push(new i.Vector3),j.push(new i.Vector3),G.push(new i.Vector3),W.push(new i.Vector3);return(0,s.F)((()=>{if(n===1/0||R++<n){var t,r;Array.isArray(p)?L.fromArray(p).normalize():L.copy(v.current.worldToLocal(p.current.getWorldPosition(F)).normalize()),U.copy(L).multiplyScalar(-1),null==(t=w.current.parent)||t.matrixWorld.identity(),O.setFromObject(w.current,!0),V[0].set(O.min.x,O.min.y,O.min.z),V[1].set(O.min.x,O.min.y,O.max.z),V[2].set(O.min.x,O.max.y,O.min.z),V[3].set(O.min.x,O.max.y,O.max.z),V[4].set(O.max.x,O.min.y,O.min.z),V[5].set(O.max.x,O.min.y,O.max.z),V[6].set(O.max.x,O.max.y,O.min.z),V[7].set(O.max.x,O.max.y,O.max.z);for(let e=0;e<8;e++)j[e].copy(V[e]);O.getCenter(N),V.map((e=>e.sub(N)));const n=I.set(U,0);V.map(((e,t)=>n.projectPoint(e,G[t])));const o=G.reduce(((e,t)=>e.add(t)),F.set(0,0,0)).divideScalar(G.length),i=G.map((e=>e.distanceTo(o))).reduce(((e,t)=>Math.max(e,t))),s=V.map((e=>e.dot(L))).reduce(((e,t)=>Math.max(e,t)));x.current.position.copy(H.copy(L).multiplyScalar(s).add(N)),x.current.lookAt(w.current.localToWorld(N));const c=B.lookAt(x.current.position,N,F.set(0,1,0));x.current.left=-i,x.current.right=i,x.current.top=i,x.current.bottom=-i;const y=F.set(0,i,0).applyMatrix4(c),g=(x.current.position.y+y.y)/L.y;x.current.near=.1,x.current.far=g,x.current.updateProjectionMatrix(),x.current.updateMatrixWorld();const R=j.map(((e,t)=>e.add(W[t].copy(L).multiplyScalar(-e.y/L.y)))),X=R.reduce(((e,t)=>e.add(t)),F.set(0,0,0)).divideScalar(R.length),q=2*R.map((e=>Math.hypot(e.x-X.x,e.z-X.z))).reduce(((e,t)=>Math.max(e,t)));b.current.scale.setScalar(q),b.current.position.copy(X),e&&(null==(r=M.current)||r.update()),D.viewMatrix.value=_.viewMatrix.value=x.current.matrixWorldInverse;const $=k.setFromProjectionMatrix(B.multiplyMatrices(x.current.projectionMatrix,x.current.matrixWorldInverse)).planes[4];P.cameraMatrixWorld=x.current.matrixWorld,P.cameraProjectionMatrixInv=x.current.projectionMatrixInverse,P.lightDir=U,P.lightPlaneNormal=$.normal,P.lightPlaneConstant=$.constant,P.near=x.current.near,P.far=x.current.far,P.resolution=h,P.size=i,P.intensity=m,P.worldRadius=f,w.current.visible=!0,E.setRenderTarget(z),E.clear(),w.current.overrideMaterial=_,E.render(w.current,x.current),E.setRenderTarget(S),E.clear(),u&&(w.current.overrideMaterial=D,E.render(w.current,x.current)),w.current.overrideMaterial=null,P.ior=a,b.current.material.lightProjMatrix=x.current.projectionMatrix,b.current.material.lightViewMatrix=x.current.matrixWorldInverse,P.normalTexture=z.texture,P.depthTexture=z.depthTexture,E.setRenderTarget(T),E.clear(),C.render(E),P.ior=d,P.normalTexture=S.texture,P.depthTexture=S.depthTexture,E.setRenderTarget(A),E.clear(),u&&C.render(E),E.setRenderTarget(null),l&&(w.current.visible=!1)}})),o.useImperativeHandle(g,(()=>v.current),[]),o.createElement("group",(0,r.A)({ref:v},y),o.createElement("scene",{ref:w},o.createElement("orthographicCamera",{ref:x,up:[0,1,0]}),t),o.createElement("mesh",{renderOrder:2,ref:b,"rotation-x":-Math.PI/2},o.createElement("planeGeometry",null),o.createElement("causticsProjectionMaterial",{transparent:!0,color:c,causticsTexture:T.texture,causticsTextureB:A.texture,blending:i.CustomBlending,blendSrc:i.OneFactor,blendDst:i.SrcAlphaFactor,depthWrite:!1}),e&&o.createElement($e,null,o.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))})),el=o.forwardRef((({mixBlur:e=0,mixStrength:t=.5,resolution:n=256,blur:a=[0,0],args:c=[1,1],minDepthThreshold:l=.9,maxDepthThreshold:u=1,depthScale:d=0,depthToBlurRatioBias:f=.25,mirror:m=0,children:h,debug:p=0,distortion:y=1,mixContrast:g=1,distortionMap:v,...x},w)=>{(0,s.e)({MeshReflectorMaterial:Ji}),o.useEffect((()=>{}),[]);const b=(0,s.D)((({gl:e})=>e)),E=(0,s.D)((({camera:e})=>e)),M=(0,s.D)((({scene:e})=>e)),z=(a=Array.isArray(a)?a:[a,a])[0]+a[1]>0,S=o.useRef(null);o.useImperativeHandle(w,(()=>S.current),[]);const[T]=o.useState((()=>new i.Plane)),[A]=o.useState((()=>new i.Vector3)),[_]=o.useState((()=>new i.Vector3)),[D]=o.useState((()=>new i.Vector3)),[P]=o.useState((()=>new i.Matrix4)),[C]=o.useState((()=>new i.Vector3(0,0,-1))),[R]=o.useState((()=>new i.Vector4)),[F]=o.useState((()=>new i.Vector3)),[k]=o.useState((()=>new i.Vector3)),[B]=o.useState((()=>new i.Vector4)),[I]=o.useState((()=>new i.Matrix4)),[L]=o.useState((()=>new i.PerspectiveCamera)),U=o.useCallback((()=>{if(_.setFromMatrixPosition(S.current.matrixWorld),D.setFromMatrixPosition(E.matrixWorld),P.extractRotation(S.current.matrixWorld),A.set(0,0,1),A.applyMatrix4(P),F.subVectors(_,D),F.dot(A)>0)return;F.reflect(A).negate(),F.add(_),P.extractRotation(E.matrixWorld),C.set(0,0,-1),C.applyMatrix4(P),C.add(D),k.subVectors(_,C),k.reflect(A).negate(),k.add(_),L.position.copy(F),L.up.set(0,1,0),L.up.applyMatrix4(P),L.up.reflect(A),L.lookAt(k),L.far=E.far,L.updateMatrixWorld(),L.projectionMatrix.copy(E.projectionMatrix),I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(L.projectionMatrix),I.multiply(L.matrixWorldInverse),I.multiply(S.current.matrixWorld),T.setFromNormalAndCoplanarPoint(A,_),T.applyMatrix4(L.matrixWorldInverse),R.set(T.normal.x,T.normal.y,T.normal.z,T.constant);const e=L.projectionMatrix;B.x=(Math.sign(R.x)+e.elements[8])/e.elements[0],B.y=(Math.sign(R.y)+e.elements[9])/e.elements[5],B.z=-1,B.w=(1+e.elements[10])/e.elements[14],R.multiplyScalar(2/R.dot(B)),e.elements[2]=R.x,e.elements[6]=R.y,e.elements[10]=R.z+1,e.elements[14]=R.w}),[]),[O,N,V,j]=o.useMemo((()=>{const r={type:i.HalfFloatType,minFilter:i.LinearFilter,magFilter:i.LinearFilter},o=new i.WebGLRenderTarget(n,n,r);o.depthBuffer=!0,o.depthTexture=new i.DepthTexture(n,n),o.depthTexture.format=i.DepthFormat,o.depthTexture.type=i.UnsignedShortType;const s=new i.WebGLRenderTarget(n,n,r);return[o,s,new Qi({gl:b,resolution:n,width:a[0],height:a[1],minDepthThreshold:l,maxDepthThreshold:u,depthScale:d,depthToBlurRatioBias:f}),{mirror:m,textureMatrix:I,mixBlur:e,tDiffuse:o.texture,tDepth:o.depthTexture,tDiffuseBlur:s.texture,hasBlur:z,mixStrength:t,minDepthThreshold:l,maxDepthThreshold:u,depthScale:d,depthToBlurRatioBias:f,transparent:!0,debug:p,distortion:y,distortionMap:v,mixContrast:g,"defines-USE_BLUR":z?"":void 0,"defines-USE_DEPTH":d>0?"":void 0,"defines-USE_DISTORTION":v?"":void 0}]}),[b,a,I,n,m,z,e,t,l,u,d,f,p,y,v,g]);return(0,s.F)((()=>{if(null==S||!S.current)return;S.current.visible=!1;const e=b.xr.enabled,t=b.shadowMap.autoUpdate;U(),b.xr.enabled=!1,b.shadowMap.autoUpdate=!1,b.setRenderTarget(O),b.state.buffers.depth.setMask(!0),b.autoClear||b.clear(),b.render(M,L),z&&V.render(b,O,N),b.xr.enabled=e,b.shadowMap.autoUpdate=t,S.current.visible=!0,b.setRenderTarget(null)})),o.createElement("mesh",(0,r.A)({ref:S},x),o.createElement("planeGeometry",{args:c}),h?h("meshReflectorMaterial",j):o.createElement("meshReflectorMaterial",j))}));class tl extends i.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new i.Vector3(0,0,0)},lightColor:{value:new i.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new i.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n        uniform vec3 spotPosition;\n        uniform float attenuation;\n\n        #include <common>\n        #include <logdepthbuf_pars_vertex>\n\n        void main() {\n          // compute intensity\n          vNormal = normalize(normalMatrix * normal);\n          vec4 worldPosition = modelMatrix * vec4(position, 1);\n          vec4 viewPosition = viewMatrix * worldPosition;\n          vViewZ = viewPosition.z;\n\n          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);\n\n          gl_Position = projectionMatrix * viewPosition;\n\n          #include <logdepthbuf_vertex>\n        }\n      ",fragmentShader:`\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n\n        uniform vec3 lightColor;\n        uniform float anglePower;\n        uniform sampler2D depth;\n        uniform vec2 resolution;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float opacity;\n\n        #include <packing>\n        #include <logdepthbuf_pars_fragment>\n\n        float readDepth(sampler2D depthSampler, vec2 uv) {\n          float fragCoordZ = texture(depthSampler, uv).r;\n\n          // https://github.com/mrdoob/three.js/issues/23072\n          #ifdef USE_LOGDEPTHBUF\n            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));\n          #else\n            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n          #endif\n\n          return viewZ;\n        }\n\n        void main() {\n          #include <logdepthbuf_fragment>\n\n          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);\n          float intensity = vIntensity * angleIntensity;\n\n          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n          if (isSoft) {\n            vec2 uv = gl_FragCoord.xy / resolution;\n            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));\n          }\n\n          gl_FragColor = vec4(lightColor, intensity * opacity);\n\n          #include <tonemapping_fragment>\n          #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}}var nl="#define GLSLIFY 1\nvarying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}";const rl=e=>null==e?void 0:e.isSpotLight;function ol({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:r,color:a="white",distance:c=5,angle:l=.15,attenuation:u=5,anglePower:d=5}){const f=o.useRef(null),m=(0,s.D)((e=>e.size)),h=(0,s.D)((e=>e.camera)),p=(0,s.D)((e=>e.viewport.dpr)),[y]=o.useState((()=>new tl)),[g]=o.useState((()=>new i.Vector3));t=void 0===t?.1:t,n=void 0===n?7*l:n,(0,s.F)((()=>{y.uniforms.spotPosition.value.copy(f.current.getWorldPosition(g)),f.current.lookAt(f.current.parent.target.getWorldPosition(g))}));const v=o.useMemo((()=>{const e=new i.CylinderGeometry(t,n,c,128,64,!0);return e.applyMatrix4((new i.Matrix4).makeTranslation(0,-c/2,0)),e.applyMatrix4((new i.Matrix4).makeRotationX(-Math.PI/2)),e}),[c,t,n]);return o.createElement(o.Fragment,null,o.createElement("mesh",{ref:f,geometry:v,raycast:()=>null},o.createElement("primitive",{object:y,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":a,"uniforms-attenuation-value":u,"uniforms-anglePower-value":d,"uniforms-depth-value":r,"uniforms-cameraNear-value":h.near,"uniforms-cameraFar-value":h.far,"uniforms-resolution-value":r?[m.width*p,m.height*p]:[0,0]})))}function al(e,t,n,r,a){const[[c,l]]=o.useState((()=>[new i.Vector3,new i.Vector3]));o.useLayoutEffect((()=>{if(!rl(e.current))throw new Error("SpotlightShadow must be a child of a SpotLight");e.current.shadow.mapSize.set(n,r),e.current.shadow.needsUpdate=!0}),[e,n,r]),(0,s.F)((()=>{if(!e.current)return;const n=e.current.position,r=e.current.target.position;l.copy(r).sub(n);var o=l.length();l.normalize().multiplyScalar(o*a),c.copy(n).add(l),t.current.position.copy(c),t.current.lookAt(e.current.target.position)}))}function il({distance:e=.4,alphaTest:t=.5,map:n,shader:r=nl,width:a=512,height:c=512,scale:l=1,children:u,...d}){const f=o.useRef(null),m=d.spotlightRef,h=d.debug;al(m,f,a,c,e);const p=o.useMemo((()=>new i.WebGLRenderTarget(a,c,{format:i.RGBAFormat,stencilBuffer:!1})),[a,c]),y=o.useRef({uShadowMap:{value:n},uTime:{value:0}});o.useEffect((()=>{y.current.uShadowMap.value=n}),[n]);const g=o.useMemo((()=>new qc.F(new i.ShaderMaterial({uniforms:y.current,vertexShader:"\n          varying vec2 vUv;\n\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n          ",fragmentShader:r}))),[r]);return o.useEffect((()=>()=>{g.material.dispose(),g.dispose()}),[g]),o.useEffect((()=>()=>p.dispose()),[p]),(0,s.F)((({gl:e},t)=>{y.current.uTime.value+=t,e.setRenderTarget(p),g.render(e),e.setRenderTarget(null)})),o.createElement(o.Fragment,null,o.createElement("mesh",{ref:f,scale:l,castShadow:!0},o.createElement("planeGeometry",null),o.createElement("meshBasicMaterial",{transparent:!0,side:i.DoubleSide,alphaTest:t,alphaMap:p.texture,"alphaMap-wrapS":i.RepeatWrapping,"alphaMap-wrapT":i.RepeatWrapping,opacity:h?1:0},u)))}function sl({distance:e=.4,alphaTest:t=.5,map:n,width:r=512,height:a=512,scale:s,children:c,...l}){const u=o.useRef(null),d=l.spotlightRef,f=l.debug;return al(d,u,r,a,e),o.createElement(o.Fragment,null,o.createElement("mesh",{ref:u,scale:s,castShadow:!0},o.createElement("planeGeometry",null),o.createElement("meshBasicMaterial",{transparent:!0,side:i.DoubleSide,alphaTest:t,alphaMap:n,"alphaMap-wrapS":i.RepeatWrapping,"alphaMap-wrapT":i.RepeatWrapping,opacity:f?1:0},c)))}function cl(e){return e.shader?o.createElement(il,e):o.createElement(sl,e)}const ll=o.forwardRef((({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:a,color:i="white",distance:s=5,angle:c=.15,attenuation:l=5,anglePower:u=5,volumetric:d=!0,debug:f=!1,children:m,...h},p)=>{const y=o.useRef(null);return o.useImperativeHandle(p,(()=>y.current),[]),o.createElement("group",null,f&&y.current&&o.createElement("spotLightHelper",{args:[y.current]}),o.createElement("spotLight",(0,r.A)({ref:y,angle:c,color:i,distance:s,castShadow:!0},h),d&&o.createElement(ol,{debug:f,opacity:e,radiusTop:t,radiusBottom:n,depthBuffer:a,color:i,distance:s,angle:c,attenuation:l,anglePower:u})),m&&o.cloneElement(m,{spotlightRef:y,debug:f}))})),ul=o.forwardRef((({light:e,args:t,map:n,toneMapped:a=!1,color:c="white",form:l="rect",intensity:u=1,scale:d=1,target:f=[0,0,0],children:m,...h},p)=>{const y=o.useRef(null);return o.useImperativeHandle(p,(()=>y.current),[]),o.useLayoutEffect((()=>{m||h.material||((0,s.k)(y.current.material,{color:c}),y.current.material.color.multiplyScalar(u))}),[c,u,m,h.material]),o.useLayoutEffect((()=>{h.rotation||y.current.quaternion.identity(),f&&!h.rotation&&("boolean"===typeof f?y.current.lookAt(0,0,0):y.current.lookAt(Array.isArray(f)?new i.Vector3(...f):f))}),[f,h.rotation]),d=Array.isArray(d)&&2===d.length?[d[0],d[1],1]:d,o.createElement("mesh",(0,r.A)({ref:y,scale:d},h),"circle"===l?o.createElement("ringGeometry",{args:t||[0,.5,64]}):"ring"===l?o.createElement("ringGeometry",{args:t||[.25,.5,64]}):"rect"===l||"plane"===l?o.createElement("planeGeometry",{args:t||[1,1]}):"box"===l?o.createElement("boxGeometry",{args:t||[1,1,1]}):o.createElement(l,{args:t}),m||o.createElement("meshBasicMaterial",{toneMapped:a,map:n,side:i.DoubleSide}),e&&o.createElement("pointLight",(0,r.A)({castShadow:!0},e)))}));var dl=n("UZln");function fl(e,t,n=new i.Vector3){const r=Math.PI*(e-.5),o=2*Math.PI*(t-.5);return n.x=Math.cos(o),n.y=Math.sin(r),n.z=Math.sin(o),n}const ml=o.forwardRef((({inclination:e=.6,azimuth:t=.1,distance:n=1e3,mieCoefficient:a=.005,mieDirectionalG:s=.8,rayleigh:c=.5,turbidity:l=10,sunPosition:u=fl(e,t),...d},f)=>{const m=o.useMemo((()=>(new i.Vector3).setScalar(n)),[n]),[h]=o.useState((()=>new dl.m));return o.createElement("primitive",(0,r.A)({object:h,ref:f,"material-uniforms-mieCoefficient-value":a,"material-uniforms-mieDirectionalG-value":s,"material-uniforms-rayleigh-value":c,"material-uniforms-sunPosition-value":u,"material-uniforms-turbidity-value":l,scale:m},d))}));class hl extends i.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:`\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n      }`})}}const pl=e=>(new i.Vector3).setFromSpherical(new i.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),yl=o.forwardRef((({radius:e=100,depth:t=50,count:n=5e3,saturation:r=0,factor:a=4,fade:c=!1,speed:l=1},u)=>{const d=o.useRef(),[f,m,h]=o.useMemo((()=>{const o=[],s=[],c=Array.from({length:n},(()=>(.5+.5*Math.random())*a)),l=new i.Color;let u=e+t;const d=t/n;for(let e=0;e<n;e++)u-=d*Math.random(),o.push(...pl(u).toArray()),l.setHSL(e/n,r,.9),s.push(l.r,l.g,l.b);return[new Float32Array(o),new Float32Array(s),new Float32Array(c)]}),[n,t,a,e,r]);(0,s.F)((e=>d.current&&(d.current.uniforms.time.value=e.clock.elapsedTime*l)));const[p]=o.useState((()=>new hl));return o.createElement("points",{ref:u},o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attach:"attributes-position",args:[f,3]}),o.createElement("bufferAttribute",{attach:"attributes-color",args:[m,3]}),o.createElement("bufferAttribute",{attach:"attributes-size",args:[h,1]})),o.createElement("primitive",{ref:d,object:p,attach:"material",blending:i.AdditiveBlending,"uniforms-fade-value":c,depthWrite:!1,transparent:!0,vertexColors:!0}))})),gl=new i.Matrix4,vl=new i.Vector3,xl=new i.Quaternion,wl=new i.Vector3,bl=new i.Quaternion,El=new i.Vector3,Ml=o.createContext(null),zl=o.forwardRef((({children:e,material:t=i.MeshLambertMaterial,texture:n="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",range:a,limit:c=200,frustumCulled:l,...u},d)=>{var f,m;const h=o.useMemo((()=>class extends t{constructor(){super();const e=parseInt(i.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader="attribute float cloudOpacity;\n               varying float vOpacity;\n              "+t.vertexShader.replace("#include <fog_vertex>","#include <fog_vertex>\n                 vOpacity = cloudOpacity;\n                "),t.fragmentShader="varying float vOpacity;\n              "+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>\n                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);\n                `)}}}),[t]);(0,s.e)({CloudMaterial:h});const p=o.useRef(null),y=o.useRef([]),g=o.useMemo((()=>new Float32Array(Array.from({length:c},(()=>1)))),[c]),v=o.useMemo((()=>new Float32Array(Array.from({length:c},(()=>[1,1,1])).flat())),[c]),x=Ne(n);let w,b=0,E=0;const M=new i.Quaternion,z=new i.Vector3(0,0,1),S=new i.Vector3;(0,s.F)(((e,t)=>{for(b=e.clock.elapsedTime,gl.copy(p.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(wl,bl,El),E=0;E<y.current.length;E++)w=y.current[E],w.ref.current.matrixWorld.decompose(vl,xl,El),vl.add(S.copy(w.position).applyQuaternion(xl).multiply(El)),xl.copy(bl).multiply(M.setFromAxisAngle(z,w.rotation+=t*w.rotationFactor)),El.multiplyScalar(w.volume+(1+Math.sin(b*w.density*w.speed))/2*w.growth),w.matrix.compose(vl,xl,El).premultiply(gl),w.dist=vl.distanceTo(wl);for(y.current.sort(((e,t)=>t.dist-e.dist)),E=0;E<y.current.length;E++)w=y.current[E],g[E]=w.opacity*(w.dist<w.fade-1?w.dist/w.fade:1),p.current.setMatrixAt(E,w.matrix),p.current.setColorAt(E,w.color);p.current.geometry.attributes.cloudOpacity.needsUpdate=!0,p.current.instanceMatrix.needsUpdate=!0,p.current.instanceColor&&(p.current.instanceColor.needsUpdate=!0)})),o.useLayoutEffect((()=>{const e=Math.min(c,void 0!==a?a:c,y.current.length);p.current.count=e,bi(p.current.instanceMatrix,{offset:0,count:16*e}),p.current.instanceColor&&bi(p.current.instanceColor,{offset:0,count:3*e}),bi(p.current.geometry.attributes.cloudOpacity,{offset:0,count:e})}));let T=[null!==(f=x.image.width)&&void 0!==f?f:1,null!==(m=x.image.height)&&void 0!==m?m:1];const A=Math.max(T[0],T[1]);return T=[T[0]/A,T[1]/A],o.createElement("group",(0,r.A)({ref:d},u),o.createElement(Ml.Provider,{value:y},e,o.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:p,args:[null,null,c],frustumCulled:l},o.createElement("instancedBufferAttribute",{usage:i.DynamicDrawUsage,attach:"instanceColor",args:[v,3]}),o.createElement("planeGeometry",{args:[...T]},o.createElement("instancedBufferAttribute",{usage:i.DynamicDrawUsage,attach:"attributes-cloudOpacity",args:[g,1]})),o.createElement("cloudMaterial",{key:t.name,map:x,transparent:!0,depthWrite:!1}))))})),Sl=o.forwardRef((({opacity:e=1,speed:t=0,bounds:n=[5,1,1],segments:a=20,color:c="#ffffff",fade:l=10,volume:u=6,smallestVolume:d=.25,distribute:f=null,growth:m=4,concentrate:h="inside",seed:p=Math.random(),...y},g)=>{function v(){const e=1e4*Math.sin(p++);return e-Math.floor(e)}const x=o.useContext(Ml),w=o.useRef(null),b=o.useId(),E=o.useMemo((()=>[...new Array(a)].map(((e,t)=>({segments:a,bounds:new i.Vector3(1,1,1),position:new i.Vector3,uuid:b,index:t,ref:w,dist:0,matrix:new i.Matrix4,color:new i.Color,rotation:t*(Math.PI/a)})))),[a,b]);return o.useLayoutEffect((()=>{E.forEach(((r,o)=>{(0,s.k)(r,{volume:u,color:c,speed:t,growth:m,opacity:e,fade:l,bounds:n,density:Math.max(.5,v()),rotationFactor:Math.max(.2,.5*v())*t});const i=null==f?void 0:f(r,o);var p;(i||a>1)&&r.position.copy(r.bounds).multiply(null!==(p=null==i?void 0:i.point)&&void 0!==p?p:{x:2*v()-1,y:2*v()-1,z:2*v()-1});const y=Math.abs(r.position.x),g=Math.abs(r.position.y),x=Math.abs(r.position.z),w=Math.max(y,g,x);r.length=1,y===w&&(r.length-=y/r.bounds.x),g===w&&(r.length-=g/r.bounds.y),x===w&&(r.length-=x/r.bounds.z),r.volume=(void 0!==(null==i?void 0:i.volume)?i.volume:Math.max(Math.max(0,d),"random"===h?v():"inside"===h?r.length:1-r.length))*u}))}),[h,n,l,c,e,m,u,p,a,t]),o.useLayoutEffect((()=>{const e=E;return x.current=[...x.current,...e],()=>{x.current=x.current.filter((e=>e.uuid!==b))}}),[E]),o.useImperativeHandle(g,(()=>w.current),[]),o.createElement("group",(0,r.A)({ref:w},y))})),Tl=o.forwardRef(((e,t)=>o.useContext(Ml)?o.createElement(Sl,(0,r.A)({ref:t},e)):o.createElement(zl,null,o.createElement(Sl,(0,r.A)({ref:t},e)))));class Al extends i.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:"\n        uniform float pixelRatio;\n        uniform float time;\n        attribute float size;  \n        attribute float speed;  \n        attribute float opacity;\n        attribute vec3 noise;\n        attribute vec3 color;\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        void main() {\n          vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n          vec4 viewPosition = viewMatrix * modelPosition;\n          vec4 projectionPostion = projectionMatrix * viewPosition;\n          gl_Position = projectionPostion;\n          gl_PointSize = size * 25. * pixelRatio;\n          gl_PointSize *= (1.0 / - viewPosition.z);\n          vColor = color;\n          vOpacity = opacity;\n        }\n      ",fragmentShader:`\n        varying vec3 vColor;\n        varying float vOpacity;\n        void main() {\n          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n          float strength = 0.05 / distanceToCenter - 0.1;\n          gl_FragColor = vec4(vColor, strength * vOpacity);\n          #include <tonemapping_fragment>\n          #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const _l=e=>e&&e.constructor===Float32Array,Dl=e=>e instanceof i.Vector2||e instanceof i.Vector3||e instanceof i.Vector4,Pl=e=>Array.isArray(e)?e:Dl(e)?e.toArray():[e,e,e];function Cl(e,t,n){return o.useMemo((()=>{if(void 0!==t){if(_l(t))return t;if(t instanceof i.Color){const n=Array.from({length:3*e},(()=>(e=>[e.r,e.g,e.b])(t))).flat();return Float32Array.from(n)}if(Dl(t)||Array.isArray(t)){const n=Array.from({length:3*e},(()=>Pl(t))).flat();return Float32Array.from(n)}return Float32Array.from({length:e},(()=>t))}return Float32Array.from({length:e},n)}),[t])}const Rl=o.forwardRef((({noise:e=1,count:t=100,speed:n=1,opacity:a=1,scale:c=1,size:l,color:u,children:d,...f},m)=>{o.useMemo((()=>(0,s.e)({SparklesImplMaterial:Al})),[]);const h=o.useRef(null),p=(0,s.D)((e=>e.viewport.dpr)),y=Pl(c),g=o.useMemo((()=>Float32Array.from(Array.from({length:t},(()=>y.map(i.MathUtils.randFloatSpread))).flat())),[t,...y]),v=Cl(t,l,Math.random),x=Cl(t,a),w=Cl(t,n),b=Cl(3*t,e),E=Cl(void 0===u?3*t:t,_l(u)?u:new i.Color(u),(()=>1));return(0,s.F)((e=>{h.current&&h.current.material&&(h.current.material.time=e.clock.elapsedTime)})),o.useImperativeHandle(m,(()=>h.current),[]),o.createElement("points",(0,r.A)({key:`particle-${t}-${JSON.stringify(c)}`},f,{ref:h}),o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attach:"attributes-position",args:[g,3]}),o.createElement("bufferAttribute",{attach:"attributes-size",args:[v,1]}),o.createElement("bufferAttribute",{attach:"attributes-opacity",args:[x,1]}),o.createElement("bufferAttribute",{attach:"attributes-speed",args:[w,1]}),o.createElement("bufferAttribute",{attach:"attributes-color",args:[E,3]}),o.createElement("bufferAttribute",{attach:"attributes-noise",args:[b,3]})),d||o.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:p,depthWrite:!1}))})),Fl="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/matcaps.json",kl="https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d";function Bl(e=0,t=1024,n){const r=(0,we.DY)((()=>fetch(Fl).then((e=>e.json()))),["matcapList"]),a=r[0],i=o.useMemo((()=>Object.keys(r).length),[]),s=`${o.useMemo((()=>"string"===typeof e?e:"number"===typeof e?r[e]:null),[e])||a}${function(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}(t)}.png`,c=`${kl}/${t}/${s}`;return[Ne(c,n),c,i]}const Il=({children:e,id:t,format:n,onLoad:r})=>{const a=Bl(t,n,r);return o.createElement(o.Fragment,null,null==e?void 0:e(a))},Ll="https://rawcdn.githack.com/pmndrs/drei-assets/7a3104997e1576f83472829815b00880d88b32fb",Ul="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/normals/normals.json";function Ol(e=0,t={},n){const{repeat:r=[1,1],anisotropy:a=1,offset:s=[0,0]}=t,c=(0,we.DY)((()=>fetch(Ul).then((e=>e.json()))),["normalsList"]),l=o.useMemo((()=>Object.keys(c).length),[]),u=c[0],d=c[e]||u,f=`${Ll}/normals/${d}`,m=Ne(f,n);return o.useLayoutEffect((()=>{m&&(m.wrapS=m.wrapT=i.RepeatWrapping,m.repeat=new i.Vector2(r[0],r[1]),m.offset=new i.Vector2(s[0],s[1]),m.anisotropy=a)}),[m,a,r,s]),[m,f,l]}const Nl=({children:e,id:t,onLoad:n,...r})=>{const a=Ol(t,r,n);return o.createElement(o.Fragment,null,null==e?void 0:e(a))},Vl={uniforms:{strokeOpacity:1,fillOpacity:.25,fillMix:0,thickness:.05,colorBackfaces:!1,dashInvert:!0,dash:!1,dashRepeats:4,dashLength:.5,squeeze:!1,squeezeMin:.2,squeezeMax:1,stroke:new i.Color("#ff0000"),backfaceStroke:new i.Color("#0000ff"),fill:new i.Color("#00ff00")},vertex:"\n\t  attribute vec3 barycentric;\n\t\n\t\tvarying vec3 v_edges_Barycentric;\n\t\tvarying vec3 v_edges_Position;\n\n\t\tvoid initWireframe() {\n\t\t\tv_edges_Barycentric = barycentric;\n\t\t\tv_edges_Position = position.xyz;\n\t\t}\n\t  ",fragment:"\n\t\t#ifndef PI\n\t  \t#define PI 3.1415926535897932384626433832795\n\t\t#endif\n  \n\t  varying vec3 v_edges_Barycentric;\n\t  varying vec3 v_edges_Position;\n  \n\t  uniform float strokeOpacity;\n\t  uniform float fillOpacity;\n\t  uniform float fillMix;\n\t  uniform float thickness;\n\t  uniform bool colorBackfaces;\n  \n\t  // Dash\n\t  uniform bool dashInvert;\n\t  uniform bool dash;\n\t  uniform bool dashOnly;\n\t  uniform float dashRepeats;\n\t  uniform float dashLength;\n  \n\t  // Squeeze\n\t  uniform bool squeeze;\n\t  uniform float squeezeMin;\n\t  uniform float squeezeMax;\n  \n\t  // Colors\n\t  uniform vec3 stroke;\n\t  uniform vec3 backfaceStroke;\n\t  uniform vec3 fill;\n  \n\t  // This is like\n\t  float wireframe_aastep(float threshold, float dist) {\n\t\t  float afwidth = fwidth(dist) * 0.5;\n\t\t  return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n\t  }\n  \n\t  float wireframe_map(float value, float min1, float max1, float min2, float max2) {\n\t\t  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n\t  }\n  \n\t  float getWireframe() {\n\t\t\tvec3 barycentric = v_edges_Barycentric;\n\t\t\n\t\t\t// Distance from center of each triangle to its edges.\n\t\t\tfloat d = min(min(barycentric.x, barycentric.y), barycentric.z);\n\n\t\t\t// for dashed rendering, we can use this to get the 0 .. 1 value of the line length\n\t\t\tfloat positionAlong = max(barycentric.x, barycentric.y);\n\t\t\tif (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n\t\t\t\tpositionAlong = 1.0 - positionAlong;\n\t\t\t}\n\n\t\t\t// the thickness of the stroke\n\t\t\tfloat computedThickness = wireframe_map(thickness, 0.0, 1.0, 0.0, 0.34);\n\n\t\t\t// if we want to shrink the thickness toward the center of the line segment\n\t\t\tif (squeeze) {\n\t\t\t\tcomputedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));\n\t\t\t}\n\n\t\t\t// Create dash pattern\n\t\t\tif (dash) {\n\t\t\t\t// here we offset the stroke position depending on whether it\n\t\t\t\t// should overlap or not\n\t\t\t\tfloat offset = 1.0 / dashRepeats * dashLength / 2.0;\n\t\t\t\tif (!dashInvert) {\n\t\t\t\t\toffset += 1.0 / dashRepeats / 2.0;\n\t\t\t\t}\n\n\t\t\t\t// if we should animate the dash or not\n\t\t\t\t// if (dashAnimate) {\n\t\t\t\t// \toffset += time * 0.22;\n\t\t\t\t// }\n\n\t\t\t\t// create the repeating dash pattern\n\t\t\t\tfloat pattern = fract((positionAlong + offset) * dashRepeats);\n\t\t\t\tcomputedThickness *= 1.0 - wireframe_aastep(dashLength, pattern);\n\t\t\t}\n\n\t\t\t// compute the anti-aliased stroke edge  \n\t\t\tfloat edge = 1.0 - wireframe_aastep(computedThickness, d);\n\n\t\t\treturn edge;\n\t  }\n\t  "},jl=Ue(Vl.uniforms,Vl.vertex+"\n  \tvoid main() {\n\t\tinitWireframe();\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n  ",Vl.fragment+"\n  void main () {\n\t\t// Compute color\n\n\t\tfloat edge = getWireframe();\n\t\tvec4 colorStroke = vec4(stroke, edge);\n\n\t\t#ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t#endif\n    \n\t\tvec4 colorFill = vec4(fill, fillOpacity);\n\t\tvec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\tgl_FragColor = outColor;\n\t}\n  ");function Gl(e){return void 0!==(null==e?void 0:e.current)}function Wl(e){return"WireframeGeometry"===e.type}function Hl(e){const t=null!=(n=e)&&n.current?e.current:e;var n;if(function(e){return!(null==e||!e.isBufferGeometry)}(t))return t;{if(Wl(t))throw new Error("Wireframe: WireframeGeometry is not supported.");const e=t.parent;if(function(e){return!(null==e||!e.geometry)}(e)){if(Wl(e.geometry))throw new Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function Xl(e,t){if(e.index){const t=e.toNonIndexed();e.copy(t),e.setIndex(null)}const n=function(e,t){const n=e.getAttribute("position").count,r=[];for(let o=0;o<n;o++){const e=t?1:0;o%2===0?r.push(0,0,1,0,1,0,1,0,e):r.push(0,1,0,0,0,1,1,0,e)}return new i.BufferAttribute(Float32Array.from(r),3)}(e,t);e.setAttribute("barycentric",n)}function ql({geometry:e,simplify:t=!1,...n}){(0,s.e)({MeshWireframeMaterial:jl});const[a,c]=o.useState(null);o.useLayoutEffect((()=>{const n=Hl(e);if(!n)throw new Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");Xl(n,t),Gl(e)&&c(n)}),[t,e]);const l=Gl(e)?a:e;return o.createElement(o.Fragment,null,l&&o.createElement("mesh",{geometry:l},o.createElement("meshWireframeMaterial",(0,r.A)({attach:"material",transparent:!0,side:i.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},n,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function $l({simplify:e=!1,...t}){const n=o.useRef(null),r=o.useMemo((()=>function(){const e={};for(const t in Vl.uniforms)e[t]={value:Vl.uniforms[t]};return e}()),[Vl.uniforms]);return function(e,t){o.useEffect((()=>{var n;e.fillOpacity.value=null!==(n=t.fillOpacity)&&void 0!==n?n:e.fillOpacity.value}),[t.fillOpacity]),o.useEffect((()=>{var n;e.fillMix.value=null!==(n=t.fillMix)&&void 0!==n?n:e.fillMix.value}),[t.fillMix]),o.useEffect((()=>{var n;e.strokeOpacity.value=null!==(n=t.strokeOpacity)&&void 0!==n?n:e.strokeOpacity.value}),[t.strokeOpacity]),o.useEffect((()=>{var n;e.thickness.value=null!==(n=t.thickness)&&void 0!==n?n:e.thickness.value}),[t.thickness]),o.useEffect((()=>{e.colorBackfaces.value=!!t.colorBackfaces}),[t.colorBackfaces]),o.useEffect((()=>{e.dash.value=!!t.dash}),[t.dash]),o.useEffect((()=>{e.dashInvert.value=!!t.dashInvert}),[t.dashInvert]),o.useEffect((()=>{var n;e.dashRepeats.value=null!==(n=t.dashRepeats)&&void 0!==n?n:e.dashRepeats.value}),[t.dashRepeats]),o.useEffect((()=>{var n;e.dashLength.value=null!==(n=t.dashLength)&&void 0!==n?n:e.dashLength.value}),[t.dashLength]),o.useEffect((()=>{e.squeeze.value=!!t.squeeze}),[t.squeeze]),o.useEffect((()=>{var n;e.squeezeMin.value=null!==(n=t.squeezeMin)&&void 0!==n?n:e.squeezeMin.value}),[t.squeezeMin]),o.useEffect((()=>{var n;e.squeezeMax.value=null!==(n=t.squeezeMax)&&void 0!==n?n:e.squeezeMax.value}),[t.squeezeMax]),o.useEffect((()=>{e.stroke.value=t.stroke?new i.Color(t.stroke):e.stroke.value}),[t.stroke]),o.useEffect((()=>{e.fill.value=t.fill?new i.Color(t.fill):e.fill.value}),[t.fill]),o.useEffect((()=>{e.backfaceStroke.value=t.backfaceStroke?new i.Color(t.backfaceStroke):e.backfaceStroke.value}),[t.backfaceStroke])}(r,t),o.useLayoutEffect((()=>{const t=Hl(n);if(!t)throw new Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");const r=t.clone();return Xl(t,e),()=>{t.copy(r),r.dispose()}}),[e]),o.useLayoutEffect((()=>{const e=n.current.parent,t=e.material.clone();return function(e,t){e.onBeforeCompile=e=>{e.uniforms={...e.uniforms,...t},e.vertexShader=e.vertexShader.replace("void main() {",`\n\t\t  ${Vl.vertex}\n\t\t  void main() {\n\t\t\tinitWireframe();\n\t\t`),e.fragmentShader=e.fragmentShader.replace("void main() {",`\n\t\t  ${Vl.fragment}\n\t\t  void main() {\n\t\t`),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n\t\t  #include <color_fragment>\n\t\t\t  float edge = getWireframe();\n\t\t  vec4 colorStroke = vec4(stroke, edge);\n\t\t  #ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t  #endif\n\t\t  vec4 colorFill = vec4(mix(diffuseColor.rgb, fill, fillMix), mix(diffuseColor.a, fillOpacity, fillMix));\n\t\t  vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\t  diffuseColor.rgb = outColor.rgb;\n\t\t  diffuseColor.a *= outColor.a;\n\t\t")},e.side=i.DoubleSide,e.transparent=!0}(e.material,r),()=>{e.material.dispose(),e.material=t}}),[]),o.createElement("object3D",{ref:n})}function Yl({geometry:e,...t}){return e?o.createElement(ql,(0,r.A)({geometry:e},t)):o.createElement($l,t)}function Kl({opacity:e,alphaMap:t}){const n=o.useRef(null),r=o.useRef(null),a=o.useRef({value:1}),c=o.useRef({value:null}),l=o.useRef({value:!1});return o.useLayoutEffect((()=>{n.current.onBeforeCompile=r.current.onBeforeCompile=e=>{const t=e.fragmentShader.indexOf("void main");let n,r="",o=t;for(;"\n"!==n&&o<t+100;)n=e.fragmentShader.charAt(o),r+=n,o++;r=r.trim(),e.vertexShader=e.vertexShader.replace("void main() {","\n        varying vec2 custom_vUv;\n\n        void main() {\n          custom_vUv = uv;\n          \n        "),e.fragmentShader=e.fragmentShader.replace(r,"\n          uniform float uShadowOpacity;\n          uniform sampler2D uAlphaMap;\n          uniform bool uHasAlphaMap;\n\n          varying vec2 custom_vUv;\n  \n          float bayerDither2x2( vec2 v ) {\n            return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n          }\n    \n          float bayerDither4x4( vec2 v ) {\n            vec2 P1 = mod( v, 2.0 );\n            vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n            return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n          }\n  \n          void main() {\n            float alpha = \n              uHasAlphaMap ? \n                uShadowOpacity * texture2D(uAlphaMap, custom_vUv).x\n              : uShadowOpacity;\n\n            if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n            \n          "),e.uniforms.uShadowOpacity=a.current,e.uniforms.uAlphaMap=c.current,e.uniforms.uHasAlphaMap=l.current}}),[]),(0,s.F)((()=>{var r;const o=null==(r=n.current.__r3f)?void 0:r.parent;if(o){const n=o.material;n&&(a.current.value=null!==e&&void 0!==e?e:n.opacity,!1===t?(c.current.value=null,l.current.value=!1):(c.current.value=t||n.alphaMap,l.current.value=!!c.current.value))}})),o.createElement(o.Fragment,null,o.createElement("meshDepthMaterial",{ref:n,attach:"customDepthMaterial",depthPacking:i.RGBADepthPacking}),o.createElement("meshDistanceMaterial",{ref:r,attach:"customDistanceMaterial"}))}const Zl=new i.Matrix4,Ql=new i.Ray,Jl=new i.Sphere,eu=new i.Vector3;class tu extends i.Group{constructor(){super(),this.size=0,this.color=new i.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){var n,r;const o=this.instance.current;if(!o||!o.geometry)return;const a=o.userData.instances.indexOf(this.instanceKey);if(-1===a||a>o.geometry.drawRange.count)return;const s=null!==(n=null==(r=e.params.Points)?void 0:r.threshold)&&void 0!==n?n:1;if(Jl.set(this.getWorldPosition(eu),s),!1===e.ray.intersectsSphere(Jl))return;Zl.copy(o.matrixWorld).invert(),Ql.copy(e.ray).applyMatrix4(Zl);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=c*c,u=Ql.distanceSqToPoint(this.position);if(u<l){const n=new i.Vector3;Ql.closestPointToPoint(this.position,n),n.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(n);if(r<e.near||r>e.far)return;t.push({distance:r,distanceToRay:Math.sqrt(u),point:n,index:a,face:null,object:this})}}}let nu,ru;const ou=o.createContext(null),au=new i.Matrix4,iu=new i.Vector3,su=o.forwardRef((({children:e,range:t,limit:n=1e3,...a},c)=>{const l=o.useRef(null);o.useImperativeHandle(c,(()=>l.current),[]);const[u,d]=o.useState([]),[[f,m,h]]=o.useState((()=>[new Float32Array(3*n),Float32Array.from({length:3*n},(()=>1)),Float32Array.from({length:n},(()=>1))]));o.useEffect((()=>{l.current.geometry.attributes.position.needsUpdate=!0})),(0,s.F)((()=>{for(l.current.updateMatrix(),l.current.updateMatrixWorld(),au.copy(l.current.matrixWorld).invert(),l.current.geometry.drawRange.count=Math.min(n,void 0!==t?t:n,u.length),nu=0;nu<u.length;nu++)ru=u[nu].current,ru.getWorldPosition(iu).applyMatrix4(au),iu.toArray(f,3*nu),l.current.geometry.attributes.position.needsUpdate=!0,ru.matrixWorldNeedsUpdate=!0,ru.color.toArray(m,3*nu),l.current.geometry.attributes.color.needsUpdate=!0,h.set([ru.size],nu),l.current.geometry.attributes.size.needsUpdate=!0}));const p=o.useMemo((()=>({getParent:()=>l,subscribe:e=>(d((t=>[...t,e])),()=>d((t=>t.filter((t=>t.current!==e.current)))))})),[]);return o.createElement("points",(0,r.A)({userData:{instances:u},matrixAutoUpdate:!1,ref:l,raycast:()=>null},a),o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attach:"attributes-position",count:f.length/3,array:f,itemSize:3,usage:i.DynamicDrawUsage}),o.createElement("bufferAttribute",{attach:"attributes-color",count:m.length/3,array:m,itemSize:3,usage:i.DynamicDrawUsage}),o.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:i.DynamicDrawUsage})),o.createElement(ou.Provider,{value:p},e))})),cu=o.forwardRef((({children:e,...t},n)=>{o.useMemo((()=>(0,s.e)({PositionPoint:tu})),[]);const a=o.useRef(null);o.useImperativeHandle(n,(()=>a.current),[]);const{subscribe:i,getParent:c}=o.useContext(ou);return o.useLayoutEffect((()=>i(a)),[]),o.createElement("positionPoint",(0,r.A)({instance:c(),instanceKey:a,ref:a},t),e)})),lu=o.forwardRef((({children:e,positions:t,colors:n,sizes:a,stride:c=3,...l},u)=>{const d=o.useRef(null);return o.useImperativeHandle(u,(()=>d.current),[]),(0,s.F)((()=>{const e=d.current.geometry.attributes;e.position.needsUpdate=!0,n&&(e.color.needsUpdate=!0),a&&(e.size.needsUpdate=!0)})),o.createElement("points",(0,r.A)({ref:d},l),o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attach:"attributes-position",count:t.length/c,array:t,itemSize:c,usage:i.DynamicDrawUsage}),n&&o.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/c,array:n,itemSize:3,usage:i.DynamicDrawUsage}),a&&o.createElement("bufferAttribute",{attach:"attributes-size",count:a.length/c,array:a,itemSize:1,usage:i.DynamicDrawUsage})),e)})),uu=o.forwardRef(((e,t)=>e.positions instanceof Float32Array?o.createElement(lu,(0,r.A)({},e,{ref:t})):o.createElement(su,(0,r.A)({},e,{ref:t})))),du=o.createContext(null),fu=o.forwardRef(((e,t)=>{o.useMemo((()=>(0,s.e)({SegmentObject:mu})),[]);const{limit:n=1e3,lineWidth:a=1,children:c,...l}=e,[u,d]=o.useState([]),[f]=o.useState((()=>new le.X)),[m]=o.useState((()=>new ue.G)),[h]=o.useState((()=>new de.n)),[p]=o.useState((()=>new i.Vector2(512,512))),[y]=o.useState((()=>Array(6*n).fill(0))),[g]=o.useState((()=>Array(6*n).fill(0))),v=o.useMemo((()=>({subscribe:e=>(d((t=>[...t,e])),()=>d((t=>t.filter((t=>t.current!==e.current)))))})),[]);return(0,s.F)((()=>{for(let t=0;t<n;t++){var e;const n=null==(e=u[t])?void 0:e.current;n&&(y[6*t+0]=n.start.x,y[6*t+1]=n.start.y,y[6*t+2]=n.start.z,y[6*t+3]=n.end.x,y[6*t+4]=n.end.y,y[6*t+5]=n.end.z,g[6*t+0]=n.color.r,g[6*t+1]=n.color.g,g[6*t+2]=n.color.b,g[6*t+3]=n.color.r,g[6*t+4]=n.color.g,g[6*t+5]=n.color.b)}h.setColors(g),h.setPositions(y),f.computeLineDistances()})),o.createElement("primitive",{object:f,ref:t},o.createElement("primitive",{object:h,attach:"geometry"}),o.createElement("primitive",(0,r.A)({object:m,attach:"material",vertexColors:!0,resolution:p,linewidth:a},l)),o.createElement(du.Provider,{value:v},c))}));class mu{constructor(){this.color=new i.Color("white"),this.start=new i.Vector3(0,0,0),this.end=new i.Vector3(0,0,0)}}const hu=e=>e instanceof i.Vector3?e:new i.Vector3(..."number"===typeof e?[e,e,e]:e),pu=o.forwardRef((({color:e,start:t,end:n},r)=>{const a=o.useContext(du);if(!a)throw"Segment must used inside Segments component.";const i=o.useRef(null);return o.useImperativeHandle(r,(()=>i.current),[]),o.useLayoutEffect((()=>a.subscribe(i)),[]),o.createElement("segmentObject",{ref:i,color:e,start:hu(t),end:hu(n)})})),yu=o.forwardRef((({children:e,hysteresis:t=0,distances:n,...a},i)=>{const c=o.useRef(null);return o.useImperativeHandle(i,(()=>c.current),[]),o.useLayoutEffect((()=>{const{current:e}=c;e.levels.length=0,e.children.forEach(((r,o)=>e.levels.push({object:r,hysteresis:t,distance:n[o]})))})),(0,s.F)((e=>{var t;return null==(t=c.current)?void 0:t.update(e.camera)})),o.createElement("lOD",(0,r.A)({ref:c},a),e)}));function gu({all:e,scene:t,camera:n}){const r=(0,s.D)((({gl:e})=>e)),a=(0,s.D)((({camera:e})=>e)),c=(0,s.D)((({scene:e})=>e));return o.useLayoutEffect((()=>{const o=[];e&&(t||c).traverse((e=>{!1===e.visible&&(o.push(e),e.visible=!0)})),r.compile(t||c,n||a);const s=new i.WebGLCubeRenderTarget(128);new i.CubeCamera(.01,1e5,s).update(r,t||c),s.dispose(),o.forEach((e=>e.visible=!1))}),[]),null}function vu(){const e=(0,s.D)((e=>e.gl));return(0,o.useEffect)((()=>(e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,()=>{e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0})),[e.shadowMap]),null}const xu=new i.Matrix4,wu=new i.Ray,bu=new i.Sphere,Eu=new i.Vector3;function Mu(e,t){const n=this.geometry,r=this.material,o=this.matrixWorld;void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),bu.copy(n.boundingSphere),bu.applyMatrix4(o),!1!==e.ray.intersectsSphere(bu)&&(xu.copy(o).invert(),wu.copy(e.ray).applyMatrix4(xu),null!==n.boundingBox&&null===wu.intersectBox(n.boundingBox,Eu)||t.push({distance:Eu.distanceTo(e.ray.origin),point:Eu.clone(),object:this})))}function zu({pixelated:e}){const t=(0,s.D)((e=>e.gl)),n=(0,s.D)((e=>e.internal.active)),r=(0,s.D)((e=>e.performance.current)),a=(0,s.D)((e=>e.viewport.initialDpr)),i=(0,s.D)((e=>e.setDpr));return o.useEffect((()=>{const r=t.domElement;return()=>{n&&i(a),e&&r&&(r.style.imageRendering="auto")}}),[]),o.useEffect((()=>{i(r*a),e&&t.domElement&&(t.domElement.style.imageRendering=1===r?"auto":"pixelated")}),[r]),null}function Su(){const e=(0,s.D)((e=>e.get)),t=(0,s.D)((e=>e.setEvents)),n=(0,s.D)((e=>e.performance.current));return o.useEffect((()=>{const n=e().events.enabled;return()=>t({enabled:n})}),[]),o.useEffect((()=>t({enabled:1===n})),[n]),null}const Tu=(0,o.createContext)(null);function Au({iterations:e=10,ms:t=250,threshold:n=.75,step:r=.1,factor:a=.5,flipflops:i=1/0,bounds:c=e=>e>100?[60,100]:[40,60],onIncline:l,onDecline:u,onChange:d,onFallback:f,children:m}){const h=Math.pow(10,0),[p,y]=(0,o.useState)((()=>({fps:0,index:0,factor:a,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:e=>{const t=Symbol();return p.subscriptions.set(t,e.current),()=>{p.subscriptions.delete(t)}}})));let g=0;return(0,s.F)((()=>{const{frames:o,averages:a}=p;if(!p.fallback&&a.length<e){o.push(performance.now());const s=o[o.length-1]-o[0];if(s>=t){if(p.fps=Math.round(o.length/s*1e3*h)/h,p.refreshrate=Math.max(p.refreshrate,p.fps),a[p.index++%e]=p.fps,a.length===e){const[t,o]=c(p.refreshrate),s=a.filter((e=>e>=o)),m=a.filter((e=>e<t));s.length>e*n&&(p.factor=Math.min(1,p.factor+r),p.flipped++,l&&l(p),p.subscriptions.forEach((e=>e.onIncline&&e.onIncline(p)))),m.length>e*n&&(p.factor=Math.max(0,p.factor-r),p.flipped++,u&&u(p),p.subscriptions.forEach((e=>e.onDecline&&e.onDecline(p)))),g!==p.factor&&(g=p.factor,d&&d(p),p.subscriptions.forEach((e=>e.onChange&&e.onChange(p)))),p.flipped>i&&!p.fallback&&(p.fallback=!0,f&&f(p),p.subscriptions.forEach((e=>e.onFallback&&e.onFallback(p)))),p.averages=[]}p.frames=[]}}})),o.createElement(Tu.Provider,{value:p},m)}function _u({onIncline:e,onDecline:t,onChange:n,onFallback:r}){const a=(0,o.useContext)(Tu),i=(0,o.useRef)({onIncline:e,onDecline:t,onChange:n,onFallback:r});(0,o.useLayoutEffect)((()=>{i.current.onIncline=e,i.current.onDecline=t,i.current.onChange=n,i.current.onFallback=r}),[e,t,n,r]),(0,o.useLayoutEffect)((()=>a.subscribe(i)),[a])}const Du=o.forwardRef((({children:e,compute:t,width:n,height:a,samples:c=8,renderPriority:l=0,eventPriority:u=0,frames:d=1/0,stencilBuffer:f=!1,depthBuffer:m=!0,generateMipmaps:h=!1,...p},y)=>{const{size:g,viewport:v}=(0,s.D)(),x=Ft((n||g.width)*v.dpr,(a||g.height)*v.dpr,{samples:c,stencilBuffer:f,depthBuffer:m,generateMipmaps:h}),[w]=o.useState((()=>new i.Scene)),b=o.useCallback(((e,t,n)=>{var r,o;let a=null==(r=x.texture)?void 0:r.__r3f.parent;for(;a&&!(a instanceof i.Object3D);)a=a.__r3f.parent;if(!a)return!1;n.raycaster.camera||n.events.compute(e,n,null==(o=n.previousRoot)?void 0:o.getState());const[s]=n.raycaster.intersectObject(a);if(!s)return!1;const c=s.uv;if(!c)return!1;t.raycaster.setFromCamera(t.pointer.set(2*c.x-1,2*c.y-1),t.camera)}),[]);return o.useImperativeHandle(y,(()=>x.texture),[x]),o.createElement(o.Fragment,null,(0,s.h)(o.createElement(Pu,{renderPriority:l,frames:d,fbo:x},e,o.createElement("group",{onPointerOver:()=>null})),w,{events:{compute:t||b,priority:u}}),o.createElement("primitive",(0,r.A)({object:x.texture},p)))}));function Pu({frames:e,renderPriority:t,children:n,fbo:r}){let a,i,c,l,u=0;return(0,s.F)((t=>{(e===1/0||u<e)&&(a=t.gl.autoClear,i=t.gl.xr.enabled,c=t.gl.getRenderTarget(),l=t.gl.xr.isPresenting,t.gl.autoClear=!0,t.gl.xr.enabled=!1,t.gl.xr.isPresenting=!1,t.gl.setRenderTarget(r),t.gl.render(t.scene,t.camera),t.gl.setRenderTarget(c),t.gl.autoClear=a,t.gl.xr.enabled=i,t.gl.xr.isPresenting=l,u++)}),t),o.createElement(o.Fragment,null,n)}const Cu=o.forwardRef((({children:e,compute:t,renderPriority:n=-1,eventPriority:a=0,frames:c=1/0,stencilBuffer:l=!1,depthBuffer:u=!0,generateMipmaps:d=!1,resolution:f=896,near:m=.1,far:h=1e3,flip:p=!1,position:y,rotation:g,scale:v,quaternion:x,matrix:w,matrixAutoUpdate:b,...E},M)=>{const{size:z,viewport:S}=(0,s.D)(),T=o.useRef(null),A=o.useMemo((()=>{const e=new i.WebGLCubeRenderTarget(Math.max((f||z.width)*S.dpr,(f||z.height)*S.dpr),{stencilBuffer:l,depthBuffer:u,generateMipmaps:d});return e.texture.isRenderTargetTexture=!p,e.texture.flipY=!0,e.texture.type=i.HalfFloatType,e}),[f,p]);o.useEffect((()=>()=>A.dispose()),[A]);const[_]=o.useState((()=>new i.Scene));return o.useImperativeHandle(M,(()=>({scene:_,fbo:A,camera:T.current})),[A]),o.createElement(o.Fragment,null,(0,s.h)(o.createElement(Ru,{renderPriority:n,frames:c,camera:T},e,o.createElement("group",{onPointerOver:()=>null})),_,{events:{compute:t,priority:a}}),o.createElement("primitive",(0,r.A)({object:A.texture},E)),o.createElement("cubeCamera",{ref:T,args:[m,h,A],position:y,rotation:g,scale:v,quaternion:x,matrix:w,matrixAutoUpdate:b}))}));function Ru({frames:e,renderPriority:t,children:n,camera:r}){let a=0;return(0,s.F)((t=>{(e===1/0||a<e)&&(r.current.update(t.gl,t.scene),a++)}),t),o.createElement(o.Fragment,null,n)}const Fu=o.forwardRef((({id:e=1,colorWrite:t=!1,depthWrite:n=!1,...a},s)=>{const c=o.useRef(null),l=o.useMemo((()=>({colorWrite:t,depthWrite:n,stencilWrite:!0,stencilRef:e,stencilFunc:i.AlwaysStencilFunc,stencilFail:i.ReplaceStencilOp,stencilZFail:i.ReplaceStencilOp,stencilZPass:i.ReplaceStencilOp})),[e,t,n]);return o.useLayoutEffect((()=>{Object.assign(c.current.material,l)})),o.useImperativeHandle(s,(()=>c.current),[]),o.createElement("mesh",(0,r.A)({ref:c,renderOrder:-e},a))}));function ku(e,t=!1){return{stencilWrite:!0,stencilRef:e,stencilFunc:t?i.NotEqualStencilFunc:i.EqualStencilFunc,stencilFail:i.KeepStencilOp,stencilZFail:i.KeepStencilOp,stencilZPass:i.KeepStencilOp}}function Bu({renderPriority:e=1,zoom:t=0,segments:n=64,children:a,resolution:c=896,...l}){const u=o.useRef(null),d=o.useRef(null),{width:f,height:m}=(0,s.D)((e=>e.size)),[h]=o.useState((()=>new i.OrthographicCamera));o.useLayoutEffect((()=>{h.position.set(0,0,100),h.zoom=100,h.left=f/-2,h.right=f/2,h.top=m/2,h.bottom=m/-2,h.updateProjectionMatrix()}),[f,m]);const p=Math.sqrt(f*f+m*m)/100*(.5+t/2),y=new i.Vector3,g=new i.Sphere(new i.Vector3,p),v=new i.Matrix3,x=o.useCallback(((e,t,n)=>{t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,h),t.raycaster.ray.intersectSphere(g,y)&&(y.normalize(),v.getNormalMatrix(d.current.camera.matrixWorld),d.current.camera.getWorldPosition(t.raycaster.ray.origin),t.raycaster.ray.direction.set(0,0,1).reflect(y),t.raycaster.ray.direction.x*=-1,t.raycaster.ray.direction.applyNormalMatrix(v).multiplyScalar(-1))}),[]);return(0,s.F)((t=>{e&&t.gl.render(u.current,h)}),e),o.createElement(o.Fragment,null,o.createElement("mesh",(0,r.A)({ref:u},l,{scale:p}),o.createElement("sphereGeometry",{args:[1,n,n]}),o.createElement("meshBasicMaterial",null,o.createElement(Cu,{compute:x,attach:"envMap",flip:!0,resolution:c,ref:d},a,o.createElement(Iu,{api:d})))))}function Iu({api:e}){const t=new i.Vector3,n=new i.Quaternion,r=new i.Vector3,o=new i.Euler(0,Math.PI,0);return(0,s.F)((a=>{a.camera.matrixWorld.decompose(t,n,r),e.current.camera.position.copy(t),e.current.camera.quaternion.setFromEuler(o).premultiply(n)})),null}const Lu=Ue({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new i.Vector2},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n     vUv = uv;\n   }",`uniform sampler2D sdf;\n   uniform sampler2D map;\n   uniform float blur;\n   uniform float size;\n   uniform float time;\n   uniform vec2 resolution;\n   varying vec2 vUv;\n   #include <packing>\n   void main() {\n     vec2 uv = gl_FragCoord.xy / resolution.xy;\n     vec4 t = texture2D(map, uv);\n     float k = blur;\n     float d = texture2D(sdf, vUv).r/size;\n     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));\n     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);\n     #include <tonemapping_fragment>\n     #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),Uu=o.forwardRef((({children:e,events:t,blur:n=0,eventPriority:a=0,renderPriority:c=0,worldUnits:l=!1,resolution:u=512,...d},f)=>{(0,s.e)({PortalMaterialImpl:Lu});const m=o.useRef(null),{scene:h,gl:p,size:y,viewport:g,setEvents:v}=(0,s.D)(),x=Ft(u,u),[w,b]=o.useState(0);(0,s.F)((()=>{const e=m.current.blend>0?Math.max(1,c):0;w!==e&&b(e)})),o.useEffect((()=>{void 0!==t&&v({enabled:!t})}),[t]);const[E,M]=o.useState(!0),z=ai(M);o.useLayoutEffect((()=>{var e;z.current=null==(e=m.current)?void 0:e.__r3f.parent}),[]),o.useLayoutEffect((()=>{if(z.current&&n&&null===m.current.sdf){const e=new i.Mesh(z.current.geometry,new i.MeshBasicMaterial),t=(new i.Box3).setFromBufferAttribute(e.geometry.attributes.position),n=new i.OrthographicCamera(t.min.x*(1+2/u),t.max.x*(1+2/u),t.max.y*(1+2/u),t.min.y*(1+2/u),.1,1e3);n.position.set(0,0,1),n.lookAt(0,0,0),p.setRenderTarget(x),p.render(e,n);const r=Nu(u,u,p)(x.texture),o=new Float32Array(u*u);p.readRenderTargetPixels(r,0,0,u,u,o);let a=1/0;for(let i=0;i<o.length;i++)o[i]<a&&(a=o[i]);a=-a,m.current.size=a,m.current.sdf=r.texture,p.setRenderTarget(null)}}),[u,n]),o.useImperativeHandle(f,(()=>m.current));const S=o.useCallback(((e,t,n)=>{var r;if(!z.current)return!1;if(t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera),0===(null==(r=m.current)?void 0:r.blend)){const[e]=t.raycaster.intersectObject(z.current);if(!e)return t.raycaster.camera=void 0,!1}}),[]);return o.createElement("portalMaterialImpl",(0,r.A)({ref:m,blur:n,blend:0,resolution:[y.width*g.dpr,y.height*g.dpr],attach:"material"},d),o.createElement(Du,{attach:"map",frames:E?1/0:0,eventPriority:a,renderPriority:c,compute:S},e,o.createElement(Ou,{events:t,rootScene:h,priority:w,material:m,worldUnits:l})))}));function Ou({events:e,rootScene:t,material:n,priority:r,worldUnits:a}){const c=(0,s.D)((e=>e.scene)),l=(0,s.D)((e=>e.setEvents)),u=Ft(),d=Ft();o.useLayoutEffect((()=>{c.matrixAutoUpdate=!1}),[]),o.useEffect((()=>{void 0!==e&&l({enabled:e})}),[e]);const[f,m]=o.useMemo((()=>{const e={value:0};return[new qc.F(new i.ShaderMaterial({uniforms:{a:{value:u.texture},b:{value:d.texture},blend:e},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n          }",fragmentShader:`\n          uniform sampler2D a;\n          uniform sampler2D b;\n          uniform float blend;\n          varying vec2 vUv;\n          #include <packing>\n          void main() {\n            vec4 ta = texture2D(a, vUv);\n            vec4 tb = texture2D(b, vUv);\n            gl_FragColor = mix(tb, ta, blend);\n            #include <tonemapping_fragment>\n            #include <${je>=154?"colorspace_fragment":"encodings_fragment"}>\n          }`})),e]}),[]);return(0,s.F)((e=>{var o;let i=null==n||null==(o=n.current)?void 0:o.__r3f.parent;var s,l,h,p;i&&(a?c.matrixWorld.identity():(r&&1===(null==(s=n.current)?void 0:s.blend)&&i.updateWorldMatrix(!0,!1),c.matrixWorld.copy(i.matrixWorld)),r&&((null==(l=n.current)?void 0:l.blend)>0&&(null==(h=n.current)?void 0:h.blend)<1?(m.value=n.current.blend,e.gl.setRenderTarget(u),e.gl.render(c,e.camera),e.gl.setRenderTarget(d),e.gl.render(t,e.camera),e.gl.setRenderTarget(null),f.render(e.gl)):1===(null==(p=n.current)?void 0:p.blend)&&e.gl.render(c,e.camera)))}),r),o.createElement(o.Fragment,null)}const Nu=(e,t,n)=>{let r=new i.WebGLRenderTarget(e,t,{minFilter:i.LinearMipmapLinearFilter,magFilter:i.LinearFilter,type:i.FloatType,format:i.RedFormat,generateMipmaps:!0}),o=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter}),a=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter}),s=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter}),c=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter}),l=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter,type:i.FloatType,format:i.RedFormat}),u=new i.WebGLRenderTarget(e,t,{minFilter:i.NearestFilter,magFilter:i.NearestFilter,type:i.FloatType,format:i.RedFormat});const d=new qc.F(new i.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));\n        }"})),f=new qc.F(new i.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));\n        }"})),m=new qc.F(new i.ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:`\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform float offset;\n        uniform float level;\n        uniform float maxSteps;\n        #include <packing>\n        void main() {\n          float closestDist = 9999999.9;\n          vec2 closestPos = vec2(0.0);\n          for (float x = -1.0; x <= 1.0; x += 1.0) {\n            for (float y = -1.0; y <= 1.0; y += 1.0) {\n              vec2 voffset = vUv;\n              voffset += vec2(x, y) * vec2(${1/e}, ${1/t}) * offset;\n              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));\n              float dist = distance(pos.xy, vUv);\n              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {\n                closestDist = dist;\n                closestPos = pos;\n              }\n            }\n          }\n          gl_FragColor = pack2HalfToRGBA(closestPos);\n        }`})),h=new qc.F(new i.ShaderMaterial({uniforms:{tex:{value:null},size:{value:new i.Vector2(e,t)}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform vec2 size;\n        #include <packing>\n        void main() {\n          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);\n        }"})),p=new qc.F(new i.ShaderMaterial({uniforms:{inside:{value:u.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D inside;\n        uniform sampler2D outside;\n        uniform sampler2D tex;\n        #include <packing>\n        void main() {\n          float i = texture2D(inside, vUv).x;\n          float o =texture2D(outside, vUv).x;\n          if (texture2D(tex, vUv).x == 0.0) {\n            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);\n          } else {\n            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);\n          }\n        }"}));return y=>{let g=r;y.minFilter=i.NearestFilter,y.magFilter=i.NearestFilter,d.material.uniforms.tex.value=y,n.setRenderTarget(o),d.render(n);const v=Math.ceil(Math.log(Math.max(e,t))/Math.log(2));let x=o,w=null;for(let e=0;e<v;e++){const t=Math.pow(2,v-e-1);w=x===o?s:o,m.material.uniforms.level.value=e,m.material.uniforms.maxSteps.value=v,m.material.uniforms.offset.value=t,m.material.uniforms.tex.value=x.texture,n.setRenderTarget(w),m.render(n),x=w}n.setRenderTarget(l),h.material.uniforms.tex.value=w.texture,h.render(n),f.material.uniforms.tex.value=y,n.setRenderTarget(a),f.render(n),x=a;for(let e=0;e<v;e++){const t=Math.pow(2,v-e-1);w=x===a?c:a,m.material.uniforms.level.value=e,m.material.uniforms.maxSteps.value=v,m.material.uniforms.offset.value=t,m.material.uniforms.tex.value=x.texture,n.setRenderTarget(w),m.render(n),x=w}return n.setRenderTarget(u),h.material.uniforms.tex.value=w.texture,h.render(n),n.setRenderTarget(g),p.material.uniforms.tex.value=y,p.render(n),n.setRenderTarget(null),g}};var Vu=n("STsu");const ju=new i.Color,Gu=(0,Vu.A)();function Wu(e){return"top"in e}function Hu(e,t){const{right:n,top:r,left:o,bottom:a,width:i,height:s}=t,c=t.bottom<0||r>e.height||n<0||t.left>e.width;if(Wu(e)){const t=e.top+e.height-a;return{position:{width:i,height:s,left:o-e.left,top:r,bottom:t,right:n},isOffscreen:c}}return{position:{width:i,height:s,top:r,left:o,bottom:e.height-a,right:n},isOffscreen:c}}function Xu(e,{left:t,bottom:n,width:r,height:o}){let a;const i=r/o;var s;return(s=e.camera)&&s.isOrthographicCamera?e.camera.manual?e.camera.updateProjectionMatrix():e.camera.left===r/-2&&e.camera.right===r/2&&e.camera.top===o/2&&e.camera.bottom===o/-2||(Object.assign(e.camera,{left:r/-2,right:r/2,top:o/2,bottom:o/-2}),e.camera.updateProjectionMatrix()):e.camera.aspect!==i&&(e.camera.aspect=i,e.camera.updateProjectionMatrix()),a=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(t,n,r,o),e.gl.setScissor(t,n,r,o),e.gl.setScissorTest(!0),a}function qu(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function $u(e){e.gl.getClearColor(ju),e.gl.setClearColor(ju,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function Yu({visible:e=!0,canvasSize:t,scene:n,index:r,children:a,frames:i,rect:c,track:l}){const u=(0,s.D)(),[d,f]=o.useState(!1);let m=0;return(0,s.F)((r=>{var o;if((i===1/0||m<=i)&&(l&&(c.current=null==(o=l.current)?void 0:o.getBoundingClientRect()),m++),c.current){const{position:o,isOffscreen:i}=Hu(t,c.current);if(d!==i&&f(i),e&&!d&&c.current){const e=Xu(r,o);r.gl.render(a?r.scene:n,r.camera),qu(r,e)}}}),r),o.useLayoutEffect((()=>{const n=c.current;if(n&&(!e||!d)){const{position:e}=Hu(t,n),r=Xu(u,e);$u(u),qu(u,r)}}),[e,d]),o.useEffect((()=>{if(!l)return;const e=c.current,n=u.get().events.connected;return u.setEvents({connected:l.current}),()=>{if(e){const{position:n}=Hu(t,e),r=Xu(u,n);$u(u),qu(u,r)}u.setEvents({connected:n})}}),[l]),o.useEffect((()=>{Wu(t)}),[]),o.createElement(o.Fragment,null,a,o.createElement("group",{onPointerOver:()=>null}))}const Ku=o.forwardRef((({track:e,visible:t=!0,index:n=1,id:a,style:c,className:l,frames:u=1/0,children:d,...f},m)=>{var h,p,y,g;const v=o.useRef(null),{size:x,scene:w}=(0,s.D)(),[b]=o.useState((()=>new i.Scene)),[E,M]=o.useReducer((()=>!0),!1),z=o.useCallback(((t,n)=>{if(v.current&&e&&e.current&&t.target===e.current){const{width:e,height:r,left:o,top:a}=v.current,i=t.clientX-o,s=t.clientY-a;n.pointer.set(i/e*2-1,-s/r*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)}}),[v,e]);return o.useEffect((()=>{var t;e&&(v.current=null==(t=e.current)?void 0:t.getBoundingClientRect()),M()}),[e]),o.createElement("group",(0,r.A)({ref:m},f),E&&(0,s.h)(o.createElement(Yu,{visible:t,canvasSize:x,frames:u,scene:w,track:e,rect:v,index:n},d),b,{events:{compute:z,priority:n},size:{width:null==(h=v.current)?void 0:h.width,height:null==(p=v.current)?void 0:p.height,top:null==(y=v.current)?void 0:y.top,left:null==(g=v.current)?void 0:g.left}}))})),Zu=o.forwardRef((({as:e="div",id:t,visible:n,className:a,style:i,index:s=1,track:c,frames:l=1/0,children:u,...d},f)=>{const m=o.useId(),h=o.useRef(null);return o.useImperativeHandle(f,(()=>h.current)),o.createElement(o.Fragment,null,o.createElement(e,(0,r.A)({ref:h,id:t,className:a,style:i},d)),o.createElement(Gu.In,null,o.createElement(Ku,{visible:n,key:m,track:h,frames:l,index:s},u)))})),Qu=(()=>{const e=o.forwardRef(((e,t)=>o.useContext(s.g)?o.createElement(Ku,(0,r.A)({ref:t},e)):o.createElement(Zu,(0,r.A)({ref:t},e))));return e.Port=()=>o.createElement(Gu.Out,null),e})(),Ju=o.createContext(null),ed=new i.Vector3,td=new i.Vector3,nd=new i.Vector3(0,1,0),rd=new i.Matrix4,od=({direction:e,axis:t})=>{const{translation:n,translationLimits:r,annotations:a,annotationsClass:c,depthTest:l,scale:u,lineWidth:d,fixed:f,axisColors:m,hoveredColor:h,opacity:p,onDragStart:y,onDrag:v,onDragEnd:x,userData:w}=o.useContext(Ju),b=(0,s.D)((e=>e.controls)),E=o.useRef(null),M=o.useRef(null),z=o.useRef(null),S=o.useRef(0),[T,A]=o.useState(!1),_=o.useCallback((r=>{a&&(E.current.innerText=`${n.current[t].toFixed(2)}`,E.current.style.display="block"),r.stopPropagation();const o=(new i.Matrix4).extractRotation(M.current.matrixWorld),s=r.point.clone(),c=(new i.Vector3).setFromMatrixPosition(M.current.matrixWorld),l=e.clone().applyMatrix4(o).normalize();z.current={clickPoint:s,dir:l},S.current=n.current[t],y({component:"Arrow",axis:t,origin:c,directions:[l]}),b&&(b.enabled=!1),r.target.setPointerCapture(r.pointerId)}),[a,e,b,y,n,t]),D=o.useCallback((e=>{if(e.stopPropagation(),T||A(!0),z.current){const{clickPoint:o,dir:i}=z.current,[s,c]=(null==r?void 0:r[t])||[void 0,void 0];let l=((e,t,n,r)=>{const o=t.dot(t),a=t.dot(e)-t.dot(n),i=t.dot(r);return 0===i?-a/o:(ed.copy(r).multiplyScalar(o/i).sub(t),td.copy(r).multiplyScalar(a/i).add(n).sub(e),-ed.dot(td)/ed.dot(ed))})(o,i,e.ray.origin,e.ray.direction);void 0!==s&&(l=Math.max(l,s-S.current)),void 0!==c&&(l=Math.min(l,c-S.current)),n.current[t]=S.current+l,a&&(E.current.innerText=`${n.current[t].toFixed(2)}`),rd.makeTranslation(i.x*l,i.y*l,i.z*l),v(rd)}}),[a,v,T,n,r,t]),P=o.useCallback((e=>{a&&(E.current.style.display="none"),e.stopPropagation(),z.current=null,x(),b&&(b.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[a,b,x]),C=o.useCallback((e=>{e.stopPropagation(),A(!1)}),[]),{cylinderLength:R,coneWidth:F,coneLength:k,matrixL:B}=o.useMemo((()=>{const t=f?d/u*1.6:u/20,n=f?.2:u/5,r=f?1-n:u-n,o=(new i.Quaternion).setFromUnitVectors(nd,e.clone().normalize());return{cylinderLength:r,coneWidth:t,coneLength:n,matrixL:(new i.Matrix4).makeRotationFromQuaternion(o)}}),[e,u,d,f]),I=T?h:m[t];return o.createElement("group",{ref:M},o.createElement("group",{matrix:B,matrixAutoUpdate:!1,onPointerDown:_,onPointerMove:D,onPointerUp:P,onPointerOut:C},a&&o.createElement(g,{position:[0,-k,0]},o.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:c,ref:E})),o.createElement("mesh",{visible:!1,position:[0,(R+k)/2,0],userData:w},o.createElement("cylinderGeometry",{args:[1.4*F,1.4*F,R+k,8,1]})),o.createElement(me,{transparent:!0,raycast:()=>null,depthTest:l,points:[0,0,0,0,R,0],lineWidth:d,side:i.DoubleSide,color:I,opacity:p,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),o.createElement("mesh",{raycast:()=>null,position:[0,R+k/2,0],renderOrder:500},o.createElement("coneGeometry",{args:[F,k,24,1]}),o.createElement("meshBasicMaterial",{transparent:!0,depthTest:l,color:I,opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},ad=new i.Vector3,id=new i.Vector3,sd=e=>180*e/Math.PI,cd=e=>{let t=((e,t)=>{let n=Math.floor(e/t);return n=n<0?n+1:n,e-n*t})(e,2*Math.PI);return Math.abs(t)<1e-6?0:(t<0&&(t+=2*Math.PI),t)},ld=new i.Matrix4,ud=new i.Vector3,dd=new i.Ray,fd=new i.Vector3,md=({dir1:e,dir2:t,axis:n})=>{const{rotationLimits:r,annotations:a,annotationsClass:c,depthTest:l,scale:u,lineWidth:d,fixed:f,axisColors:m,hoveredColor:h,opacity:p,onDragStart:y,onDrag:v,onDragEnd:x,userData:w}=o.useContext(Ju),b=(0,s.D)((e=>e.controls)),E=o.useRef(null),M=o.useRef(null),z=o.useRef(0),S=o.useRef(0),T=o.useRef(null),[A,_]=o.useState(!1),D=o.useCallback((e=>{a&&(E.current.innerText=`${sd(S.current).toFixed(0)}\xba`,E.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),r=(new i.Vector3).setFromMatrixPosition(M.current.matrixWorld),o=(new i.Vector3).setFromMatrixColumn(M.current.matrixWorld,0).normalize(),s=(new i.Vector3).setFromMatrixColumn(M.current.matrixWorld,1).normalize(),c=(new i.Vector3).setFromMatrixColumn(M.current.matrixWorld,2).normalize(),l=(new i.Plane).setFromNormalAndCoplanarPoint(c,r);T.current={clickPoint:t,origin:r,e1:o,e2:s,normal:c,plane:l},y({component:"Rotator",axis:n,origin:r,directions:[o,s,c]}),b&&(b.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[a,b,y,n]),P=o.useCallback((e=>{if(e.stopPropagation(),A||_(!0),T.current){const{clickPoint:t,origin:o,e1:s,e2:c,normal:l,plane:u}=T.current,[d,f]=(null==r?void 0:r[n])||[void 0,void 0];dd.copy(e.ray),dd.intersectPlane(u,fd),dd.direction.negate(),dd.intersectPlane(u,fd);let m=((e,t,n,r,o)=>{ad.copy(e).sub(n),id.copy(t).sub(n);const a=r.dot(r),i=o.dot(o),s=ad.dot(r)/a,c=ad.dot(o)/i,l=id.dot(r)/a,u=id.dot(o)/i,d=Math.atan2(c,s);return Math.atan2(u,l)-d})(t,fd,o,s,c),h=sd(m);e.shiftKey&&(h=10*Math.round(h/10),m=(e=>e*Math.PI/180)(h)),void 0!==d&&void 0!==f&&f-d<2*Math.PI?(m=cd(m),m=m>Math.PI?m-2*Math.PI:m,m=i.MathUtils.clamp(m,d-z.current,f-z.current),S.current=z.current+m):(S.current=cd(z.current+m),S.current=S.current>Math.PI?S.current-2*Math.PI:S.current),a&&(h=sd(S.current),E.current.innerText=`${h.toFixed(0)}\xba`),ld.makeRotationAxis(l,m),ud.copy(o).applyMatrix4(ld).sub(o).negate(),ld.setPosition(ud),v(ld)}}),[a,v,A,r,n]),C=o.useCallback((e=>{a&&(E.current.style.display="none"),e.stopPropagation(),z.current=S.current,T.current=null,x(),b&&(b.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[a,b,x]),R=o.useCallback((e=>{e.stopPropagation(),_(!1)}),[]),F=o.useMemo((()=>{const n=e.clone().normalize(),r=t.clone().normalize();return(new i.Matrix4).makeBasis(n,r,n.clone().cross(r))}),[e,t]),k=f?.65:.65*u,B=o.useMemo((()=>{const e=[];for(let t=0;t<=32;t++){const n=t*(Math.PI/2)/32;e.push(new i.Vector3(Math.cos(n)*k,Math.sin(n)*k,0))}return e}),[k]);return o.createElement("group",{ref:M,onPointerDown:D,onPointerMove:P,onPointerUp:C,onPointerOut:R,matrix:F,matrixAutoUpdate:!1},a&&o.createElement(g,{position:[k,k,0]},o.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:c,ref:E})),o.createElement(me,{points:B,lineWidth:4*d,visible:!1,userData:w}),o.createElement(me,{transparent:!0,raycast:()=>null,depthTest:l,points:B,lineWidth:d,side:i.DoubleSide,color:A?h:m[n],opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},hd=new i.Ray,pd=new i.Vector3,yd=new i.Matrix4,gd=({dir1:e,dir2:t,axis:n})=>{const{translation:r,translationLimits:a,annotations:c,annotationsClass:l,depthTest:u,scale:d,lineWidth:f,fixed:m,axisColors:h,hoveredColor:p,opacity:y,onDragStart:v,onDrag:x,onDragEnd:w,userData:b}=o.useContext(Ju),E=(0,s.D)((e=>e.controls)),M=o.useRef(null),z=o.useRef(null),S=o.useRef(null),T=o.useRef(0),A=o.useRef(0),[_,D]=o.useState(!1),P=o.useCallback((e=>{c&&(M.current.innerText=`${r.current[(n+1)%3].toFixed(2)}, ${r.current[(n+2)%3].toFixed(2)}`,M.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),o=(new i.Vector3).setFromMatrixPosition(z.current.matrixWorld),a=(new i.Vector3).setFromMatrixColumn(z.current.matrixWorld,0).normalize(),s=(new i.Vector3).setFromMatrixColumn(z.current.matrixWorld,1).normalize(),l=(new i.Vector3).setFromMatrixColumn(z.current.matrixWorld,2).normalize(),u=(new i.Plane).setFromNormalAndCoplanarPoint(l,o);S.current={clickPoint:t,e1:a,e2:s,plane:u},T.current=r.current[(n+1)%3],A.current=r.current[(n+2)%3],v({component:"Slider",axis:n,origin:o,directions:[a,s,l]}),E&&(E.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[c,E,v,n]),C=o.useCallback((e=>{if(e.stopPropagation(),_||D(!0),S.current){const{clickPoint:t,e1:o,e2:i,plane:s}=S.current,[l,u]=(null==a?void 0:a[(n+1)%3])||[void 0,void 0],[d,f]=(null==a?void 0:a[(n+2)%3])||[void 0,void 0];hd.copy(e.ray),hd.intersectPlane(s,pd),hd.direction.negate(),hd.intersectPlane(s,pd),pd.sub(t);let[m,h]=((e,t,n)=>{const r=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,o=[0,1,2].sort(((e,n)=>Math.abs(t.getComponent(n))-Math.abs(t.getComponent(e)))),a=r===o[0]?o[1]:o[0],i=e.getComponent(r),s=e.getComponent(a),c=t.getComponent(r),l=t.getComponent(a),u=n.getComponent(r),d=(n.getComponent(a)-u*(s/i))/(l-c*(s/i));return[(u-d*c)/i,d]})(o,i,pd);void 0!==l&&(m=Math.max(m,l-T.current)),void 0!==u&&(m=Math.min(m,u-T.current)),void 0!==d&&(h=Math.max(h,d-A.current)),void 0!==f&&(h=Math.min(h,f-A.current)),r.current[(n+1)%3]=T.current+m,r.current[(n+2)%3]=A.current+h,c&&(M.current.innerText=`${r.current[(n+1)%3].toFixed(2)}, ${r.current[(n+2)%3].toFixed(2)}`),yd.makeTranslation(m*o.x+h*i.x,m*o.y+h*i.y,m*o.z+h*i.z),x(yd)}}),[c,x,_,r,a,n]),R=o.useCallback((e=>{c&&(M.current.style.display="none"),e.stopPropagation(),S.current=null,w(),E&&(E.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[c,E,w]),F=o.useCallback((e=>{e.stopPropagation(),D(!1)}),[]),k=o.useMemo((()=>{const n=e.clone().normalize(),r=t.clone().normalize();return(new i.Matrix4).makeBasis(n,r,n.clone().cross(r))}),[e,t]),B=m?1/7:d/7,I=m?.225:.225*d,L=_?p:h[n],U=o.useMemo((()=>[new i.Vector3(0,0,0),new i.Vector3(0,I,0),new i.Vector3(I,I,0),new i.Vector3(I,0,0),new i.Vector3(0,0,0)]),[I]);return o.createElement("group",{ref:z,matrix:k,matrixAutoUpdate:!1},c&&o.createElement(g,{position:[0,0,0]},o.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:l,ref:M})),o.createElement("group",{position:[1.7*B,1.7*B,0]},o.createElement("mesh",{visible:!0,onPointerDown:P,onPointerMove:C,onPointerUp:R,onPointerOut:F,scale:I,userData:b},o.createElement("planeGeometry",null),o.createElement("meshBasicMaterial",{transparent:!0,depthTest:u,color:L,polygonOffset:!0,polygonOffsetFactor:-10,side:i.DoubleSide,fog:!1})),o.createElement(me,{position:[-I/2,-I/2,0],transparent:!0,depthTest:u,points:U,lineWidth:f,color:L,opacity:y,polygonOffset:!0,polygonOffsetFactor:-10,userData:b,fog:!1})))},vd=new i.Vector3,xd=new i.Vector3,wd=new i.Vector3(0,1,0),bd=new i.Vector3,Ed=new i.Matrix4,Md=({direction:e,axis:t})=>{const{scaleLimits:n,annotations:r,annotationsClass:a,depthTest:c,scale:l,lineWidth:u,fixed:d,axisColors:f,hoveredColor:m,opacity:h,onDragStart:p,onDrag:y,onDragEnd:v,userData:x}=o.useContext(Ju),w=(0,s.D)((e=>e.size)),b=(0,s.D)((e=>e.controls)),E=o.useRef(null),M=o.useRef(null),z=o.useRef(null),S=o.useRef(1),T=o.useRef(1),A=o.useRef(null),[_,D]=o.useState(!1),P=d?1.2:1.2*l,C=o.useCallback((n=>{r&&(E.current.innerText=`${T.current.toFixed(2)}`,E.current.style.display="block"),n.stopPropagation();const o=(new i.Matrix4).extractRotation(M.current.matrixWorld),a=n.point.clone(),s=(new i.Vector3).setFromMatrixPosition(M.current.matrixWorld),c=e.clone().applyMatrix4(o).normalize(),u=M.current.matrixWorld.clone(),f=u.clone().invert(),m=d?1/ae(M.current.getWorldPosition(vd),l,n.camera,w):1;A.current={clickPoint:a,dir:c,mPLG:u,mPLGInv:f,offsetMultiplier:m},p({component:"Sphere",axis:t,origin:s,directions:[c]}),b&&(b.enabled=!1),n.target.setPointerCapture(n.pointerId)}),[r,b,e,p,t,d,l,w]),R=o.useCallback((e=>{if(e.stopPropagation(),_||D(!0),A.current){const{clickPoint:o,dir:a,mPLG:i,mPLGInv:s,offsetMultiplier:c}=A.current,[u,f]=(null==n?void 0:n[t])||[1e-5,void 0],m=((e,t,n,r)=>{const o=t.dot(t),a=t.dot(e)-t.dot(n),i=t.dot(r);return 0===i?-a/o:(vd.copy(r).multiplyScalar(o/i).sub(t),xd.copy(r).multiplyScalar(a/i).add(n).sub(e),-vd.dot(xd)/vd.dot(vd))})(o,a,e.ray.origin,e.ray.direction),h=m*c,p=d?h:h/l;let g=Math.pow(2,.2*p);e.shiftKey&&(g=Math.round(10*g)/10),g=Math.max(g,u/S.current),void 0!==f&&(g=Math.min(g,f/S.current)),T.current=S.current*g,z.current.position.set(0,P+h,0),r&&(E.current.innerText=`${T.current.toFixed(2)}`),bd.set(1,1,1),bd.setComponent(t,g),Ed.makeScale(bd.x,bd.y,bd.z).premultiply(i).multiply(s),y(Ed)}}),[r,P,y,_,n,t]),F=o.useCallback((e=>{r&&(E.current.style.display="none"),e.stopPropagation(),S.current=T.current,A.current=null,z.current.position.set(0,P,0),v(),b&&(b.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[r,b,v,P]),k=o.useCallback((e=>{e.stopPropagation(),D(!1)}),[]),{radius:B,matrixL:I}=o.useMemo((()=>{const t=d?u/l*1.8:l/22.5,n=(new i.Quaternion).setFromUnitVectors(wd,e.clone().normalize());return{radius:t,matrixL:(new i.Matrix4).makeRotationFromQuaternion(n)}}),[e,l,u,d]),L=_?m:f[t];return o.createElement("group",{ref:M},o.createElement("group",{matrix:I,matrixAutoUpdate:!1,onPointerDown:C,onPointerMove:R,onPointerUp:F,onPointerOut:k},r&&o.createElement(g,{position:[0,P/2,0]},o.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:a,ref:E})),o.createElement("mesh",{ref:z,position:[0,P,0],renderOrder:500,userData:x},o.createElement("sphereGeometry",{args:[B,12,12]}),o.createElement("meshBasicMaterial",{transparent:!0,depthTest:c,color:L,opacity:h,polygonOffset:!0,polygonOffsetFactor:-10}))))},zd=new i.Matrix4,Sd=new i.Matrix4,Td=new i.Matrix4,Ad=new i.Matrix4,_d=new i.Matrix4,Dd=new i.Matrix4,Pd=new i.Matrix4,Cd=new i.Matrix4,Rd=new i.Matrix4,Fd=new i.Box3,kd=new i.Box3,Bd=new i.Vector3,Id=new i.Vector3,Ld=new i.Vector3,Ud=new i.Vector3,Od=new i.Vector3,Nd=new i.Vector3(1,0,0),Vd=new i.Vector3(0,1,0),jd=new i.Vector3(0,0,1),Gd=o.forwardRef((({enabled:e=!0,matrix:t,onDragStart:n,onDrag:a,onDragEnd:c,autoTransform:l=!0,anchor:u,disableAxes:d=!1,disableSliders:f=!1,disableRotations:m=!1,disableScaling:h=!1,activeAxes:p=[!0,!0,!0],offset:y=[0,0,0],rotation:g=[0,0,0],scale:v=1,lineWidth:x=4,fixed:w=!1,translationLimits:b,rotationLimits:E,scaleLimits:M,depthTest:z=!0,axisColors:S=["#ff2060","#20df80","#2080ff"],hoveredColor:T="#ffff40",annotations:A=!1,annotationsClass:_,opacity:D=1,visible:P=!0,userData:C,children:R,...F},k)=>{const B=(0,s.D)((e=>e.invalidate)),I=o.useRef(null),L=o.useRef(null),U=o.useRef(null),O=o.useRef(null),N=o.useRef([0,0,0]),V=o.useRef(new i.Vector3(1,1,1)),j=o.useRef(new i.Vector3(1,1,1));o.useLayoutEffect((()=>{u&&(O.current.updateWorldMatrix(!0,!0),Ad.copy(O.current.matrixWorld).invert(),Fd.makeEmpty(),O.current.traverse((e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),Dd.copy(e.matrixWorld).premultiply(Ad),kd.copy(e.geometry.boundingBox),kd.applyMatrix4(Dd),Fd.union(kd))})),Bd.copy(Fd.max).add(Fd.min).multiplyScalar(.5),Id.copy(Fd.max).sub(Fd.min).multiplyScalar(.5),Ld.copy(Id).multiply(new i.Vector3(...u)).add(Bd),Ud.set(...y).add(Ld),U.current.position.copy(Ud),B())}));const G=o.useMemo((()=>({onDragStart:e=>{zd.copy(L.current.matrix),Sd.copy(L.current.matrixWorld),n&&n(e),B()},onDrag:e=>{Td.copy(I.current.matrixWorld),Ad.copy(Td).invert(),_d.copy(Sd).premultiply(e),Dd.copy(_d).premultiply(Ad),Pd.copy(zd).invert(),Cd.copy(Dd).multiply(Pd),l&&L.current.matrix.copy(Dd),a&&a(Dd,Cd,_d,e),B()},onDragEnd:()=>{c&&c(),B()},translation:N,translationLimits:b,rotationLimits:E,axisColors:S,hoveredColor:T,opacity:D,scale:v,lineWidth:x,fixed:w,depthTest:z,userData:C,annotations:A,annotationsClass:_})),[n,a,c,N,b,E,M,z,v,x,w,...S,T,D,C,l,A,_]),W=new i.Vector3;return(0,s.F)((e=>{if(w){const t=ae(U.current.getWorldPosition(W),v,e.camera,e.size);V.current.setScalar(t)}t&&t instanceof i.Matrix4&&(L.current.matrix=t),L.current.updateWorldMatrix(!0,!0),Rd.makeRotationFromEuler(U.current.rotation).setPosition(U.current.position).premultiply(L.current.matrixWorld),j.current.setFromMatrixScale(Rd),Od.copy(V.current).divide(j.current),(Math.abs(U.current.scale.x-Od.x)>1e-4||Math.abs(U.current.scale.y-Od.y)>1e-4||Math.abs(U.current.scale.z-Od.z)>1e-4)&&(U.current.scale.copy(Od),e.invalidate())})),o.useImperativeHandle(k,(()=>L.current),[]),o.createElement(Ju.Provider,{value:G},o.createElement("group",{ref:I},o.createElement("group",(0,r.A)({ref:L,matrix:t,matrixAutoUpdate:!1},F),o.createElement("group",{visible:P,ref:U,position:y,rotation:g},e&&o.createElement(o.Fragment,null,!d&&p[0]&&o.createElement(od,{axis:0,direction:Nd}),!d&&p[1]&&o.createElement(od,{axis:1,direction:Vd}),!d&&p[2]&&o.createElement(od,{axis:2,direction:jd}),!f&&p[0]&&p[1]&&o.createElement(gd,{axis:2,dir1:Nd,dir2:Vd}),!f&&p[0]&&p[2]&&o.createElement(gd,{axis:1,dir1:jd,dir2:Nd}),!f&&p[2]&&p[1]&&o.createElement(gd,{axis:0,dir1:Vd,dir2:jd}),!m&&p[0]&&p[1]&&o.createElement(md,{axis:2,dir1:Nd,dir2:Vd}),!m&&p[0]&&p[2]&&o.createElement(md,{axis:1,dir1:jd,dir2:Nd}),!m&&p[2]&&p[1]&&o.createElement(md,{axis:0,dir1:Vd,dir2:jd}),!h&&p[0]&&o.createElement(Md,{axis:0,direction:Nd}),!h&&p[1]&&o.createElement(Md,{axis:1,direction:Vd}),!h&&p[2]&&o.createElement(Md,{axis:2,direction:jd}))),o.createElement("group",{ref:O},R))))})),Wd=(0,o.forwardRef)((({options:e={video:!0},...t},n)=>{const a=(0,we.DY)((()=>navigator.mediaDevices.getDisplayMedia(e)),[]);return(0,o.useEffect)((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),(0,we.IU)([])}),[a]),o.createElement(Zn,(0,r.A)({ref:n},t,{src:a}))})),Hd=(0,o.forwardRef)((({constraints:e={audio:!1,video:{facingMode:"user"}},...t},n)=>{const a=(0,we.DY)((()=>navigator.mediaDevices.getUserMedia(e)),[]);return(0,o.useEffect)((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),(0,we.IU)([])}),[a]),o.createElement(Zn,(0,r.A)({ref:n},t,{src:a}))})),Xd=new i.Vector3(0,0,-1),qd=function(){const e=new i.Vector3,t=new i.Vector3,n=new i.Vector3,r=new i.Vector3,o=new i.Vector3;return function(a,i,s,c){return e.copy(a),t.copy(i),n.copy(s),r.copy(t).sub(e),o.copy(n).sub(e),c.crossVectors(o,r).normalize()}}(),$d=o.forwardRef((({points:e=Zd.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:t,facialTransformationMatrix:n,faceBlendshapes:r,offset:a,offsetScalar:c=80,width:l,height:u,depth:d=1,verticalTri:f=[159,386,152],origin:m,eyes:h=!0,eyesAsOrigin:p=!1,debug:y=!1,children:g,...v},x)=>{var w;t&&(e=t.keypoints);const b=o.useRef(null),E=o.useRef(null),M=o.useRef(null),z=o.useRef(null),S=o.useRef(null),T=o.useRef(null),A=o.useRef(null),[_]=o.useState((()=>new i.Vector3)),[D]=o.useState((()=>new i.Object3D)),[P]=o.useState((()=>new i.Quaternion)),[C]=o.useState((()=>new i.Vector3)),{invalidate:R}=(0,s.D)();o.useEffect((()=>{var e;null==(e=S.current)||e.geometry.setIndex(Zd.TRIANGULATION)}),[]);const[F]=o.useState((()=>new i.Vector3));o.useEffect((()=>{var t,o;const i=null==(t=S.current)?void 0:t.geometry;if(!i)return;var s,g;i.setFromPoints(e),i.setDrawRange(0,Zd.TRIANGULATION.length),n?(D.matrix.fromArray(n.data),D.matrix.decompose(D.position,D.quaternion,D.scale),D.rotation.y*=-1,D.rotation.z*=-1,P.setFromEuler(D.rotation),a?(D.position.y*=-1,D.position.z*=-1,null==(s=b.current)||s.position.copy(D.position.divideScalar(c))):null==(g=b.current)||g.position.set(0,0,0)):(qd(e[f[0]],e[f[1]],e[f[2]],_),P.setFromUnitVectors(Xd,_));const v=P.clone().invert();if(i.computeBoundingBox(),y&&R(),i.center(),i.applyQuaternion(v),null==(o=z.current)||o.setRotationFromQuaternion(P),h&&r&&T.current&&A.current&&M.current)if(p){const e=T.current._computeSphere(i),t=A.current._computeSphere(i),n=function(e,t){return e.clone().add(t).multiplyScalar(.5)}(e.center,t.center);m=n.negate(),T.current._update(i,r,e),A.current._update(i,r,t)}else T.current._update(i,r),A.current._update(i,r);if(M.current){if(void 0!==m)if("number"===typeof m){const e=i.getAttribute("position");C.set(-e.getX(m),-e.getY(m),-e.getZ(m))}else m.isVector3&&C.copy(m);else C.setScalar(0);M.current.position.copy(C)}if(E.current){let e=1;(l||u||d)&&(i.boundingBox.getSize(F),l&&(e=l/F.x),u&&(e=u/F.y),d&&(e=d/F.z)),E.current.scale.setScalar(1!==e?e:1)}i.computeVertexNormals(),i.attributes.position.needsUpdate=!0}),[e,n,r,D,a,c,l,u,d,f,m,h,y,R,_,P,F,C]);const k=o.useMemo((()=>({outerRef:z,meshRef:S,eyeRightRef:T,eyeLeftRef:A})),[]);o.useImperativeHandle(x,(()=>k),[k]);const[B]=o.useState((()=>new i.Vector3)),I=null==(w=S.current)?void 0:w.geometry.boundingBox,L=(null==I?void 0:I.getSize(B).z)||1;return o.createElement("group",v,o.createElement("group",{ref:b},o.createElement("group",{ref:z},o.createElement("group",{ref:E},y?o.createElement(o.Fragment,null,o.createElement("axesHelper",{args:[L]}),o.createElement(me,{points:[[0,0,0],[0,0,-L]],color:65535})):null,o.createElement("group",{ref:M},h&&r&&o.createElement("group",{name:"eyes"},o.createElement(Kd,{side:"left",ref:T,debug:y}),o.createElement(Kd,{side:"right",ref:A,debug:y})),o.createElement("mesh",{ref:S,name:"face"},g,y?o.createElement(o.Fragment,null,I&&o.createElement("box3Helper",{args:[I]})):null))))))})),Yd={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},Kd=o.forwardRef((({side:e,debug:t=!0},n)=>{const r=o.useRef(null),a=o.useRef(null),[s]=o.useState((()=>new i.Sphere)),c=o.useCallback((t=>{const n=t.getAttribute("position"),r=Yd.contourLandmarks[e].map((e=>new i.Vector3(n.getX(e),n.getY(e),n.getZ(e))));return s.center.set(0,0,0),r.forEach((e=>s.center.add(e))),s.center.divideScalar(r.length),s.radius=r[0].sub(r[1]).length()/2,s}),[s,e]),[l]=o.useState((()=>new i.Euler)),u=o.useCallback(((t,n,o)=>{var s;if(r.current&&(null!==(s=o)&&void 0!==s||(o=c(t)),r.current.position.copy(o.center),r.current.scale.setScalar(o.radius)),n&&a.current){const t=Yd.blendshapes[e],r=n.categories[t[0]].score,o=n.categories[t[1]].score,s=n.categories[t[2]].score,c=n.categories[t[3]].score,u=Yd.fov.horizontal*i.MathUtils.DEG2RAD*.5*(c-s),d=Yd.fov.vertical*i.MathUtils.DEG2RAD*.5*(r-o)*("left"===e?1:-1);l.set(u,d,0),a.current.setRotationFromEuler(l)}}),[c,e,l]),d=o.useMemo((()=>({eyeMeshRef:r,irisDirRef:a,_computeSphere:c,_update:u})),[c,u]);o.useImperativeHandle(n,(()=>d),[d]);const f=Yd.color[e];return o.createElement("group",null,o.createElement("group",{ref:r},t&&o.createElement("axesHelper",null),o.createElement("group",{ref:a},o.createElement(o.Fragment,null,t&&o.createElement(me,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:f})))))})),Zd={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570312,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507812,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476562},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132812},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664062},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289062,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914062},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164062,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101562,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414062,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-17607348127057776e-21},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757812,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:.0008692514384165406},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:.00028415941051207483},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:.00023347247042693198},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:.0005075141089037061},{x:.5293324589729309,y:.8762547969818115,z:.00039177737198770046},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:.0009666886180639267},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:.0009391739731654525},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:.0007529259892180562},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132812,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:.0008020466193556786},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:.0007630771724507213},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:.000720038078725338},{x:.49988406896591187,y:.6547410488128662,z:.0006949726957827806},{x:.48438939452171326,y:.6392973065376282,z:.000705525919329375},{x:.47143134474754333,y:.6589511632919312,z:.0006980331381782889},{x:.48704618215560913,y:.6752797961235046,z:.0006921177846379578},{x:.6243702173233032,y:.640461802482605,z:-6592126737814397e-20},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:3.4500112633395474e-7,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:4.83789051486383e-7,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:.0009051355300471187,categoryName:"mouthLeft",displayName:""},{index:34,score:.0003630454302765429,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:.00017601238505449146,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:.0009096377179957926,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:.00023205230536404997,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:.00019313619122840464,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:1.08198406678639e-7,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},Qd=(0,o.createContext)({}),Jd={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.17/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}},ef=(0,o.forwardRef)((({basePath:e=Jd.basePath,options:t=Jd.options,children:r},a)=>{const i=JSON.stringify(t),s=(0,we.DY)((async()=>{const{FilesetResolver:r,FaceLandmarker:o}=await n.e("react-three").then(n.bind(n,"z/rp")),a=await r.forVisionTasks(e);return o.createFromOptions(a,t)}),[e,i]);return(0,o.useEffect)((()=>()=>{null==s||s.close(),(0,we.IU)([e,i])}),[s,e,i]),(0,o.useImperativeHandle)(a,(()=>s),[s]),o.createElement(Qd.Provider,{value:s},r)}));function tf(){return(0,o.useContext)(Qd)}function nf(e,t){return e.clone().add(t).multiplyScalar(.5)}function rf(e,t,n){const r=e.localToWorld(t);return n.worldToLocal(r)}const of=(0,o.createContext)({}),af=(0,o.forwardRef)((({camera:e,videoTexture:t={start:!0},manualDetect:n=!1,faceLandmarkerResult:a,manualUpdate:c=!1,makeDefault:l,smoothTime:u=.25,offset:d=!0,offsetScalar:f=80,eyes:m=!1,eyesAsOrigin:h=!0,depth:p=.15,debug:y=!1,facemesh:g},v)=>{var x,w;const b=(0,s.D)((e=>e.scene)),E=(0,s.D)((e=>e.camera)),M=(0,s.D)((e=>e.set)),z=(0,s.D)((e=>e.get)),S=e||E,T=(0,o.useRef)(null),[A]=(0,o.useState)((()=>new i.Object3D)),[_]=(0,o.useState)((()=>new i.Vector3)),[D]=(0,o.useState)((()=>new i.Vector3)),[P]=(0,o.useState)((()=>new i.Vector3)),[C]=(0,o.useState)((()=>new i.Vector3)),R=(0,o.useCallback)((()=>{A.parent=S.parent;const e=T.current;if(e){const{outerRef:t,eyeRightRef:n,eyeLeftRef:r}=e;if(n.current&&r.current){const{irisDirRef:e}=n.current,{irisDirRef:o}=r.current;e.current&&o.current&&t.current&&(_.copy(rf(e.current,new i.Vector3(0,0,0),t.current)),D.copy(rf(o.current,new i.Vector3(0,0,0),t.current)),A.position.copy(rf(t.current,nf(_,D),S.parent||b)),P.copy(rf(e.current,new i.Vector3(0,0,1),t.current)),C.copy(rf(o.current,new i.Vector3(0,0,1),t.current)),A.lookAt(t.current.localToWorld(nf(P,C))))}else t.current&&(A.position.copy(rf(t.current,new i.Vector3(0,0,0),S.parent||b)),A.lookAt(t.current.localToWorld(new i.Vector3(0,0,1))))}return A}),[S,D,C,_,P,b,A]),[F]=(0,o.useState)((()=>new i.Object3D)),k=(0,o.useCallback)((function(e,t){if(S){var n;if(null!==(n=t)&&void 0!==n||(t=R()),u>0){const n=1e-9;B.cz.damp3(F.position,t.position,u,e,void 0,void 0,n),B.cz.dampE(F.rotation,t.rotation,u,e,void 0,void 0,n)}else F.position.copy(t.position),F.rotation.copy(t.rotation);S.position.copy(F.position),S.rotation.copy(F.rotation)}}),[S,R,u,F.position,F.rotation]);(0,s.F)(((e,t)=>{c||k(t)}));const I=(0,o.useRef)(null),[L,U]=(0,o.useState)(),O=tf(),N=(0,o.useCallback)(((e,t)=>{const n=I.current;if(!n)return;const r=n.source.data,o=null==O?void 0:O.detectForVideo(r,e);U(o)}),[O]),V=(0,o.useMemo)((()=>Object.assign(Object.create(i.EventDispatcher.prototype),{computeTarget:R,update:k,facemeshApiRef:T})),[R,k]);(0,o.useImperativeHandle)(v,(()=>V),[V]),(0,o.useEffect)((()=>{if(l){const e=z().controls;return M({controls:V}),()=>M({controls:e})}}),[l,V,z,M]);const j=null!==a&&void 0!==a?a:L,G=null==j?void 0:j.faceLandmarks[0],W=null==j||null==(x=j.facialTransformationMatrixes)?void 0:x[0],H=null==j||null==(w=j.faceBlendshapes)?void 0:w[0],X={onVideoFrame:N,...t};return o.createElement(of.Provider,{value:V},!n&&o.createElement(o.Suspense,{fallback:null},"src"in X?o.createElement(Zn,(0,r.A)({ref:I},X)):o.createElement(Hd,(0,r.A)({ref:I},X))),o.createElement($d,(0,r.A)({ref:T,children:o.createElement("meshNormalMaterial",{side:i.DoubleSide})},g,{points:G,depth:p,facialTransformationMatrix:W,faceBlendshapes:H,eyes:m,eyesAsOrigin:h,offset:d,offsetScalar:f,debug:y,"rotation-z":Math.PI,visible:y})))})),sf=()=>(0,o.useContext)(of)},"z/rp":(e,t,n)=>{n.d(t,{FaceLandmarker:()=>lc,FilesetResolver:()=>Ui});var r="undefined"!=typeof self?self:{};function o(e,t){e:{for(var n=["CLOSURE_FLAGS"],o=r,a=0;a<n.length;a++)if(null==(o=o[n[a]])){n=null;break e}n=o}return null!=(e=n&&n[e])?e:t}function a(){throw Error("Invalid UTF8")}function i(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}let s,c;const l="undefined"!=typeof TextDecoder;let u;const d="undefined"!=typeof TextEncoder;function f(e){if(d)e=(u||=new TextEncoder).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let o=0;o<e.length;o++){var t=e.charCodeAt(o);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&o<e.length){const a=e.charCodeAt(++o);if(a>=56320&&a<=57343){t=1024*(t-55296)+a-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}o--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var m,h=o(610401301,!1),p=o(653718497,o(1,!0)),y=o(660014094,!1);const g=r.navigator;function v(e){return!!h&&!!m&&m.brands.some((({brand:t})=>t&&-1!=t.indexOf(e)))}function x(e){var t;return(t=r.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function w(){return!!h&&!!m&&m.brands.length>0}function b(){return w()?v("Chromium"):(x("Chrome")||x("CriOS"))&&!(!w()&&x("Edge"))||x("Silk")}function E(e){return E[" "](e),e}m=g&&g.userAgentData||null,E[" "]=function(){};var M=!w()&&(x("Trident")||x("MSIE"));!x("Android")||b(),b(),x("Safari")&&(b()||!w()&&x("Coast")||!w()&&x("Opera")||!w()&&x("Edge")||(w()?v("Microsoft Edge"):x("Edg/"))||w()&&v("Opera"));var z={},S=null;function T(){if(!S){S={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;n<5;n++){var r=e.concat(t[n].split(""));z[n]=r;for(var o=0;o<r.length;o++){var a=r[o];void 0===S[a]&&(S[a]=o)}}}}var A="undefined"!=typeof Uint8Array,_=!M&&"function"==typeof btoa;function D(e){if(!_){var t;void 0===t&&(t=0),T(),t=z[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let c=0,l=0;for(;c<e.length-2;c+=3){var o=e[c],a=e[c+1],i=e[c+2],s=t[o>>2];o=t[(3&o)<<4|a>>4],a=t[(15&a)<<2|i>>6],i=t[63&i],n[l++]=s+o+a+i}switch(s=0,i=r,e.length-c){case 2:i=t[(15&(s=e[c+1]))<<2]||r;case 1:e=e[c],n[l]=t[e>>2]+t[(3&e)<<4|s>>4]+i+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const P=/[-_.]/g,C={"-":"+",_:"/",".":"="};function R(e){return C[e]||""}function F(e){if(!_)return function(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),o=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),o=S[n];if(null!=o)return o;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}T();for(var r=0;;){var o=n(-1),a=n(0),i=n(64),s=n(64);if(64===s&&-1===o)break;t(o<<2|a>>4),64!=i&&(t(a<<4&240|i>>2),64!=s&&t(i<<6&192|s))}}(e,(function(e){r[o++]=e})),o!==n?r.subarray(0,o):r}(e);P.test(e)&&(e=e.replace(P,R)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function k(e){return A&&null!=e&&e instanceof Uint8Array}var B={};let I;function L(e){if(e!==B)throw Error("illegal external caller")}function U(){return I||=new N(null,B)}function O(e){L(B);var t=e.ba;return null==(t=null==t||k(t)?t:"string"==typeof t?F(t):null)?t:e.ba=t}var N=class{constructor(e,t){if(L(t),this.ba=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}ua(){return new Uint8Array(O(this)||0)}};function V(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}let j;function G(){const e=Error();V(e,"incident"),function(e){r.setTimeout((()=>{throw e}),0)}(e)}function W(e){return V(e=Error(e),"warning"),e}function H(){return"function"==typeof BigInt}function X(e){return Array.prototype.slice.call(e)}var q="function"==typeof Symbol&&"symbol"==typeof Symbol();function $(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():e}var Y=$(),K=$("0di"),Z=$("2ex"),Q=$("1oa"),J=$("0dg"),ee=q?(e,t)=>{e[Y]|=t}:(e,t)=>{void 0!==e.G?e.G|=t:Object.defineProperties(e,{G:{value:t,configurable:!0,writable:!0,enumerable:!1}})},te=q?(e,t)=>{e[Y]&=~t}:(e,t)=>{void 0!==e.G&&(e.G&=~t)},ne=q?e=>0|e[Y]:e=>0|e.G,re=q?e=>e[Y]:e=>e.G,oe=q?(e,t)=>{e[Y]=t}:(e,t)=>{void 0!==e.G?e.G=t:Object.defineProperties(e,{G:{value:t,configurable:!0,writable:!0,enumerable:!1}})};function ae(e){return ee(e,34),e}function ie(e,t){oe(t,-14591&e)}function se(e,t){oe(t,-14557&e|34)}var ce,le={},ue={};function de(e){return!(!e||"object"!=typeof e||e.La!==ue)}function fe(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function me(e,t,n){if(null!=e)if("string"==typeof e)e=e?new N(e,B):U();else if(e.constructor!==N)if(k(e))e=e.length?new N(n?e:new Uint8Array(e),B):U();else{if(!t)throw Error();e=void 0}return e}function he(e){return!(!Array.isArray(e)||e.length)&&!!(1&ne(e))}const pe=[];function ye(e){if(2&e)throw Error()}oe(pe,55),ce=Object.freeze(pe);class ge{constructor(e,t,n){this.l=0,this.g=e,this.h=t,this.m=n}next(){if(this.l<this.g.length){const e=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,e):e}}return{done:!0,value:void 0}}[Symbol.iterator](){return new ge(this.g,this.h,this.m)}}let ve;function xe(e,t){(t=ve?t[ve]:void 0)&&(e[ve]=X(t))}var we=Object.freeze({});Object.freeze({});var be=Object.freeze({});function Ee(e){return e.Sa=!0,e}var Me=Ee((e=>"number"==typeof e)),ze=Ee((e=>"string"==typeof e)),Se=Ee((e=>"boolean"==typeof e)),Te="function"==typeof r.BigInt&&"bigint"==typeof r.BigInt(0),Ae=Ee((e=>Te?e>=De&&e<=Ce:"-"===e[0]?Re(e,_e):Re(e,Pe)));const _e=Number.MIN_SAFE_INTEGER.toString(),De=Te?BigInt(Number.MIN_SAFE_INTEGER):void 0,Pe=Number.MAX_SAFE_INTEGER.toString(),Ce=Te?BigInt(Number.MAX_SAFE_INTEGER):void 0;function Re(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];if(r>o)return!1;if(r<o)return!0}}const Fe="function"==typeof Uint8Array.prototype.slice;let ke,Be=0,Ie=0;function Le(e){const t=e>>>0;Be=t,Ie=(e-t)/4294967296>>>0}function Ue(e){if(e<0){Le(-e);const[t,n]=He(Be,Ie);Be=t>>>0,Ie=n>>>0}else Le(e)}function Oe(e){const t=ke||=new DataView(new ArrayBuffer(8));t.setFloat32(0,+e,!0),Ie=0,Be=t.getUint32(0,!0)}function Ne(e,t){return 4294967296*t+(e>>>0)}function Ve(e,t){const n=2147483648&t;return n&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=Ne(e,t),n?-e:e}function je(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else H()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+Ge(n)+Ge(e));return n}function Ge(e){return e=String(e),"0000000".slice(e.length)+e}function We(e){if(e.length<16)Ue(Number(e));else if(H())e=BigInt(e),Be=Number(e&BigInt(4294967295))>>>0,Ie=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+("-"===e[0]);Ie=Be=0;const n=e.length;for(let r=t,o=(n-t)%6+t;o<=n;r=o,o+=6){const t=Number(e.slice(r,o));Ie*=1e6,Be=1e6*Be+t,Be>=4294967296&&(Ie+=Math.trunc(Be/4294967296),Ie>>>=0,Be>>>=0)}if(t){const[e,t]=He(Be,Ie);Be=e,Ie=t}}}function He(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function Xe(e){return null==e||"number"==typeof e?e:"NaN"===e||"Infinity"===e||"-Infinity"===e?Number(e):void 0}function qe(e){return null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0}const $e=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Ye(e){const t=typeof e;switch(t){case"bigint":return!0;case"number":return Number.isFinite(e)}return"string"===t&&$e.test(e)}function Ke(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?0|e:void 0}function Ze(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?e>>>0:void 0}function Qe(e){return"-"!==e[0]&&(e.length<20||20===e.length&&Number(e.substring(0,6))<184467)}function Je(e){return e=Math.trunc(e),Number.isSafeInteger(e)||(Ue(e),e=Ve(Be,Ie)),e}function et(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?e.length<20||20===e.length&&Number(e.substring(0,7))>-922337:e.length<19||19===e.length&&Number(e.substring(0,6))<922337))if(We(e),e=Be,2147483648&(t=Ie))if(H())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=He(e,t);e="-"+je(n,r)}else e=je(e,t);return e}function tt(e){return null==e?e:"bigint"==typeof e?(Ae(e)?e=Number(e):(e=BigInt.asIntN(64,e),e=Ae(e)?Number(e):String(e)),e):Ye(e)?"number"==typeof e?Je(e):et(e):void 0}function nt(e){if("string"!=typeof e)throw Error();return e}function rt(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function ot(e){return null==e||"string"==typeof e?e:void 0}function at(e,t,n,r){if(null!=e&&"object"==typeof e&&e.Y===le)return e;if(!Array.isArray(e))return n?2&r?(e=t[K])?t=e:(ae((e=new t).u),t=t[K]=e):t=new t:t=void 0,t;let o=n=ne(e);return 0===o&&(o|=32&r),o|=2&r,o!==n&&oe(e,o),new t(e)}function it(e,t,n){if(t)e:{if(!Ye(t=e))throw W("int64");switch(typeof t){case"string":t=et(t);break e;case"bigint":if(e=t=BigInt.asIntN(64,t),ze(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Me(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Te?BigInt(t):Se(t)?t?"1":"0":ze(t)?t.trim()||"0":String(t);break e;default:t=Je(t)}}else t=tt(e);return"string"==typeof(n=null==(e=t)?n?0:void 0:e)&&(t=+n,Number.isSafeInteger(t))?t:n}function st(e){if(void 0===ut&&(ut="function"==typeof Proxy?vt(Proxy):null),!ut||!gt())return e;let t=ct?.get(e);return t||(Math.random()>.01?e:(function(e){if(void 0===ft){const e=new ut([],{});ft=1===Array.prototype.concat.call([],e).length}ft&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(e[Symbol.isConcatSpreadable]=!0)}(e),t=new ut(e,{set:(e,t,n)=>(G(),e[t]=n,!0)}),function(e,t){(ct||=new dt).set(e,t),(lt||=new dt).set(t,e)}(e,t),t))}let ct,lt,ut,dt,ft,mt,ht,pt,yt;function gt(){return void 0===dt&&(dt="function"==typeof WeakMap?vt(WeakMap):null),dt}function vt(e){try{return-1!==e.toString().indexOf("[native code]")?e:null}catch{return null}}function xt(e,t,n){if(p&&gt()){if(mt?.get(t)?.get(e)){if(n)return}else if(Math.random()>.01)return;var r=e.length;n={length:r};for(var o=0;o<Math.min(r,10);o++){if(r<=10)var a=o;else{a=r/10;const e=Math.floor(o*a);a=e+Math.floor(Math.random()*(Math.floor((o+1)*a)-e))}n[a]=e[a]}bt(e,n)?((o=(r=mt||=new dt).get(t))||(o=new dt,r.set(t,o)),o.set(e,n)):(G(),Mt(e,t))}}function wt(e,t){const n=mt?.get(t)?.get(e);n&&!bt(e,n)&&(G(),Mt(e,t))}function bt(e,t){if(e.length!==t.length)return!1;for(const o in t){var n,r=Number(o);if((n=Number.isInteger(r))&&(n=e[r],r=t[r],n=!(Number.isNaN(n)?Number.isNaN(r):n===r)),n)return!1}return!0}function Et(e){if(e&&mt?.has(e)){var t=e.u;if(t)for(let n=0;n<t.length;n++){const r=t[n];if(n===t.length-1&&fe(r))for(const t in r){const n=r[t];Array.isArray(n)&&wt(n,e)}else Array.isArray(r)&&wt(r,e)}}}function Mt(e,t){mt?.get(t)?.delete(e)}function zt(e,t){return e=St(e,t[0],t[1]),ee(e,16384),e}function St(e,t,n){if(null==e&&(e=ht),ht=void 0,null==e){var r=96;n?(e=[n],r|=512):e=[],t&&(r=-33521665&r|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(r=ne(e)))throw Error("farr");if(64&r)return e;if(r|=64,n&&(r|=512,n!==e[0]))throw Error("mid");e:{const o=(n=e).length;if(o){const e=o-1;if(fe(n[e])){if((t=e-(+!!(512&(r|=256))-1))>=1024)throw Error("pvtlmt");r=-33521665&r|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,o-(+!!(512&r)-1)))>1024)throw Error("spvt");r=-33521665&r|(1023&t)<<15}}}return oe(e,r),e}const Tt={};let At=function(){try{return E(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class _t{constructor(){this.g=new Map}get(e){return this.g.get(e)}set(e,t){return this.g.set(e,t),this.size=this.g.size,this}delete(e){return e=this.g.delete(e),this.size=this.g.size,e}clear(){this.g.clear(),this.size=this.g.size}has(e){return this.g.has(e)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(e,t){return this.g.forEach(e,t)}[Symbol.iterator](){return this.entries()}}const Dt=At?(Object.setPrototypeOf(_t.prototype,Map.prototype),Object.defineProperties(_t.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),_t):class extends Map{constructor(){super()}};function Pt(e){return e}function Ct(e){if(2&e.M)throw Error("Cannot mutate an immutable Map")}var Rt=class extends Dt{constructor(e,t,n=Pt,r=Pt){super();let o=ne(e);o|=64,oe(e,o),this.M=o,this.U=t,this.T=n,this.aa=this.U?Ft:r;for(let a=0;a<e.length;a++){const i=e[a],s=n(i[0],!1,!0);let c=i[1];t?void 0===c&&(c=null):c=r(i[1],!1,!0,void 0,void 0,o),super.set(s,c)}}pa(e=kt){if(0!==this.size)return this.Z(e)}Z(e=kt){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){Ct(this),super.clear()}delete(e){return Ct(this),super.delete(this.T(e,!0,!1))}entries(){var e=this.oa();return new ge(e,Bt,this)}keys(){return this.Ka()}values(){var e=this.oa();return new ge(e,Rt.prototype.get,this)}forEach(e,t){super.forEach(((n,r)=>{e.call(t,this.get(r),r,this)}))}set(e,t){return Ct(this),null==(e=this.T(e,!0,!1))?this:null==t?(super.delete(e),this):super.set(e,this.aa(t,!0,!0,this.U,!1,this.M))}Qa(e){const t=this.T(e[0],!1,!0);e=e[1],e=this.U?void 0===e?null:e:this.aa(e,!1,!0,void 0,!1,this.M),super.set(t,e)}has(e){return super.has(this.T(e,!1,!1))}get(e){e=this.T(e,!1,!1);const t=super.get(e);if(void 0!==t){var n=this.U;return n?((n=this.aa(t,!1,!0,n,this.va,this.M))!==t&&super.set(e,n),n):t}}oa(){return Array.from(super.keys())}Ka(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Ft(e,t,n,r,o,a){return e=at(e,r,n,a),o&&(e=Ht(e)),e}function kt(e){return e}function Bt(e){return[e,this.get(e)]}let It;function Lt(){return It||=new Rt(ae([]),void 0,void 0,void 0,Tt)}function Ut(e,t,n,r,o){if(null!=e){if(Array.isArray(e))e=he(e)?void 0:o&&2&ne(e)?e:Ot(e,t,n,void 0!==r,o);else if(fe(e)){const a={};for(let i in e)a[i]=Ut(e[i],t,n,r,o);e=a}else e=t(e,r);return e}}function Ot(e,t,n,r,o){const a=r||n?ne(e):0;r=r?!!(32&a):void 0;const i=X(e);for(let s=0;s<i.length;s++)i[s]=Ut(i[s],t,n,r,o);return n&&(xe(i,e),n(a,i)),i}function Nt(e){return Ut(e,Vt,void 0,void 0,!1)}function Vt(e){return e.Y===le?e.toJSON():e instanceof Rt?e.pa(Nt):function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"bigint":return Ae(e)?Number(e):String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(he(e))return}else{if(k(e))return D(e);if(e instanceof N){const t=e.ba;return null==t?"":"string"==typeof t?t:e.ba=D(t)}if(e instanceof Rt)return e.pa()}}return e}(e)}function jt(e,t,n=se){if(null!=e){if(A&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=ne(e);return 2&r?e:(t&&=0===r||!!(32&r)&&!(64&r||!(16&r)),t?(oe(e,-12293&r|34),e):Ot(e,jt,4&r?se:n,!0,!0))}return e.Y===le?(n=e.u,e=2&(r=re(n))?e:Gt(e,n,r,!0)):e instanceof Rt&&!(2&e.M)&&(n=ae(e.Z(jt)),e=new Rt(n,e.U,e.T,e.aa)),e}}function Gt(e,t,n,r){return Et(e),e=e.constructor,ht=t=Wt(t,n,r),t=new e(t),ht=void 0,t}function Wt(e,t,n){const r=n||2&t?se:ie,o=!!(32&t);return e=function(e,t,n){const r=X(e);var o=r.length;const a=256&t?r[o-1]:void 0;for(o+=a?-1:0,t=512&t?1:0;t<o;t++)r[t]=n(r[t]);if(a){t=r[t]={};for(const e in a)t[e]=n(a[e])}return xe(r,e),r}(e,t,(e=>jt(e,o,r))),ee(e,32|(n?2:0)),e}function Ht(e){const t=e.u,n=re(t);return 2&n?Gt(e,t,n,!1):e}function Xt(e,t,n,r){return!(4&t)||null!=n&&(!r&&0===n&&(4096&t||8192&t)&&(e.constructor[J]=1+(0|e.constructor[J]))<5&&G(),0!==n&&!(n&t))}function qt(e,t){return Yt(e=e.u,re(e),t)}function $t(e,t,n,r){if(!((t=r+(+!!(512&t)-1))<0||t>=e.length||t>=n))return e[t]}function Yt(e,t,n,r){if(-1===n)return null;const o=t>>15&1023||536870912;if(!(n>=o)){var a=e.length;return r&&256&t&&null!=(r=e[a-1][n])?($t(e,t,o,n)&&null!=Z&&((t=(e=j??={})[Z]||0)>=4||(e[Z]=t+1,G())),r):$t(e,t,o,n)}return 256&t?e[e.length-1][n]:void 0}function Kt(e,t,n){const r=e.u;let o=re(r);return ye(o),Zt(r,o,t,n),e}function Zt(e,t,n,r){const o=t>>15&1023||536870912;if(n>=o){let a,i=t;if(256&t)a=e[e.length-1];else{if(null==r)return i;a=e[o+(+!!(512&t)-1)]={},i|=256}return a[n]=r,n<o&&(e[n+(+!!(512&t)-1)]=void 0),i!==t&&oe(e,i),i}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function Qt(e,t,n,r,o){var a=2&t;o=Yt(e,t,n,o),Array.isArray(o)||(o=ce);const i=!(2&r);r=!(1&r);const s=!!(32&t);let c=ne(o);return 0!==c||!s||a||i?1&c||(c|=1,oe(o,c)):(c|=33,oe(o,c)),a?(e=!1,2&c||(ae(o),e=!!(4&c)),(r||e)&&Object.freeze(o)):(a=!!(2&c)||!!(2048&c),r&&a?(o=X(o),a=1,s&&!i&&(a|=32),oe(o,a),Zt(e,t,n,o)):i&&32&c&&!a&&te(o,32)),o}function Jt(e,t){e=e.u;let n=re(e);const r=Yt(e,n,t),o=Xe(r);return null!=o&&o!==r&&Zt(e,n,t,o),o}function en(e){e=e.u;let t=re(e);const n=Yt(e,t,1),r=me(n,!0,!!(34&t));return null!=r&&r!==n&&Zt(e,t,1,r),r}function tn(){return void 0===we?2:5}function nn(e,t,n,r,o,a){const i=e.u;let s=re(i);r=2&s?1:r,a=!!a,o=rn(i,s,t,o);var c=ne(o),l=o;if(wt(l,e),2!==r&&1!==r||Mt(l,e),Xt(e,c,void 0,a)){4&c&&(o=X(o),c=wn(c,s),s=Zt(i,s,t,o));let e=l=0;for(;l<o.length;l++){const t=n(o[l]);null!=t&&(o[e++]=t)}e<l&&(o.length=e),c=-4097&(c=on(c,s))|20,oe(o,c&=-8193),2&c&&Object.freeze(o)}let u;return 1===r||4===r&&32&c?an(c)||(e=c,(c|=2)!==e&&oe(o,c),Object.freeze(o)):(n=5===r&&(!!(32&c)||an(c)||!!ct?.get(o)),(2===r||n)&&an(c)&&(o=X(o),c=bn(c=wn(c,s),s,a),oe(o,c),s=Zt(i,s,t,o)),an(c)||(t=c,(c=bn(c,s,a))!==t&&oe(o,c)),n?(u=st(o),xt(o,e,!0)):2!==r||a||ct?.delete(o)),u||o}function rn(e,t,n,r){return e=Yt(e,t,n,r),Array.isArray(e)?e:ce}function on(e,t){return 0===e&&(e=wn(e,t)),1|e}function an(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function sn(e){e=X(e);for(let t=0;t<e.length;t++){const n=e[t]=X(e[t]);Array.isArray(n[1])&&(n[1]=ae(n[1]))}return e}function cn(e,t,n,r){e=e.u;let o=re(e);ye(o),Zt(e,o,t,("0"===r?0===Number(n):n===r)?void 0:n)}function ln(e,t){var n=wa;return fn(un(e=e.u),e,re(e),n)===t?t:-1}function un(e){if(q)return e[Q]??(e[Q]=new Map);if(Q in e)return e[Q];const t=new Map;return Object.defineProperty(e,Q,{value:t}),t}function dn(e,t,n,r){const o=un(e),a=fn(o,e,t,n);return a!==r&&(a&&(t=Zt(e,t,a)),o.set(n,r)),t}function fn(e,t,n,r){let o=e.get(r);if(null!=o)return o;o=0;for(let a=0;a<r.length;a++){const e=r[a];null!=Yt(t,n,e)&&(0!==o&&(n=Zt(t,n,o)),o=e)}return e.set(r,o),o}function mn(e,t,n,r){let o,a=re(e);if(null!=(r=Yt(e,a,n,r))&&r.Y===le)return(t=Ht(r))!==r&&Zt(e,a,n,t),t.u;if(Array.isArray(r)){const e=ne(r);o=2&e?Wt(r,e,!1):r,o=zt(o,t)}else o=zt(void 0,t);return o!==r&&Zt(e,a,n,o),o}function hn(e,t,n,r){e=e.u;let o=re(e);return(t=at(r=Yt(e,o,n,r),t,!1,o))!==r&&null!=t&&Zt(e,o,n,t),t}function pn(e,t,n,r=!1){if(null==(t=hn(e,t,n,r)))return t;if(e=e.u,!(2&(r=re(e)))){const o=Ht(t);o!==t&&Zt(e,r,n,t=o)}return t}function yn(e,t,n,r,o,a,i){const s=e.u;var c=!!(2&t);o=c?1:o,a=!!a,i&&=!c,c=rn(s,t,r);var l=ne(c),u=c;if(wt(u,e),2!==o&&1!==o||Mt(u,e),!(u=!!(4&l))){var d=c,f=t;const e=!!(2&(l=on(l,t)));e&&(f|=2);let r=!e,o=!0,a=0,i=0;for(;a<d.length;a++){const t=at(d[a],n,!1,f);if(t instanceof n){if(!e){const e=!!(2&ne(t.u));r&&=!e,o&&=e}d[i++]=t}}i<a&&(d.length=i),l|=4,l=o?16|l:-17&l,oe(d,l=r?8|l:-9&l),e&&Object.freeze(d)}if(i&&!(8&l||!c.length&&(1===o||4===o&&32&l))){for(an(l)?(c=X(c),l=wn(l,t),t=Zt(s,t,r,c)):Mt(c,e),n=c,i=l,d=0;d<n.length;d++)(l=n[d])!==(f=Ht(l))&&(n[d]=f);i|=8,i=n.length?-17&i:16|i,oe(n,i),l=i}let m;return 1===o||4===o&&32&l?an(l)||(e=l,(l|=!c.length||16&l&&(!u||32&l)?2:2048)!==e&&oe(c,l),Object.freeze(c)):(u=5===o&&(!!(32&l)||an(l)||!!ct?.get(c)),(2===o||u)&&an(l)&&(c=X(c),l=bn(l=wn(l,t),t,a),oe(c,l),t=Zt(s,t,r,c)),an(l)||(r=l,(l=bn(l,t,a))!==r&&oe(c,l)),u?(m=st(c),xt(c,e,!0)):2!==o||a||ct?.delete(c)),m||c}function gn(e,t,n){const r=re(e.u);return yn(e,r,t,n,tn(),!1,!(2&r))}function vn(e,t,n,r){return null==r&&(r=void 0),Kt(e,n,r)}function xn(e,t,n,r){null==r&&(r=void 0);e:{e=e.u;let o=re(e);if(ye(o),null==r){const r=un(e);if(fn(r,e,o,n)!==t)break e;r.set(n,0)}else o=dn(e,o,n,t);Zt(e,o,t,r)}}function wn(e,t){return-2049&(2&t?2|e:-3&e)|32}function bn(e,t,n){return 32&t&&n||(e&=-33),e}function En(e,t,n,r){const o=re(e.u);ye(o),e=yn(e,o,n,t,2,!0),n=null!=r?r:new n,e.push(n),2&ne(n.u)?te(e,8):te(e,16)}function Mn(e,t){return e??t}function zn(e,t){return Ke(qt(e,t))}function Sn(e,t){return Mn(Jt(e,t),0)}function Tn(e,t){return Mn(ot(qt(e,t)),"")}function An(e,t,n){if(null!=n&&"boolean"!=typeof n)throw e=typeof n,Error(`Expected boolean but got ${"object"!=e?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);Kt(e,t,n)}function _n(e,t,n){if(null!=n){if("number"!=typeof n)throw W("int32");if(!Number.isFinite(n))throw W("int32");n|=0}Kt(e,t,n)}function Dn(e,t,n){if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);Kt(e,t,n)}function Pn(e,t,n){{const s=e.u;let c=re(s);if(ye(c),null==n)Zt(s,c,t);else{n=lt?.get(n)||n;var r,o=ne(n),a=o,i=!!(2&o)||Object.isFrozen(n);if((r=!i)&&(r=void 0===be||!1),Xt(e,o)){o=21,i&&(n=X(n),a=0,o=bn(o=wn(o,c),c,!0));for(let e=0;e<n.length;e++)n[e]=nt(n[e])}r?(n=X(n),a=0,o=bn(o=wn(o,c),c,!0)):i||xt(n,e),o!==a&&oe(n,o),Zt(s,c,t,n)}}}function Cn(e,t,n){ye(re(e.u)),nn(e,t,ot,2,void 0,!0).push(nt(n))}function Rn(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Fn(){return Error("Failed to read varint, encoding is invalid.")}function kn(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Bn(e){if("string"==typeof e)return{buffer:F(e),O:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),O:!1};if(e.constructor===Uint8Array)return{buffer:e,O:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),O:!1};if(e.constructor===N)return{buffer:O(e)||new Uint8Array(0),O:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),O:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function In(e,t){let n,r=0,o=0,a=0;const i=e.h;let s=e.g;do{n=i[s++],r|=(127&n)<<a,a+=7}while(a<32&&128&n);for(a>32&&(o|=(127&n)>>4),a=3;a<32&&128&n;a+=7)n=i[s++],o|=(127&n)<<a;if(Wn(e,s),n<128)return t(r>>>0,o>>>0);throw Fn()}function Ln(e){let t=0,n=e.g;const r=n+10,o=e.h;for(;n<r;){const r=o[n++];if(t|=r,0==(128&r))return Wn(e,n),!!(127&t)}throw Fn()}function Un(e){const t=e.h;let n=e.g,r=t[n++],o=127&r;if(128&r&&(r=t[n++],o|=(127&r)<<7,128&r&&(r=t[n++],o|=(127&r)<<14,128&r&&(r=t[n++],o|=(127&r)<<21,128&r&&(r=t[n++],o|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Fn();return Wn(e,n),o}function On(e){return Un(e)>>>0}function Nn(e){var t=e.h;const n=e.g,r=t[n],o=t[n+1],a=t[n+2];return t=t[n+3],Wn(e,e.g+4),(r|o<<8|a<<16|t<<24)>>>0}function Vn(e){var t=Nn(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,255==n?t?NaN:e*(1/0):0==n?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function jn(e){return Un(e)}function Gn(e,t,{ea:n=!1}={}){e.ea=n,t&&(t=Bn(t),e.h=t.buffer,e.m=t.O,e.j=0,e.l=e.h.length,e.g=e.j)}function Wn(e,t){if(e.g=t,t>e.l)throw kn(e.l,t)}function Hn(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw kn(t,e.l-n);return e.g=r,n}function Xn(e,t){if(0==t)return U();var n=Hn(e,t);return e.ea&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Fe?e.slice(n,t):new Uint8Array(e.subarray(n,t))),0==n.length?U():new N(n,B)}Rt.prototype.toJSON=void 0,Rt.prototype.La=ue;var qn=[];function $n(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=On(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Rn(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function Yn(e){switch(e.h){case 0:0!=e.h?Yn(e):Ln(e.g);break;case 1:Wn(e=e.g,e.g+8);break;case 2:if(2!=e.h)Yn(e);else{var t=On(e.g);Wn(e=e.g,e.g+t)}break;case 5:Wn(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!$n(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.h){if(e.m!=t)throw Error("Unmatched end-group tag");break}Yn(e)}break;default:throw Rn(e.h,e.l)}}function Kn(e,t,n){const r=e.g.l,o=On(e.g),a=e.g.g+o;let i=a-r;if(i<=0&&(e.g.l=a,n(t,e,void 0,void 0,void 0),i=a-e.g.g),i)throw Error(`Message parsing ended unexpectedly. Expected to read ${o} bytes, instead read ${o-i} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=a,e.g.l=r,t}function Zn(e){var t=On(e.g),n=Hn(e=e.g,t);if(e=e.h,l){var r,o=e;(r=c)||(r=c=new TextDecoder("utf-8",{fatal:!0})),t=n+t,o=0===n&&t===o.length?o:o.subarray(n,t);try{var u=r.decode(o)}catch(e){if(void 0===s){try{r.decode(new Uint8Array([128]))}catch(e){}try{r.decode(new Uint8Array([97])),s=!0}catch(e){s=!1}}throw!s&&(c=void 0),e}}else{t=(u=n)+t,n=[];let s,c=null;for(;u<t;){var d=e[u++];d<128?n.push(d):d<224?u>=t?a():(s=e[u++],d<194||128!=(192&s)?(u--,a()):n.push((31&d)<<6|63&s)):d<240?u>=t-1?a():(s=e[u++],128!=(192&s)||224===d&&s<160||237===d&&s>=160||128!=(192&(r=e[u++]))?(u--,a()):n.push((15&d)<<12|(63&s)<<6|63&r)):d<=244?u>=t-2?a():(s=e[u++],128!=(192&s)||s-144+(d<<28)>>30!=0||128!=(192&(r=e[u++]))||128!=(192&(o=e[u++]))?(u--,a()):(d=(7&d)<<18|(63&s)<<12|(63&r)<<6|63&o,d-=65536,n.push(55296+(d>>10&1023),56320+(1023&d)))):a(),n.length>=8192&&(c=i(c,n),n.length=0)}u=i(c,n)}return u}function Qn(e){const t=On(e.g);return Xn(e.g,t)}function Jn(e,t,n){var r=On(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var er=[];let tr;function nr(e,t,n){t.g?t.m(e,t.g,t.h,n,!0):t.m(e,t.h,n,!0)}var rr=class{constructor(e,t){this.u=St(e,t)}toJSON(){return or(this)}l(){var e=wi;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return Gt(this,e,re(e),!1)}O(){return!!(2&ne(this.u))}};function or(e){Et(e),e=tr?e.u:Ot(e.u,Vt,void 0,void 0,!1);{var t=!tr;let l=e.length;if(l){var n=e[l-1],r=fe(n);r?l--:n=void 0;var o=e;if(r){e:{var a,i=n,s=!1;if(i)for(let e in i)isNaN(+e)?(a??={})[e]=i[e]:(r=i[e],Array.isArray(r)&&(he(r)||de(r)&&0===r.size)&&(r=null),null==r&&(s=!0),null!=r&&((a??={})[e]=r));if(s||(a=i),a)for(let e in a){s=a;break e}s=null}i=null==s?null!=n:s!==n}for(;l>0&&(null==(a=o[l-1])||he(a)||de(a)&&0===a.size);l--)var c=!0;(o!==e||i||c)&&(t?(c||i||s)&&(o.length=l):o=Array.prototype.slice.call(o,0,l),s&&o.push(s)),c=o}else c=e}return c}function ar(e){return e?/^\d+$/.test(e)?(We(e),new ir(Be,Ie)):null:sr||=new ir(0,0)}rr.prototype.Y=le,rr.prototype.toString=function(){try{return tr=!0,or(this).toString()}finally{tr=!1}};var ir=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let sr;function cr(e){return e?/^-?\d+$/.test(e)?(We(e),new lr(Be,Ie)):null:ur||=new lr(0,0)}var lr=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let ur;function dr(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function fr(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function mr(e,t){if(t>=0)fr(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function hr(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function pr(e,t){0!==t.length&&(e.l.push(t),e.h+=t.length)}function yr(e,t,n){fr(e.g,8*t+n)}function gr(e,t){return yr(e,t,2),t=e.g.end(),pr(e,t),t.push(e.h),t}function vr(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function xr(e,t,n){yr(e,t,2),fr(e.g,n.length),pr(e,e.g.end()),pr(e,n)}function wr(e,t,n,r){null!=n&&(t=gr(e,t),r(n,e),vr(e,t))}class br{constructor(e,t,n){this.g=e,this.h=t,this.qa=n}}function Er(e){return Array.isArray(e)?e[0]instanceof br?e:[go,e]:[e,void 0]}function Mr(e,t){if(Array.isArray(t)){var n=ne(t);if(4&n)return t;for(var r=0,o=0;r<t.length;r++){const n=e(t[r]);null!=n&&(t[o++]=n)}return o<r&&(t.length=o),oe(t,-12289&n|5),2&n&&Object.freeze(t),t}}const zr=Symbol();function Sr(e){let t=e[zr];if(!t){const n=Ur(e),r=n.h;t=r?(e,t)=>r(e,t,n):(e,t)=>{for(;$n(t)&&4!=t.h;){var r=t.m;let i=n[r];const s=!i;let c=!1;if(!i){var o=n.X;if(o){var a=o[r];a&&(c=o.P?.[r],(!y||c)&&(o=Tr(a))&&(i=n[r]=o))}}i&&i(t,e,r)||(r=(o=t).l,Yn(o),o.ja?o=void 0:(a=o.g.g-r,o.g.g=r,o=Xn(o.g,a)),r=e,o&&(ve||=Symbol(),(a=r[ve])?a.push(o):r[ve]=[o])),s&&i&&!c&&Xr++<5&&G()}},e[zr]=t}return t}function Tr(e){const t=(e=Er(e))[0].g;if(e=e[1]){const n=Sr(e),r=Ur(e).g;return(e,o,a)=>t(e,o,a,r,n)}return t}function Ar(e,t,n){e[t]=n}function _r(e,t,n,r){var o=Ar;t.g=function(e){switch(typeof e){case"boolean":return pt||=[0,void 0,!0];case"number":return e>0?void 0:0===e?yt||=[0,void 0]:[-e,void 0];case"string":return[0,e];case"object":return e}}(e[0]);let a=0;var i=e[++a];i&&i.constructor===Object&&(t.X=i,"function"==typeof(i=e[++a])&&(t.h=i,t.l=e[++a],i=e[++a]));const s={};for(;Array.isArray(i)&&"number"==typeof i[0]&&i[0]>0;){for(var c=0;c<i.length;c++)s[i[c]]=i;i=e[++a]}for(c=1;void 0!==i;){let d;"number"==typeof i&&(c+=i,i=e[++a]);var l=void 0;if(i instanceof br?d=i:(d=vo,a--),d.qa){i=e[++a],l=e;var u=a;"function"==typeof i&&(i=i(),l[u]=i),l=i}for(u=c+1,"number"==typeof(i=e[++a])&&i<0&&(u-=i,i=e[++a]);c<u;c++){const e=s[c];o(t,c,l?r(d,l,e):n(d,e))}}return t}const Dr=Symbol();function Pr(e){let t=e[Dr];if(!t){const n=kr(e);t=(e,t)=>Nr(e,t,n),e[Dr]=t}return t}const Cr=Symbol();function Rr(e){return e.h}function Fr(e,t){let n,r;const o=e.h;return(e,a,i)=>o(e,a,i,r||=kr(t).g,n||=Pr(t))}function kr(e){return e[Cr]||_r(e,e[Cr]={},Rr,Fr)}const Br=Symbol();function Ir(e,t){const n=e.g;return t?(e,r,o)=>n(e,r,o,t):n}function Lr(e,t,n){const r=e.g;let o,a;return(e,i,s)=>r(e,i,s,a||=Ur(t).g,o||=Sr(t),n)}function Ur(e){return e[Br]||_r(e,e[Br]={},Ir,Lr)}function Or(e,t){var n=e[t];if(n)return n;if(n=e.X){var r=n[t];if(r){var o=(r=Er(r))[0].h;if(r=r[1],n=n.P?.[t],!y||n){if(r){const t=Pr(r),a=kr(r).g;n=(n=e.l)?n(a,t):(e,n,r)=>o(e,n,r,a,t)}else n=o;return e[t]=n}}}}function Nr(e,t,n){for(var r=re(e),o=+!!(512&r)-1,a=e.length,i=512&r?1:0,s=a+(256&r?-1:0);i<s;i++){const r=e[i];if(null==r)continue;const a=i-o,s=Or(n,a);if(!s)continue;const c=n.X;c?.[a]&&!c?.P?.[a]&&Xr++<5&&G(),s(t,r,a)}if(256&r){r=e[a-1];for(let e in r)o=+e,!Number.isNaN(o)&&null!=(a=r[e])&&(s=Or(n,o))&&((i=n.X)?.[o]&&!i?.P?.[o]&&Xr++<5&&G(),s(t,a,o))}if(e=ve?e[ve]:void 0)for(pr(t,t.g.end()),n=0;n<e.length;n++)pr(t,O(e[n])||new Uint8Array(0))}function Vr(e,t){return new br(e,t,!1)}function jr(e,t){return new br(e,t,!1)}function Gr(e,t){return new br(e,t,!0)}function Wr(e,t,n){Zt(e,re(e),t,n)}var Hr=Gr((function(e,t,n,r,o){return 2===e.h&&(e=Kn(e,zt([void 0,void 0],r),o),ye(r=re(t)),(o=Yt(t,r,n))instanceof Rt?0!=(2&o.M)?((o=o.Z()).push(e),Zt(t,r,n,o)):o.Qa(e):Array.isArray(o)?(2&ne(o)&&Zt(t,r,n,o=sn(o)),o.push(e)):Zt(t,r,n,[e]),!0)}),(function(e,t,n,r,o){if(t instanceof Rt)t.forEach(((t,a)=>{wr(e,n,zt([a,t],r),o)}));else if(Array.isArray(t))for(let a=0;a<t.length;a++){const i=t[a];Array.isArray(i)&&wr(e,n,zt(i,r),o)}}));let Xr=0;function qr(e,t,n){if(t=function(e){if(null==e)return e;const t=typeof e;if("bigint"===t)return String(BigInt.asIntN(64,e));if(Ye(e)){if("string"===t)return et(e);if("number"===t)return Je(e)}}(t),null!=t&&("string"==typeof t&&cr(t),null!=t))switch(yr(e,n,0),typeof t){case"number":e=e.g,Ue(t),dr(e,Be,Ie);break;case"bigint":n=BigInt.asUintN(64,t),n=new lr(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),dr(e.g,n.h,n.g);break;default:n=cr(t),dr(e.g,n.h,n.g)}}function $r(e,t,n){null!=(t=Ke(t))&&null!=t&&(yr(e,n,0),mr(e.g,t))}function Yr(e,t,n){null!=(t=qe(t))&&(yr(e,n,0),e.g.g.push(t?1:0))}function Kr(e,t,n){null!=(t=ot(t))&&xr(e,n,f(t))}function Zr(e,t,n,r,o){t instanceof rr?(Et(t),t=t.u):t=Array.isArray(t)?zt(t,r):void 0,wr(e,n,t,o)}function Qr(e,t,n){null!=(t=null==t||"string"==typeof t||k(t)||t instanceof N?t:void 0)&&xr(e,n,Bn(t).buffer)}function Jr(e,t,n){return(5===e.h||2===e.h)&&(t=Qt(t,re(t),n,2,!1),2==e.h?Jn(e,Vn,t):t.push(Vn(e.g)),!0)}var eo,to=Vr((function(e,t,n){if(1!==e.h)return!1;var r=e.g;e=Nn(r);const o=Nn(r);r=2*(o>>31)+1;const a=o>>>20&2047;return e=4294967296*(1048575&o)+e,Wr(t,n,2047==a?e?NaN:r*(1/0):0==a?5e-324*r*e:r*Math.pow(2,a-1075)*(e+4503599627370496)),!0}),(function(e,t,n){null!=(t=Xe(t))&&(yr(e,n,1),e=e.g,(n=ke||=new DataView(new ArrayBuffer(8))).setFloat64(0,+t,!0),Be=n.getUint32(0,!0),Ie=n.getUint32(4,!0),hr(e,Be),hr(e,Ie))})),no=Vr((function(e,t,n){return 5===e.h&&(Wr(t,n,Vn(e.g)),!0)}),(function(e,t,n){null!=(t=Xe(t))&&(yr(e,n,5),e=e.g,Oe(t),hr(e,Be))})),ro=jr(Jr,(function(e,t,n){if(null!=(t=Mr(Xe,t)))for(let i=0;i<t.length;i++){var r=e,o=n,a=t[i];null!=a&&(yr(r,o,5),r=r.g,Oe(a),hr(r,Be))}})),oo=jr(Jr,(function(e,t,n){if(null!=(t=Mr(Xe,t))&&t.length){yr(e,n,2),fr(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Oe(t[r]),hr(n,Be)}})),ao=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,In(e.g,Ve)),!0)}),qr),io=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,0===(e=In(e.g,Ve))?void 0:e),!0)}),qr),so=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,In(e.g,Ne)),!0)}),(function(e,t,n){if(null!=(t=function(e){if(null==e)return e;var t=typeof e;if("bigint"===t)return String(BigInt.asUintN(64,e));if(Ye(e)){if("string"===t)return t=Math.trunc(Number(e)),Number.isSafeInteger(t)&&t>=0?e=String(t):(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),Qe(e)||(We(e),e=je(Be,Ie))),e;if("number"===t)return(e=Math.trunc(e))>=0&&Number.isSafeInteger(e)?e:function(e){if(e<0){Ue(e);const t=je(Be,Ie);return e=Number(t),Number.isSafeInteger(e)?e:t}return Qe(String(e))?e:(Ue(e),Ne(Be,Ie))}(e)}}(t))&&("string"==typeof t&&ar(t),null!=t))switch(yr(e,n,0),typeof t){case"number":e=e.g,Ue(t),dr(e,Be,Ie);break;case"bigint":n=BigInt.asUintN(64,t),n=new ir(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),dr(e.g,n.h,n.g);break;default:n=ar(t),dr(e.g,n.h,n.g)}})),co=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,Un(e.g)),!0)}),$r),lo=jr((function(e,t,n){return(0===e.h||2===e.h)&&(t=Qt(t,re(t),n,2,!1),2==e.h?Jn(e,Un,t):t.push(Un(e.g)),!0)}),(function(e,t,n){if(null!=(t=Mr(Ke,t))&&t.length){n=gr(e,n);for(let n=0;n<t.length;n++)mr(e.g,t[n]);vr(e,n)}})),uo=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,0===(e=Un(e.g))?void 0:e),!0)}),$r),fo=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,Ln(e.g)),!0)}),Yr),mo=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,!1===(e=Ln(e.g))?void 0:e),!0)}),Yr),ho=jr((function(e,t,n){if(2!==e.h)return!1;e=Zn(e);const r=re(t);return ye(r),Qt(t,r,n,2).push(e),!0}),(function(e,t,n){if(null!=(t=Mr(ot,t)))for(let i=0;i<t.length;i++){var r=e,o=n,a=t[i];null!=a&&xr(r,o,f(a))}})),po=Vr((function(e,t,n){return 2===e.h&&(Wr(t,n,""===(e=Zn(e))?void 0:e),!0)}),Kr),yo=Vr((function(e,t,n){return 2===e.h&&(Wr(t,n,Zn(e)),!0)}),Kr),go=Gr((function(e,t,n,r,o){return 2===e.h&&(Kn(e,mn(t,r,n,!0),o),!0)}),Zr),vo=Gr((function(e,t,n,r,o){return 2===e.h&&(Kn(e,mn(t,r,n),o),!0)}),Zr);eo=new br((function(e,t,n,r,o){if(2!==e.h)return!1;r=zt(void 0,r);let a=re(t);ye(a);let i=Qt(t,a,n,3);return a=re(t),4&ne(i)&&(i=X(i),oe(i,-2079&ne(i)|1),Zt(t,a,n,i)),i.push(r),Kn(e,r,o),!0}),(function(e,t,n,r,o){if(Array.isArray(t))for(let a=0;a<t.length;a++)Zr(e,t[a],n,r,o)}),!0);var xo=Gr((function(e,t,n,r,o,a){return 2===e.h&&(dn(t,re(t),a,n),Kn(e,t=mn(t,r,n),o),!0)}),Zr),wo=Vr((function(e,t,n){return 2===e.h&&(Wr(t,n,Qn(e)),!0)}),Qr),bo=jr((function(e,t,n){return(0===e.h||2===e.h)&&(t=Qt(t,re(t),n,2,!1),2==e.h?Jn(e,On,t):t.push(On(e.g)),!0)}),(function(e,t,n){if(null!=(t=Mr(Ze,t)))for(let i=0;i<t.length;i++){var r=e,o=n,a=t[i];null!=a&&(yr(r,o,0),fr(r.g,a))}})),Eo=Vr((function(e,t,n){return 0===e.h&&(Wr(t,n,Un(e.g)),!0)}),(function(e,t,n){null!=(t=Ke(t))&&(t=parseInt(t,10),yr(e,n,0),mr(e.g,t))}));class Mo{constructor(e,t){this.h=e,this.g=t,this.l=pn,this.m=vn,this.defaultValue=void 0}}function zo(e,t){return new Mo(e,t)}function So(e,t){return(n,r)=>{if(er.length){const e=er.pop();e.o(r),Gn(e.g,n,r),n=e}else n=new class{constructor(e,t){if(qn.length){const n=qn.pop();Gn(n,e,t),e=n}else e=new class{constructor(e,t){this.h=null,this.m=!1,this.g=this.l=this.j=0,Gn(this,e,t)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ea=!1}}(e,t);this.g=e,this.l=this.g.g,this.h=this.m=-1,this.o(t)}o({ja:e=!1}={}){this.ja=e}}(n,r);try{const r=new e,a=r.u;Sr(t)(a,n);var o=r}finally{n.g.clear(),n.m=-1,n.h=-1,er.length<100&&er.push(n)}return o}}function To(e){return function(){Et(this);const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const e=this.g;return this.g=[],e}}}};Nr(this.u,t,kr(e)),pr(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,o=r.length;let a=0;for(let e=0;e<o;e++){const t=r[e];n.set(t,a),a+=t.length}return t.l=[n],n}}var Ao=class extends rr{constructor(e){super(e)}},_o=[0,po,Vr((function(e,t,n){return 2===e.h&&(Wr(t,n,(e=Qn(e))===U()?void 0:e),!0)}),(function(e,t,n){if(null!=t){if(t instanceof rr){const r=t.Ta;return void(r&&(t=r(t),null!=t&&xr(e,n,Bn(t).buffer)))}if(Array.isArray(t))return}Qr(e,t,n)}))],Do=[0,co,Eo,fo,-1,lo,Eo,-1],Po=class extends rr{constructor(){super()}},Co=[0,fo,yo,fo,Eo,-1,jr((function(e,t,n){return(0===e.h||2===e.h)&&(t=Qt(t,re(t),n,2,!1),2==e.h?Jn(e,jn,t):t.push(Un(e.g)),!0)}),(function(e,t,n){if(null!=(t=Mr(Ke,t))&&t.length){n=gr(e,n);for(let n=0;n<t.length;n++)mr(e.g,t[n]);vr(e,n)}})),yo,-1,[0,fo,-1],Eo,fo,-1],Ro=[0,yo,-2],Fo=class extends rr{constructor(){super()}},ko=[0],Bo=[0,co,fo,1,fo,-3],Io=[0,yo,fo,-1,co,[0,[1,2,3,4,5,6,7],xo,ko,xo,Co,xo,Ro,xo,Bo,xo,Do,xo,[0,yo,-2],xo,[0,yo,Eo]],[0,yo],fo,[0,[1,3],[2,4],xo,[0,lo],-1,xo,[0,ho],-1,eo,[0,yo,-1]],yo],Lo=class extends rr{constructor(e){super(e,2)}},Uo={},Oo=Uo.P={};Uo[336783863]=Io,Oo[336783863]=1;var No=[0,io,-1,mo,-3,io,lo,po,uo,io,-1,mo,uo,mo,-2,po];function Vo(e,t){cn(e,2,rt(t),"")}function jo(e,t){Cn(e,3,t)}function Go(e,t){Cn(e,4,t)}var Wo=class extends rr{constructor(e){super(e,500)}o(e){return vn(this,0,7,e)}},Ho=[-1,{P:{}}],Xo=[0,yo,1,Ho],qo=[0,yo,ho,Ho];function $o(e,t){En(e,1,Wo,t)}function Yo(e,t){Cn(e,10,t)}function Ko(e,t){Cn(e,15,t)}var Zo=class extends rr{constructor(e){super(e,500)}o(e){return vn(this,0,1001,e)}},Qo=[-500,eo,[-500,po,-1,ho,-3,[-2,Uo,fo],eo,_o,uo,-1,Xo,qo,eo,[0,po,mo],po,No,uo,ho,987,ho],4,eo,[-500,yo,-1,[-1,{P:{}}],998,yo],eo,[-500,yo,ho,-1,[-2,{P:{}},fo],997,ho,-1],uo,eo,[-500,yo,ho,Ho,998,ho],ho,uo,Xo,qo,eo,[0,po,-1,Ho],ho,-2,No,po,-1,mo,979,Ho,eo,_o];Zo.prototype.g=To(Qo);var Jo=So(Zo,Qo),ea=class extends rr{constructor(e){super(e)}},ta=class extends rr{constructor(e){super(e)}g(){return gn(this,ea,1)}},na=[0,eo,[0,co,no,yo,-1]],ra=So(ta,na),oa=class extends rr{constructor(e){super(e)}},aa=class extends rr{constructor(e){super(e)}},ia=class extends rr{constructor(e){super(e)}h(){return pn(this,oa,2)}g(){return gn(this,aa,5)}},sa=So(class extends rr{constructor(e){super(e)}},[0,ho,lo,oo,[0,Eo,[0,co,-3],[0,no,-3],[0,co,-1,[0,eo,[0,co,-2]]],eo,[0,no,-1,yo,no]],yo,-1,ao,eo,[0,co,no],ho,ao]),ca=class extends rr{constructor(e){super(e)}},la=So(class extends rr{constructor(e){super(e)}},[0,eo,[0,no,-4]]),ua=class extends rr{constructor(e){super(e)}},da=So(class extends rr{constructor(e){super(e)}},[0,eo,[0,no,-4]]),fa=class extends rr{constructor(e){super(e)}},ma=[0,co,-1,oo,Eo],ha=class extends rr{constructor(){super()}};ha.prototype.g=To([0,no,-4,ao]);var pa=class extends rr{constructor(e){super(e)}},ya=So(class extends rr{constructor(e){super(e)}},[0,eo,[0,1,co,yo,na],ao]),ga=class extends rr{constructor(e){super(e)}},va=class extends rr{constructor(e){super(e)}ra(){const e=en(this);return null==e?U():e}},xa=class extends rr{constructor(e){super(e)}},wa=[1,2],ba=So(class extends rr{constructor(e){super(e)}},[0,eo,[0,wa,xo,[0,oo],xo,[0,wo],co,yo],ao]),Ea=class extends rr{constructor(e){super(e)}},Ma=[0,yo,co,no,ho,-1],za=class extends rr{constructor(e){super(e)}},Sa=[0,fo,-1],Ta=class extends rr{constructor(e){super(e)}},Aa=[1,2,3,4,5],_a=class extends rr{constructor(e){super(e)}g(){return null!=en(this)}h(){return null!=ot(qt(this,2))}},Da=class extends rr{constructor(e){super(e)}g(){return qe(qt(this,2))??!1}},Pa=[0,wo,yo,[0,co,ao,-1],[0,so,ao]],Ca=[0,Pa,fo,[0,Aa,xo,Bo,xo,Co,xo,Do,xo,ko,xo,Ro],Eo],Ra=class extends rr{constructor(e){super(e)}},Fa=[0,Ca,no,-1,co],ka=zo(502141897,Ra);Uo[502141897]=Fa,Oo[502141897]=1;var Ba=[0,Pa];Uo[512499200]=Ba;var Ia=[0,Ba];Uo[515723506]=Ia;var La=So(class extends rr{constructor(e){super(e)}},[0,[0,Eo,-1,ro,bo],ma]),Ua=[0,Ca];Uo[508981768]=Ua;var Oa=class extends rr{constructor(e){super(e)}},Na=class extends rr{constructor(e){super(e)}},Va=[0,Ca,no,Ua,fo],ja=[0,Ca,Fa,Va,no,Ia];Uo[508968149]=Va;var Ga=zo(508968150,Na);Uo[508968150]=ja,Oo[508968150]=1,Oo[508968149]=1;var Wa=class extends rr{constructor(e){super(e)}},Ha=zo(513916220,Wa);Uo[513916220]=[0,Ca,ja,co],Oo[513916220]=1;var Xa=class extends rr{constructor(e){super(e)}h(){return pn(this,Ea,2)}g(){Kt(this,2)}},qa=[0,Ca,Ma];Uo[478825465]=qa,Oo[478825465]=1;var $a=[0,Ca];Uo[478825422]=$a;var Ya=class extends rr{constructor(e){super(e)}},Ka=class extends rr{constructor(e){super(e)}},Za=class extends rr{constructor(e){super(e)}},Qa=class extends rr{constructor(e){super(e)}},Ja=class extends rr{constructor(e){super(e)}},ei=[0,Ca,$a,qa,-1],ti=[0,Ca,no,co],ni=[0,Ca,no],ri=[0,Ca,ti,ni,no],oi=[0,Ca,ri,ei];Uo[463370452]=ei,Uo[464864288]=ti,Uo[474472470]=ni;var ai=zo(462713202,Qa);Uo[462713202]=ri;var ii=zo(479097054,Ja);Uo[479097054]=oi,Oo[479097054]=1,Oo[463370452]=1,Oo[464864288]=1,Oo[462713202]=1,Oo[474472470]=1;var si=class extends rr{constructor(e){super(e)}},ci=class extends rr{constructor(e){super(e)}},li=class extends rr{constructor(e){super(e)}},ui=class extends rr{constructor(){super()}},di=[0,Ca,no,-1,co],fi=[0,Ca,no,fo];ui.prototype.g=To([0,Ca,ni,[0,Ca],Fa,Va,di,fi]),Uo[514774813]=di,Uo[518928384]=fi;var mi=class extends rr{constructor(e){super(e)}},hi=zo(456383383,mi);Uo[456383383]=[0,Ca,Ma],Oo[456383383]=1;var pi=class extends rr{constructor(e){super(e)}},yi=zo(476348187,pi);Uo[476348187]=[0,Ca,Sa],Oo[476348187]=1;var gi=class extends rr{constructor(e){super(e)}},vi=class extends rr{constructor(e){super(e)}},xi=[0,Eo,-1],wi=zo(458105876,class extends rr{constructor(e){super(e)}g(){var e=this.u;const t=re(e),n=2&t;return e=function(e,t,n){var r=vi;const o=2&t;let a=!1;if(null==n){if(o)return Lt();n=[]}else if(n.constructor===Rt){if(0==(2&n.M)||o)return n;n=n.Z()}else Array.isArray(n)?a=!!(2&ne(n)):n=[];if(o){if(!n.length)return Lt();a||(a=!0,ae(n))}else a&&(a=!1,n=sn(n));return a||(64&ne(n)?te(n,32):32&t&&ee(n,32)),Zt(e,t,2,r=new Rt(n,r,it,void 0)),r}(e,t,Yt(e,t,2)),!n&&vi&&(e.va=!0),e}});Uo[458105876]=[0,xi,Hr,[!0,ao,[0,yo,-1,ho]]],Oo[458105876]=1;var bi=class extends rr{constructor(e){super(e)}},Ei=zo(458105758,bi);Uo[458105758]=[0,Ca,yo,xi],Oo[458105758]=1;var Mi=class extends rr{constructor(e){super(e)}},zi=zo(443442058,Mi);Uo[443442058]=[0,Ca,yo,co,no,ho,-1],Oo[443442058]=1,Oo[514774813]=1;var Si=class extends rr{constructor(e){super(e)}},Ti=zo(516587230,Si);function Ai(e,t){return t=t?t.clone():new Ea,void 0!==e.displayNamesLocale?Kt(t,1,rt(e.displayNamesLocale)):void 0===e.displayNamesLocale&&Kt(t,1),void 0!==e.maxResults?_n(t,2,e.maxResults):"maxResults"in e&&Kt(t,2),void 0!==e.scoreThreshold?Dn(t,3,e.scoreThreshold):"scoreThreshold"in e&&Kt(t,3),void 0!==e.categoryAllowlist?Pn(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&Kt(t,4),void 0!==e.categoryDenylist?Pn(t,5,e.categoryDenylist):"categoryDenylist"in e&&Kt(t,5),t}function _i(e,t=-1,n=""){return{categories:e.map((e=>({index:Mn(zn(e,1),0)??-1,score:Sn(e,2)??0,categoryName:Tn(e,3)??"",displayName:Tn(e,4)??""}))),headIndex:t,headName:n}}function Di(e){var t=nn(e,3,Xe,tn()),n=nn(e,2,Ke,tn()),r=nn(e,1,ot,tn()),o=nn(e,9,ot,tn());const a={categories:[],keypoints:[]};for(let i=0;i<t.length;i++)a.categories.push({score:t[i],index:n[i]??-1,categoryName:r[i]??"",displayName:o[i]??""});if((t=pn(e,ia,4)?.h())&&(a.boundingBox={originX:zn(t,1)??0,originY:zn(t,2)??0,width:zn(t,3)??0,height:zn(t,4)??0,angle:0}),pn(e,ia,4)?.g().length)for(const i of pn(e,ia,4).g())a.keypoints.push({x:Jt(i,1)??0,y:Jt(i,2)??0,score:Jt(i,4)??0,label:ot(qt(i,3))??""});return a}function Pi(e){const t=[];for(const n of gn(e,ua,1))t.push({x:Sn(n,1)??0,y:Sn(n,2)??0,z:Sn(n,3)??0,visibility:Sn(n,4)??0});return t}function Ci(e){const t=[];for(const n of gn(e,ca,1))t.push({x:Sn(n,1)??0,y:Sn(n,2)??0,z:Sn(n,3)??0,visibility:Sn(n,4)??0});return t}function Ri(e){return Array.from(e,(e=>e>127?e-256:e))}function Fi(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,o=0;for(let a=0;a<e.length;a++)n+=e[a]*t[a],r+=e[a]*e[a],o+=t[a]*t[a];if(r<=0||o<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*o)}let ki;Uo[516587230]=[0,Ca,di,fi,no],Oo[516587230]=1,Oo[518928384]=1;const Bi=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Ii(){if(void 0===ki)try{await WebAssembly.instantiate(Bi),ki=!0}catch{ki=!1}return ki}async function Li(e,t=""){const n=await Ii()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var Ui=class{};function Oi(){var e=navigator;return"undefined"!=typeof OffscreenCanvas&&(!function(e=navigator){return(e=e.userAgent).includes("Safari")&&!e.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function Ni(e){if("function"!=typeof importScripts){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise(((e,n)=>{t.addEventListener("load",(()=>{e()}),!1),t.addEventListener("error",(e=>{n(e)}),!1),document.body.appendChild(t)}))}importScripts(e.toString())}function Vi(e){return void 0!==e.videoWidth?[e.videoWidth,e.videoHeight]:void 0!==e.naturalWidth?[e.naturalWidth,e.naturalHeight]:void 0!==e.displayWidth?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function ji(e,t,n){e.m,n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function Gi(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,o]=Vi(t);return!e.l||r===e.i.canvas.width&&o===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=o),[r,o]}function Wi(e,t,n){e.m;const r=new Uint32Array(t.length);for(let o=0;o<t.length;o++)r[o]=e.i.stringToNewUTF8(t[o]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const o of r)e.i._free(o);e.i._free(t)}function Hi(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function Xi(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(e,t,o)=>{t?(n(r,o),r=[]):r.push(e)}}function qi(e,t){const n=pn(e.baseOptions,_a,1)||new _a;"string"==typeof t?(Kt(n,2,rt(t)),Kt(n,1)):t instanceof Uint8Array&&(Kt(n,1,me(t,!1,!1)),Kt(n,2)),vn(e.baseOptions,0,1,n)}function $i(e){try{const t=e.H.length;if(1===t)throw Error(e.H[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.H.map((e=>e.message)).join(", "))}finally{e.H=[]}}function Yi(e,t){e.B=Math.max(e.B,t)}function Ki(e,t){e.A=new Wo,Vo(e.A,"PassThroughCalculator"),jo(e.A,"free_memory"),Go(e.A,"free_memory_unused_out"),Yo(t,"free_memory"),$o(t,e.A)}function Zi(e,t){jo(e.A,t),Go(e.A,t+"_unused_out")}function Qi(e){e.g.addBoolToStream(!0,"free_memory",e.B)}Ui.forVisionTasks=function(e){return Li("vision",e)},Ui.forTextTasks=function(e){return Li("text",e)},Ui.forGenAiExperimentalTasks=function(e){return Li("genai_experimental",e)},Ui.forGenAiTasks=function(e){return Li("genai",e)},Ui.forAudioTasks=function(e){return Li("audio",e)},Ui.isSimdSupported=function(){return Ii()};var Ji=class{constructor(e){this.g=e,this.H=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){if(t){const t=e.baseOptions||{};if(e.baseOptions?.modelAssetBuffer&&e.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(pn(this.baseOptions,_a,1)?.g()||pn(this.baseOptions,_a,1)?.h()||e.baseOptions?.modelAssetBuffer||e.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(e,t){let n=pn(e.baseOptions,Ta,3);if(!n){var r=n=new Ta,o=new Fo;xn(r,4,Aa,o)}"delegate"in t&&("GPU"===t.delegate?(t=n,r=new Po,xn(t,2,Aa,r)):(t=n,r=new Fo,xn(t,4,Aa,r))),vn(e.baseOptions,0,3,n)}(this,t),t.modelAssetPath)return fetch(t.modelAssetPath.toString()).then((e=>{if(e.ok)return e.arrayBuffer();throw Error(`Failed to fetch model: ${t.modelAssetPath} (${e.status})`)})).then((e=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(e),!0,!1,!1),qi(this,"/model.dat"),this.m(),this.J()}));if(t.modelAssetBuffer instanceof Uint8Array)qi(this,t.modelAssetBuffer);else if(t.modelAssetBuffer)return async function(e){const t=[];for(var n=0;;){const{done:r,value:o}=await e.read();if(r)break;t.push(o),n+=o.length}if(0===t.length)return new Uint8Array(0);if(1===t.length)return t[0];e=new Uint8Array(n),n=0;for(const r of t)e.set(r,n),n+=r.length;return e}(t.modelAssetBuffer).then((e=>{qi(this,e),this.m(),this.J()}))}return this.m(),this.J(),Promise.resolve()}J(){}ga(){let e;if(this.g.ga((t=>{e=Jo(t)})),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener(((e,t)=>{this.H.push(Error(t))})),this.g.Oa(),this.g.setGraph(e,t),this.A=void 0,$i(this)}finishProcessing(){this.g.finishProcessing(),$i(this)}close(){this.A=void 0,this.g.closeGraph()}};function es(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Ji.prototype.close=Ji.prototype.close,function(e,t){e=e.split(".");var n,o=r;e[0]in o||void 0===o.execScript||o.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?o=o[n]&&o[n]!==Object.prototype[n]?o[n]:o[n]={}:o[n]=t}("TaskRunner",Ji);class ts{constructor(e,t,n,r){this.g=e,this.h=t,this.m=n,this.l=r}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function ns(e,t,n){const r=e.g;if(n=es(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function rs(e,t){const n=e.g,r=es(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const o=es(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,o),n.enableVertexAttribArray(e.R),n.vertexAttribPointer(e.R,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const a=es(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,a),n.enableVertexAttribArray(e.J),n.vertexAttribPointer(e.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new ts(n,r,o,a)}function os(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function as(e,t,n,r){return os(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=rs(e,!0)),n=e.s):(e.v||(e.v=rs(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function is(e,t,n){return os(e,t),e=es(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function ss(e,t,n){os(e,t),e.A||(e.A=es(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function cs(e){e.g?.bindFramebuffer(e.g.FRAMEBUFFER,null)}var ls=class{H(){return"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D inputTexture;\n  void main() {\n    gl_FragColor = texture2D(inputTexture, vTex);\n  }\n "}m(){const e=this.g;if(this.h=es(e.createProgram(),"Failed to create WebGL program"),this.da=ns(this,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",e.VERTEX_SHADER),this.ca=ns(this,this.H(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.R=e.getAttribLocation(this.h,"aVertex"),this.J=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.da),e.deleteShader(this.ca)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}},us=class extends ls{H(){return"\n  precision mediump float;\n  uniform sampler2D backgroundTexture;\n  uniform sampler2D maskTexture;\n  uniform sampler2D colorMappingTexture;\n  varying vec2 vTex;\n  void main() {\n    vec4 backgroundColor = texture2D(backgroundTexture, vTex);\n    float category = texture2D(maskTexture, vTex).r;\n    vec4 categoryColor = texture2D(colorMappingTexture, vec2(category, 0.0));\n    gl_FragColor = mix(backgroundColor, categoryColor, categoryColor.a);\n  }\n "}C(){const e=this.g;e.activeTexture(e.TEXTURE1),this.B=is(this,e,e.LINEAR),e.activeTexture(e.TEXTURE2),this.j=is(this,e,e.NEAREST)}m(){super.m();const e=this.g;this.L=es(e.getUniformLocation(this.h,"backgroundTexture"),"Uniform location"),this.V=es(e.getUniformLocation(this.h,"colorMappingTexture"),"Uniform location"),this.K=es(e.getUniformLocation(this.h,"maskTexture"),"Uniform location")}l(){super.l();const e=this.g;e.uniform1i(this.K,0),e.uniform1i(this.L,1),e.uniform1i(this.V,2)}close(){this.B&&this.g.deleteTexture(this.B),this.j&&this.g.deleteTexture(this.j),super.close()}},ds=class extends ls{H(){return"\n  precision mediump float;\n  uniform sampler2D maskTexture;\n  uniform sampler2D defaultTexture;\n  uniform sampler2D overlayTexture;\n  varying vec2 vTex;\n  void main() {\n    float confidence = texture2D(maskTexture, vTex).r;\n    vec4 defaultColor = texture2D(defaultTexture, vTex);\n    vec4 overlayColor = texture2D(overlayTexture, vTex);\n    // Apply the alpha from the overlay and merge in the default color\n    overlayColor = mix(defaultColor, overlayColor, overlayColor.a);\n    gl_FragColor = mix(defaultColor, overlayColor, confidence);\n  }\n "}C(){const e=this.g;e.activeTexture(e.TEXTURE1),this.j=is(this,e),e.activeTexture(e.TEXTURE2),this.B=is(this,e)}m(){super.m();const e=this.g;this.K=es(e.getUniformLocation(this.h,"defaultTexture"),"Uniform location"),this.L=es(e.getUniformLocation(this.h,"overlayTexture"),"Uniform location"),this.I=es(e.getUniformLocation(this.h,"maskTexture"),"Uniform location")}l(){super.l();const e=this.g;e.uniform1i(this.I,0),e.uniform1i(this.K,1),e.uniform1i(this.L,2)}close(){this.j&&this.g.deleteTexture(this.j),this.B&&this.g.deleteTexture(this.B),super.close()}};function fs(e,t){switch(t){case 0:return e.g.find((e=>e instanceof Uint8Array));case 1:return e.g.find((e=>e instanceof Float32Array));case 2:return e.g.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw Error(`Type is not supported: ${t}`)}}function ms(e){var t=fs(e,1);if(!t){if(t=fs(e,0))t=new Float32Array(t).map((e=>e/255));else{t=new Float32Array(e.width*e.height);const r=ps(e);var n=gs(e);if(ss(n,r,hs(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let e=0,r=0;e<t.length;++e,r+=4)t[e]=n[r]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function hs(e){let t=fs(e,2);if(!t){const n=ps(e);t=vs(e);const r=ms(e),o=ys(e);n.texImage2D(n.TEXTURE_2D,0,o,e.width,e.height,0,n.RED,n.FLOAT,r),xs(e)}return t}function ps(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=es(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function ys(e){if(e=ps(e),!ws)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))ws=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");ws=e.R16F}return ws}function gs(e){return e.l||(e.l=new ls),e.l}function vs(e){const t=ps(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=fs(e,2);return n||(n=is(gs(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function xs(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var ws,bs=class{constructor(e,t,n,r,o,a,i){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=o,this.width=a,this.height=i,this.j}Ja(){return!!fs(this,0)}ma(){return!!fs(this,1)}S(){return!!fs(this,2)}la(){return(e=fs(this,0))||(e=ms(this),e=new Uint8Array(e.map((e=>255*e))),this.g.push(e)),e;var e}ka(){return ms(this)}N(){return hs(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const e=ps(this),t=gs(this);e.activeTexture(e.TEXTURE1),n=is(t,e,this.m?e.LINEAR:e.NEAREST),e.bindTexture(e.TEXTURE_2D,n);const r=ys(this);e.texImage2D(e.TEXTURE_2D,0,r,this.width,this.height,0,e.RED,e.FLOAT,null),e.bindTexture(e.TEXTURE_2D,null),ss(t,e,n),as(t,e,!1,(()=>{vs(this),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),xs(this)})),cs(t),xs(this)}}e.push(n)}return new bs(e,this.m,this.S(),this.canvas,this.l,this.width,this.height)}close(){this.j&&ps(this).deleteTexture(fs(this,2))}};bs.prototype.close=bs.prototype.close,bs.prototype.clone=bs.prototype.clone,bs.prototype.getAsWebGLTexture=bs.prototype.N,bs.prototype.getAsFloat32Array=bs.prototype.ka,bs.prototype.getAsUint8Array=bs.prototype.la,bs.prototype.hasWebGLTexture=bs.prototype.S,bs.prototype.hasFloat32Array=bs.prototype.ma,bs.prototype.hasUint8Array=bs.prototype.Ja;const Es={color:"white",lineWidth:4,radius:6};function Ms(e){return{...Es,fillColor:(e=e||{}).color,...e}}function zs(e,t){return e instanceof Function?e(t):e}function Ss(e,t,n){return Math.max(Math.min(t,n),Math.min(Math.max(t,n),e))}function Ts(e){if(!e.l)throw Error("CPU rendering requested but CanvasRenderingContext2D not provided.");return e.l}function As(e){if(!e.j)throw Error("GPU rendering requested but WebGL2RenderingContext not provided.");return e.j}function _s(e,t,n){if(t.S())n(t.N());else{const r=t.ma()?t.ka():t.la();e.m=e.m??new ls;const o=As(e);n((e=new bs([r],t.m,!1,o.canvas,e.m,t.width,t.height)).N()),e.close()}}function Ds(e,t,n,r){const o=function(e){return e.g||(e.g=new us),e.g}(e),a=As(e),i=Array.isArray(n)?new ImageData(new Uint8ClampedArray(n),1,1):n;as(o,a,!0,(()=>{!function(e,t,n,r){const o=e.g;if(o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,e.B),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,n),e.I&&function(e,t){if(e!==t)return!1;e=e.entries(),t=t.entries();for(const[r,o]of e){e=r;const a=o;var n=t.next();if(n.done)return!1;const[i,s]=n.value;if(n=s,e!==i||a[0]!==n[0]||a[1]!==n[1]||a[2]!==n[2]||a[3]!==n[3])return!1}return!!t.next().done}(e.I,r))o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,e.j);else{e.I=r;const t=Array(1024).fill(0);r.forEach(((e,n)=>{if(4!==e.length)throw Error(`Color at index ${n} is not a four-channel value.`);t[4*n]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]})),o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,e.j),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,256,1,0,o.RGBA,o.UNSIGNED_BYTE,new Uint8Array(t))}}(o,t,i,r),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.drawArrays(a.TRIANGLE_FAN,0,4);const e=o.g;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,null)}))}function Ps(e,t,n,r){const o=As(e),a=function(e){return e.h||(e.h=new ds),e.h}(e),i=Array.isArray(n)?new ImageData(new Uint8ClampedArray(n),1,1):n,s=Array.isArray(r)?new ImageData(new Uint8ClampedArray(r),1,1):r;as(a,o,!0,(()=>{var e=a.g;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,a.j),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,a.B),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.drawArrays(o.TRIANGLE_FAN,0,4),o.bindTexture(o.TEXTURE_2D,null),(e=a.g).activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,null)}))}var Cs=class{constructor(e,t){e instanceof CanvasRenderingContext2D||e instanceof OffscreenCanvasRenderingContext2D?(this.l=e,this.j=t):this.j=e}Ca(e,t){if(e){var n=Ts(this);t=Ms(t),n.save();var r=n.canvas,o=0;for(const a of e)n.fillStyle=zs(t.fillColor,{index:o,from:a}),n.strokeStyle=zs(t.color,{index:o,from:a}),n.lineWidth=zs(t.lineWidth,{index:o,from:a}),(e=new Path2D).arc(a.x*r.width,a.y*r.height,zs(t.radius,{index:o,from:a}),0,2*Math.PI),n.fill(e),n.stroke(e),++o;n.restore()}}Ba(e,t,n){if(e&&t){var r=Ts(this);n=Ms(n),r.save();var o=r.canvas,a=0;for(const i of t){r.beginPath(),t=e[i.start];const s=e[i.end];t&&s&&(r.strokeStyle=zs(n.color,{index:a,from:t,to:s}),r.lineWidth=zs(n.lineWidth,{index:a,from:t,to:s}),r.moveTo(t.x*o.width,t.y*o.height),r.lineTo(s.x*o.width,s.y*o.height)),++a,r.stroke()}r.restore()}}ya(e,t){const n=Ts(this);t=Ms(t),n.save(),n.beginPath(),n.lineWidth=zs(t.lineWidth,{}),n.strokeStyle=zs(t.color,{}),n.fillStyle=zs(t.fillColor,{}),n.moveTo(e.originX,e.originY),n.lineTo(e.originX+e.width,e.originY),n.lineTo(e.originX+e.width,e.originY+e.height),n.lineTo(e.originX,e.originY+e.height),n.lineTo(e.originX,e.originY),n.stroke(),n.fill(),n.restore()}za(e,t,n=[0,0,0,255]){this.l?function(e,t,n,r){const o=As(e);_s(e,t,(t=>{Ds(e,t,n,r),(t=Ts(e)).drawImage(o.canvas,0,0,t.canvas.width,t.canvas.height)}))}(this,e,n,t):Ds(this,e.N(),n,t)}Aa(e,t,n){this.l?function(e,t,n,r){const o=As(e);_s(e,t,(t=>{Ps(e,t,n,r),(t=Ts(e)).drawImage(o.canvas,0,0,t.canvas.width,t.canvas.height)}))}(this,e,t,n):Ps(this,e.N(),t,n)}close(){this.g?.close(),this.g=void 0,this.h?.close(),this.h=void 0,this.m?.close(),this.m=void 0}};function Rs(e,t){switch(t){case 0:return e.g.find((e=>e instanceof ImageData));case 1:return e.g.find((e=>"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap));case 2:return e.g.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw Error(`Type is not supported: ${t}`)}}function Fs(e){var t=Rs(e,0);if(!t){t=Bs(e);const n=Is(e),r=new Uint8Array(e.width*e.height*4);ss(n,t,ks(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),cs(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function ks(e){let t=Rs(e,2);if(!t){const n=Bs(e);t=Ls(e);const r=Rs(e,1)||Fs(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Us(e)}return t}function Bs(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when iniitializing the image.");return e.h||(e.h=es(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Is(e){return e.l||(e.l=new ls),e.l}function Ls(e){const t=Bs(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Rs(e,2);return n||(n=is(Is(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Us(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function Os(e){const t=Bs(e);return as(Is(e),t,!0,(()=>function(e,t){const n=e.canvas;if(n.width===e.width&&n.height===e.height)return t();const r=n.width,o=n.height;return n.width=e.width,n.height=e.height,e=t(),n.width=r,n.height=o,e}(e,(()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))))}Cs.prototype.close=Cs.prototype.close,Cs.prototype.drawConfidenceMask=Cs.prototype.Aa,Cs.prototype.drawCategoryMask=Cs.prototype.za,Cs.prototype.drawBoundingBox=Cs.prototype.ya,Cs.prototype.drawConnectors=Cs.prototype.Ba,Cs.prototype.drawLandmarks=Cs.prototype.Ca,Cs.lerp=function(e,t,n,r,o){return Ss(r*(1-(e-t)/(n-t))+o*(1-(n-e)/(n-t)),r,o)},Cs.clamp=Ss;var Ns=class{constructor(e,t,n,r,o,a,i){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=o,this.width=a,this.height=i,this.j||this.m}Ia(){return!!Rs(this,0)}na(){return!!Rs(this,1)}S(){return!!Rs(this,2)}Ga(){return Fs(this)}Fa(){var e=Rs(this,1);return e||(ks(this),Ls(this),e=Os(this),Us(this),this.g.push(e),this.j=!0),e}N(){return ks(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const e=Bs(this),t=Is(this);e.activeTexture(e.TEXTURE1),n=is(t,e),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null),ss(t,e,n),as(t,e,!1,(()=>{Ls(this),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),Us(this)})),cs(t),Us(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);ks(this),Ls(this),n=Os(this),Us(this)}e.push(n)}return new Ns(e,this.na(),this.S(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Rs(this,1).close(),this.m&&Bs(this).deleteTexture(Rs(this,2))}};function Vs(...e){return e.map((([e,t])=>({start:e,end:t})))}Ns.prototype.close=Ns.prototype.close,Ns.prototype.clone=Ns.prototype.clone,Ns.prototype.getAsWebGLTexture=Ns.prototype.N,Ns.prototype.getAsImageBitmap=Ns.prototype.Fa,Ns.prototype.getAsImageData=Ns.prototype.Ga,Ns.prototype.hasWebGLTexture=Ns.prototype.S,Ns.prototype.hasImageBitmap=Ns.prototype.na,Ns.prototype.hasImageData=Ns.prototype.Ia;const js=function(e){return class extends e{Oa(){this.i._registerModelResourcesGraphService()}}}((Gs=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m="function"==typeof this.i._addIntToInputStream,void 0!==t?this.i.canvas=t:Oi()?this.i.canvas=new OffscreenCanvas(1,1):this.i.canvas=document.createElement("canvas")}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph((new TextEncoder).encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,o){this.i._configureAudio,ji(this,r||"input_audio",(r=>{ji(this,o=o||"audio_header",(o=>{this.i._configureAudio(r,o,e,t,n)}))}))}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}ga(e){Hi(this,"__graph_config__",(t=>{e(t)})),ji(this,"__graph_config__",(e=>{this.i._getGraphConfig(e,void 0)})),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,o){const a=4*e.length;this.h!==a&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(a),this.h=a),this.i.HEAPF32.set(e,this.g/4),ji(this,r,(e=>{this.i._addAudioToInputStream(this.g,t,n,e,o)}))}addGpuBufferToStream(e,t,n){ji(this,t,(t=>{const[r,o]=Gi(this,e,t);this.i._addBoundTextureToStream(t,r,o,n)}))}addBoolToStream(e,t,n){ji(this,t,(t=>{this.i._addBoolToInputStream(e,t,n)}))}addDoubleToStream(e,t,n){ji(this,t,(t=>{this.i._addDoubleToInputStream(e,t,n)}))}addFloatToStream(e,t,n){ji(this,t,(t=>{this.i._addFloatToInputStream(e,t,n)}))}addIntToStream(e,t,n){ji(this,t,(t=>{this.i._addIntToInputStream(e,t,n)}))}addUintToStream(e,t,n){ji(this,t,(t=>{this.i._addUintToInputStream(e,t,n)}))}addStringToStream(e,t,n){ji(this,t,(t=>{ji(this,e,(e=>{this.i._addStringToInputStream(e,t,n)}))}))}addStringRecordToStream(e,t,n){ji(this,t,(t=>{Wi(this,Object.keys(e),(r=>{Wi(this,Object.values(e),(o=>{this.i._addFlatHashMapToInputStream(r,o,Object.keys(e).length,t,n)}))}))}))}addProtoToStream(e,t,n,r){ji(this,n,(n=>{ji(this,t,(t=>{const o=this.i._malloc(e.length);this.i.HEAPU8.set(e,o),this.i._addProtoToInputStream(o,e.length,t,n,r),this.i._free(o)}))}))}addEmptyPacketToStream(e,t){ji(this,e,(e=>{this.i._addEmptyPacketToInputStream(e,t)}))}addBoolVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const n of e)this.i._addBoolVectorEntry(r,n);this.i._addBoolVectorToInputStream(r,t,n)}))}addDoubleVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const n of e)this.i._addDoubleVectorEntry(r,n);this.i._addDoubleVectorToInputStream(r,t,n)}))}addFloatVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const n of e)this.i._addFloatVectorEntry(r,n);this.i._addFloatVectorToInputStream(r,t,n)}))}addIntVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const n of e)this.i._addIntVectorEntry(r,n);this.i._addIntVectorToInputStream(r,t,n)}))}addUintVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const n of e)this.i._addUintVectorEntry(r,n);this.i._addUintVectorToInputStream(r,t,n)}))}addStringVectorToStream(e,t,n){ji(this,t,(t=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const n of e)ji(this,n,(e=>{this.i._addStringVectorEntry(r,e)}));this.i._addStringVectorToInputStream(r,t,n)}))}addBoolToInputSidePacket(e,t){ji(this,t,(t=>{this.i._addBoolToInputSidePacket(e,t)}))}addDoubleToInputSidePacket(e,t){ji(this,t,(t=>{this.i._addDoubleToInputSidePacket(e,t)}))}addFloatToInputSidePacket(e,t){ji(this,t,(t=>{this.i._addFloatToInputSidePacket(e,t)}))}addIntToInputSidePacket(e,t){ji(this,t,(t=>{this.i._addIntToInputSidePacket(e,t)}))}addUintToInputSidePacket(e,t){ji(this,t,(t=>{this.i._addUintToInputSidePacket(e,t)}))}addStringToInputSidePacket(e,t){ji(this,t,(t=>{ji(this,e,(e=>{this.i._addStringToInputSidePacket(e,t)}))}))}addProtoToInputSidePacket(e,t,n){ji(this,n,(n=>{ji(this,t,(t=>{const r=this.i._malloc(e.length);this.i.HEAPU8.set(e,r),this.i._addProtoToInputSidePacket(r,e.length,t,n),this.i._free(r)}))}))}addBoolVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateBoolVector(e.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const r of e)this.i._addBoolVectorEntry(n,r);this.i._addBoolVectorToInputSidePacket(n,t)}))}addDoubleVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateDoubleVector(e.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const r of e)this.i._addDoubleVectorEntry(n,r);this.i._addDoubleVectorToInputSidePacket(n,t)}))}addFloatVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateFloatVector(e.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const r of e)this.i._addFloatVectorEntry(n,r);this.i._addFloatVectorToInputSidePacket(n,t)}))}addIntVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateIntVector(e.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const r of e)this.i._addIntVectorEntry(n,r);this.i._addIntVectorToInputSidePacket(n,t)}))}addUintVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateUintVector(e.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const r of e)this.i._addUintVectorEntry(n,r);this.i._addUintVectorToInputSidePacket(n,t)}))}addStringVectorToInputSidePacket(e,t){ji(this,t,(t=>{const n=this.i._allocateStringVector(e.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const r of e)ji(this,r,(e=>{this.i._addStringVectorEntry(n,e)}));this.i._addStringVectorToInputSidePacket(n,t)}))}attachBoolListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachBoolListener(e)}))}attachBoolVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachBoolVectorListener(e)}))}attachIntListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachIntListener(e)}))}attachIntVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachIntVectorListener(e)}))}attachUintListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachUintListener(e)}))}attachUintVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachUintVectorListener(e)}))}attachDoubleListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachDoubleListener(e)}))}attachDoubleVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachDoubleVectorListener(e)}))}attachFloatListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachFloatListener(e)}))}attachFloatVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachFloatVectorListener(e)}))}attachStringListener(e,t){Hi(this,e,t),ji(this,e,(e=>{this.i._attachStringListener(e)}))}attachStringVectorListener(e,t){Xi(this,e,t),ji(this,e,(e=>{this.i._attachStringVectorListener(e)}))}attachProtoListener(e,t,n){Hi(this,e,t),ji(this,e,(e=>{this.i._attachProtoListener(e,n||!1)}))}attachProtoVectorListener(e,t,n){Xi(this,e,t),ji(this,e,(e=>{this.i._attachProtoVectorListener(e,n||!1)}))}attachAudioListener(e,t,n){this.i._attachAudioListener,Hi(this,e,((e,n)=>{e=new Float32Array(e.buffer,e.byteOffset,e.length/4),t(e,n)})),ji(this,e,(e=>{this.i._attachAudioListener(e,n||!1)}))}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends Gs{get ia(){return this.i}ta(e,t,n){ji(this,t,(t=>{const[r,o]=Gi(this,e,t);this.ia._addBoundTextureAsImageToStream(t,r,o,n)}))}W(e,t){Hi(this,e,t),ji(this,e,(e=>{this.ia._attachImageListener(e)}))}fa(e,t){Xi(this,e,t),ji(this,e,(e=>{this.ia._attachImageVectorListener(e)}))}}));var Gs,Ws=class extends js{};async function Hs(e,t,n){return async function(e,t,n,r){return async function(e,t,n,r){return e=await(async(e,t,n,r,o)=>{if(t&&await Ni(t),!self.ModuleFactory)throw Error("ModuleFactory not set.");if(n&&(await Ni(n),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&o&&((t=self.Module).locateFile=o.locateFile,o.mainScriptUrlOrBlob&&(t.mainScriptUrlOrBlob=o.mainScriptUrlOrBlob)),o=await self.ModuleFactory(self.Module||o),self.ModuleFactory=self.Module=void 0,new e(o,r)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:e=>e.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&e.endsWith(".data")?n.assetBinaryPath.toString():e}),await e.o(r),e}(e,t,n,r)}(e,n.canvas??(Oi()?void 0:document.createElement("canvas")),t,n)}function Xs(e,t,n,r){if(e.V){const a=new ha;if(n?.regionOfInterest){if(!e.sa)throw Error("This task doesn't support region-of-interest.");var o=n.regionOfInterest;if(o.left>=o.right||o.top>=o.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(o.left<0||o.top<0||o.right>1||o.bottom>1)throw Error("Expected RectF values to be in [0,1].");Dn(a,1,(o.left+o.right)/2),Dn(a,2,(o.top+o.bottom)/2),Dn(a,4,o.right-o.left),Dn(a,3,o.bottom-o.top)}else Dn(a,1,.5),Dn(a,2,.5),Dn(a,4,1),Dn(a,3,1);if(n?.rotationDegrees){if(n?.rotationDegrees%90!=0)throw Error("Expected rotation to be a multiple of 90\xb0.");if(Dn(a,5,-Math.PI*n.rotationDegrees/180),n?.rotationDegrees%180!=0){const[e,r]=Vi(t);n=Sn(a,3)*r/e,o=Sn(a,4)*e/r,Dn(a,4,n),Dn(a,3,o)}}e.g.addProtoToStream(a.g(),"mediapipe.NormalizedRect",e.V,r)}e.g.ta(t,e.da,r??performance.now()),e.finishProcessing()}function qs(e,t,n){if(e.baseOptions?.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Xs(e,t,n,e.B+1)}function $s(e,t,n,r){if(!e.baseOptions?.g())throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Xs(e,t,n,r)}function Ys(e,t,n,r){var o=t.data;const a=t.width,i=a*(t=t.height);if((o instanceof Uint8Array||o instanceof Float32Array)&&o.length!==i)throw Error("Unsupported channel count: "+o.length/i);return e=new bs([o],n,!1,e.g.i.canvas,e.R,a,t),r?e.clone():e}var Ks=class extends Ji{constructor(e,t,n,r){super(e),this.g=e,this.da=t,this.V=n,this.sa=r,this.R=new ls}l(e,t=!0){if("runningMode"in e&&An(this.baseOptions,2,!!e.runningMode&&"IMAGE"!==e.runningMode),void 0!==e.canvas&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.R.close(),super.close()}};Ks.prototype.close=Ks.prototype.close;var Zs=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},vn(e=this.h=new Ra,0,1,t=new Da),Dn(this.h,2,.5),Dn(this.h,3,.3)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&Dn(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&Dn(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},qs(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},$s(this,e,n,t),this.j}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect_in"),Ko(e,"detections");const t=new Lo;nr(t,ka,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect_in"),Go(n,"DETECTIONS:detections"),n.o(t),$o(e,n),this.g.attachProtoVectorListener("detections",((e,t)=>{for(const n of e)e=sa(n),this.j.detections.push(Di(e));Yi(this,t)})),this.g.attachEmptyPacketListener("detections",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Zs.prototype.detectForVideo=Zs.prototype.F,Zs.prototype.detect=Zs.prototype.D,Zs.prototype.setOptions=Zs.prototype.o,Zs.createFromModelPath=async function(e,t){return Hs(Zs,e,{baseOptions:{modelAssetPath:t}})},Zs.createFromModelBuffer=function(e,t){return Hs(Zs,e,{baseOptions:{modelAssetBuffer:t}})},Zs.createFromOptions=function(e,t){return Hs(Zs,e,t)};var Qs=Vs([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),Js=Vs([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),ec=Vs([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),tc=Vs([474,475],[475,476],[476,477],[477,474]),nc=Vs([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),rc=Vs([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),oc=Vs([469,470],[470,471],[471,472],[472,469]),ac=Vs([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),ic=[...Qs,...Js,...ec,...nc,...rc,...ac],sc=Vs([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function cc(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var lc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,vn(e=this.h=new Na,0,1,t=new Da),this.v=new Oa,vn(this.h,0,3,this.v),this.s=new Ra,vn(this.h,0,2,this.s),_n(this.s,4,1),Dn(this.s,2,.5),Dn(this.v,2,.5),Dn(this.h,4,.5)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return"numFaces"in e&&_n(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&Dn(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&Dn(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&Dn(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return cc(this),qs(this,e,t),this.j}F(e,t,n){return cc(this),$s(this,e,n,t),this.j}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"face_landmarks");const t=new Lo;nr(t,Ga,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),$o(e,n),this.g.attachProtoVectorListener("face_landmarks",((e,t)=>{for(const n of e)e=da(n),this.j.faceLandmarks.push(Pi(e));Yi(this,t)})),this.g.attachEmptyPacketListener("face_landmarks",(e=>{Yi(this,e)})),this.outputFaceBlendshapes&&(Ko(e,"blendshapes"),Go(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",((e,t)=>{if(this.outputFaceBlendshapes)for(const n of e)e=ra(n),this.j.faceBlendshapes.push(_i(e.g()??[]));Yi(this,t)})),this.g.attachEmptyPacketListener("blendshapes",(e=>{Yi(this,e)}))),this.outputFacialTransformationMatrixes&&(Ko(e,"face_geometry"),Go(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",((e,t)=>{if(this.outputFacialTransformationMatrixes)for(const n of e)(e=pn(La(n),fa,2))&&this.j.facialTransformationMatrixes.push({rows:Mn(zn(e,1),0)??0,columns:Mn(zn(e,2),0)??0,data:nn(e,3,Xe,tn()).slice()??[]});Yi(this,t)})),this.g.attachEmptyPacketListener("face_geometry",(e=>{Yi(this,e)}))),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lc.prototype.detectForVideo=lc.prototype.F,lc.prototype.detect=lc.prototype.D,lc.prototype.setOptions=lc.prototype.o,lc.createFromModelPath=function(e,t){return Hs(lc,e,{baseOptions:{modelAssetPath:t}})},lc.createFromModelBuffer=function(e,t){return Hs(lc,e,{baseOptions:{modelAssetBuffer:t}})},lc.createFromOptions=function(e,t){return Hs(lc,e,t)},lc.FACE_LANDMARKS_LIPS=Qs,lc.FACE_LANDMARKS_LEFT_EYE=Js,lc.FACE_LANDMARKS_LEFT_EYEBROW=ec,lc.FACE_LANDMARKS_LEFT_IRIS=tc,lc.FACE_LANDMARKS_RIGHT_EYE=nc,lc.FACE_LANDMARKS_RIGHT_EYEBROW=rc,lc.FACE_LANDMARKS_RIGHT_IRIS=oc,lc.FACE_LANDMARKS_FACE_OVAL=ac,lc.FACE_LANDMARKS_CONTOURS=ic,lc.FACE_LANDMARKS_TESSELATION=sc;var uc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!0),vn(e=this.j=new Wa,0,1,t=new Da)}get baseOptions(){return pn(this.j,Da,1)}set baseOptions(e){vn(this.j,0,1,e)}o(e){return super.l(e)}Ra(e,t,n){const r="function"!=typeof t?t:{};if(this.h="function"==typeof t?t:n,qs(this,e,r??{}),!this.h)return this.s}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"stylized_image");const t=new Lo;nr(t,Ha,this.j);const n=new Wo;Vo(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),$o(e,n),this.g.W("stylized_image",((e,t)=>{var n=!this.h,r=e.data,o=e.width;const a=o*(e=e.height);if(r instanceof Uint8Array)if(r.length===3*a){const t=new Uint8ClampedArray(4*a);for(let e=0;e<a;++e)t[4*e]=r[3*e],t[4*e+1]=r[3*e+1],t[4*e+2]=r[3*e+2],t[4*e+3]=255;r=new ImageData(t,o,e)}else{if(r.length!==4*a)throw Error("Unsupported channel count: "+r.length/a);r=new ImageData(new Uint8ClampedArray(r.buffer,r.byteOffset,r.length),o,e)}else if(!(r instanceof WebGLTexture))throw Error(`Unsupported format: ${r.constructor.name}`);o=new Ns([r],!1,!1,this.g.i.canvas,this.R,o,e),this.s=n=n?o.clone():o,this.h&&this.h(n),Yi(this,t)})),this.g.attachEmptyPacketListener("stylized_image",(e=>{this.s=null,this.h&&this.h(null),Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};uc.prototype.stylize=uc.prototype.Ra,uc.prototype.setOptions=uc.prototype.o,uc.createFromModelPath=function(e,t){return Hs(uc,e,{baseOptions:{modelAssetPath:t}})},uc.createFromModelBuffer=function(e,t){return Hs(uc,e,{baseOptions:{modelAssetBuffer:t}})},uc.createFromOptions=function(e,t){return Hs(uc,e,t)};var dc=Vs([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function fc(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function mc(e){return 0===e.gestures.length?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function hc(e,t=!0){const n=[];for(const o of e){var r=ra(o);e=[];for(const n of r.g())r=t&&null!=zn(n,1)?Mn(zn(n,1),0):-1,e.push({score:Sn(n,2)??0,index:r,categoryName:Tn(n,3)??"",displayName:Tn(n,4)??""});n.push(e)}return n}var pc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],vn(e=this.j=new Ja,0,1,t=new Da),this.s=new Qa,vn(this.j,0,2,this.s),this.C=new Za,vn(this.s,0,3,this.C),this.v=new Ka,vn(this.s,0,2,this.v),this.h=new Ya,vn(this.j,0,3,this.h),Dn(this.v,2,.5),Dn(this.s,4,.5),Dn(this.C,2,.5)}get baseOptions(){return pn(this.j,Da,1)}set baseOptions(e){vn(this.j,0,1,e)}o(e){if(_n(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&Dn(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Dn(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Dn(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Xa,n=t,r=Ai(e.cannedGesturesClassifierOptions,pn(this.h,Xa,3)?.h());vn(n,0,2,r),vn(this.h,0,3,t)}else void 0===e.cannedGesturesClassifierOptions&&pn(this.h,Xa,3)?.g();return e.customGesturesClassifierOptions?(vn(n=t=new Xa,0,2,r=Ai(e.customGesturesClassifierOptions,pn(this.h,Xa,4)?.h())),vn(this.h,0,4,t)):void 0===e.customGesturesClassifierOptions&&pn(this.h,Xa,4)?.g(),this.l(e)}Ma(e,t){return fc(this),qs(this,e,t),mc(this)}Na(e,t,n){return fc(this),$s(this,e,n,t),mc(this)}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"hand_gestures"),Ko(e,"hand_landmarks"),Ko(e,"world_hand_landmarks"),Ko(e,"handedness");const t=new Lo;nr(t,ii,this.j);const n=new Wo;Vo(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"HAND_GESTURES:hand_gestures"),Go(n,"LANDMARKS:hand_landmarks"),Go(n,"WORLD_LANDMARKS:world_hand_landmarks"),Go(n,"HANDEDNESS:handedness"),n.o(t),$o(e,n),this.g.attachProtoVectorListener("hand_landmarks",((e,t)=>{for(const n of e){e=da(n);const t=[];for(const n of gn(e,ua,1))t.push({x:Sn(n,1)??0,y:Sn(n,2)??0,z:Sn(n,3)??0,visibility:Sn(n,4)??0});this.landmarks.push(t)}Yi(this,t)})),this.g.attachEmptyPacketListener("hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoVectorListener("world_hand_landmarks",((e,t)=>{for(const n of e){e=la(n);const t=[];for(const n of gn(e,ca,1))t.push({x:Sn(n,1)??0,y:Sn(n,2)??0,z:Sn(n,3)??0,visibility:Sn(n,4)??0});this.worldLandmarks.push(t)}Yi(this,t)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoVectorListener("hand_gestures",((e,t)=>{this.gestures.push(...hc(e,!1)),Yi(this,t)})),this.g.attachEmptyPacketListener("hand_gestures",(e=>{Yi(this,e)})),this.g.attachProtoVectorListener("handedness",((e,t)=>{this.handedness.push(...hc(e)),Yi(this,t)})),this.g.attachEmptyPacketListener("handedness",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function yc(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}pc.prototype.recognizeForVideo=pc.prototype.Na,pc.prototype.recognize=pc.prototype.Ma,pc.prototype.setOptions=pc.prototype.o,pc.createFromModelPath=function(e,t){return Hs(pc,e,{baseOptions:{modelAssetPath:t}})},pc.createFromModelBuffer=function(e,t){return Hs(pc,e,{baseOptions:{modelAssetBuffer:t}})},pc.createFromOptions=function(e,t){return Hs(pc,e,t)},pc.HAND_CONNECTIONS=dc;var gc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],vn(e=this.h=new Qa,0,1,t=new Da),this.s=new Za,vn(this.h,0,3,this.s),this.j=new Ka,vn(this.h,0,2,this.j),_n(this.j,3,1),Dn(this.j,2,.5),Dn(this.s,2,.5),Dn(this.h,4,.5)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return"numHands"in e&&_n(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&Dn(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Dn(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Dn(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],qs(this,e,t),yc(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],$s(this,e,n,t),yc(this)}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"hand_landmarks"),Ko(e,"world_hand_landmarks"),Ko(e,"handedness");const t=new Lo;nr(t,ai,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"LANDMARKS:hand_landmarks"),Go(n,"WORLD_LANDMARKS:world_hand_landmarks"),Go(n,"HANDEDNESS:handedness"),n.o(t),$o(e,n),this.g.attachProtoVectorListener("hand_landmarks",((e,t)=>{for(const n of e)e=da(n),this.landmarks.push(Pi(e));Yi(this,t)})),this.g.attachEmptyPacketListener("hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoVectorListener("world_hand_landmarks",((e,t)=>{for(const n of e)e=la(n),this.worldLandmarks.push(Ci(e));Yi(this,t)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoVectorListener("handedness",((e,t)=>{var n=this.handedness,r=n.push;const o=[];for(const a of e){e=ra(a);const t=[];for(const n of e.g())t.push({score:Sn(n,2)??0,index:Mn(zn(n,1),0)??-1,categoryName:Tn(n,3)??"",displayName:Tn(n,4)??""});o.push(t)}r.call(n,...o),Yi(this,t)})),this.g.attachEmptyPacketListener("handedness",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};gc.prototype.detectForVideo=gc.prototype.F,gc.prototype.detect=gc.prototype.D,gc.prototype.setOptions=gc.prototype.o,gc.createFromModelPath=function(e,t){return Hs(gc,e,{baseOptions:{modelAssetPath:t}})},gc.createFromModelBuffer=function(e,t){return Hs(gc,e,{baseOptions:{modelAssetBuffer:t}})},gc.createFromOptions=function(e,t){return Hs(gc,e,t)},gc.HAND_CONNECTIONS=dc;var vc=Vs([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function xc(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function wc(e){try{if(!e.C)return e.h;e.C(e.h)}finally{Qi(e)}}function bc(e,t){e=da(e),t.push(Pi(e))}var Ec=class extends Ks{constructor(e,t){super(new Ws(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,vn(e=this.j=new ui,0,1,t=new Da),this.K=new Za,vn(this.j,0,2,this.K),this.ca=new si,vn(this.j,0,3,this.ca),this.s=new Ra,vn(this.j,0,4,this.s),this.I=new Oa,vn(this.j,0,5,this.I),this.v=new ci,vn(this.j,0,6,this.v),this.L=new li,vn(this.j,0,7,this.L),Dn(this.s,2,.5),Dn(this.s,3,.3),Dn(this.I,2,.5),Dn(this.v,2,.5),Dn(this.v,3,.3),Dn(this.L,2,.5),Dn(this.K,2,.5)}get baseOptions(){return pn(this.j,Da,1)}set baseOptions(e){vn(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&Dn(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&Dn(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&Dn(this.I,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&Dn(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&Dn(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&Dn(this.L,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&Dn(this.K,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r="function"!=typeof t?t:{};return this.C="function"==typeof t?t:n,xc(this),qs(this,e,r),wc(this)}F(e,t,n,r){const o="function"!=typeof n?n:{};return this.C="function"==typeof n?n:r,xc(this),$s(this,e,o,t),wc(this)}m(){var e=new Zo;Yo(e,"input_frames_image"),Ko(e,"pose_landmarks"),Ko(e,"pose_world_landmarks"),Ko(e,"face_landmarks"),Ko(e,"left_hand_landmarks"),Ko(e,"left_hand_world_landmarks"),Ko(e,"right_hand_landmarks"),Ko(e,"right_hand_world_landmarks");const t=new Lo,n=new Ao;cn(n,1,rt("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(e,t){if(null!=t)if(Array.isArray(t))Kt(e,2,Ot(t,Vt,void 0,void 0,!1));else{if(!("string"==typeof t||t instanceof N||k(t)))throw Error("invalid value in Any.value field: "+t+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");cn(e,2,me(t,!1,!1),U())}}(n,this.j.g());const r=new Wo;Vo(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),En(r,8,Ao,n),jo(r,"IMAGE:input_frames_image"),Go(r,"POSE_LANDMARKS:pose_landmarks"),Go(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Go(r,"FACE_LANDMARKS:face_landmarks"),Go(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Go(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Go(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Go(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),$o(e,r),Ki(this,e),this.g.attachProtoListener("pose_landmarks",((e,t)=>{bc(e,this.h.poseLandmarks),Yi(this,t)})),this.g.attachEmptyPacketListener("pose_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoListener("pose_world_landmarks",((e,t)=>{var n=this.h.poseWorldLandmarks;e=la(e),n.push(Ci(e)),Yi(this,t)})),this.g.attachEmptyPacketListener("pose_world_landmarks",(e=>{Yi(this,e)})),this.outputPoseSegmentationMasks&&(Go(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),Zi(this,"pose_segmentation_mask"),this.g.W("pose_segmentation_mask",((e,t)=>{this.h.poseSegmentationMasks=[Ys(this,e,!0,!this.C)],Yi(this,t)})),this.g.attachEmptyPacketListener("pose_segmentation_mask",(e=>{this.h.poseSegmentationMasks=[],Yi(this,e)}))),this.g.attachProtoListener("face_landmarks",((e,t)=>{bc(e,this.h.faceLandmarks),Yi(this,t)})),this.g.attachEmptyPacketListener("face_landmarks",(e=>{Yi(this,e)})),this.outputFaceBlendshapes&&(Ko(e,"extra_blendshapes"),Go(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",((e,t)=>{var n=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(e=ra(e),n.push(_i(e.g()??[]))),Yi(this,t)})),this.g.attachEmptyPacketListener("extra_blendshapes",(e=>{Yi(this,e)}))),this.g.attachProtoListener("left_hand_landmarks",((e,t)=>{bc(e,this.h.leftHandLandmarks),Yi(this,t)})),this.g.attachEmptyPacketListener("left_hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoListener("left_hand_world_landmarks",((e,t)=>{var n=this.h.leftHandWorldLandmarks;e=la(e),n.push(Ci(e)),Yi(this,t)})),this.g.attachEmptyPacketListener("left_hand_world_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoListener("right_hand_landmarks",((e,t)=>{bc(e,this.h.rightHandLandmarks),Yi(this,t)})),this.g.attachEmptyPacketListener("right_hand_landmarks",(e=>{Yi(this,e)})),this.g.attachProtoListener("right_hand_world_landmarks",((e,t)=>{var n=this.h.rightHandWorldLandmarks;e=la(e),n.push(Ci(e)),Yi(this,t)})),this.g.attachEmptyPacketListener("right_hand_world_landmarks",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ec.prototype.detectForVideo=Ec.prototype.F,Ec.prototype.detect=Ec.prototype.D,Ec.prototype.setOptions=Ec.prototype.o,Ec.createFromModelPath=function(e,t){return Hs(Ec,e,{baseOptions:{modelAssetPath:t}})},Ec.createFromModelBuffer=function(e,t){return Hs(Ec,e,{baseOptions:{modelAssetBuffer:t}})},Ec.createFromOptions=function(e,t){return Hs(Ec,e,t)},Ec.HAND_CONNECTIONS=dc,Ec.POSE_CONNECTIONS=vc,Ec.FACE_LANDMARKS_LIPS=Qs,Ec.FACE_LANDMARKS_LEFT_EYE=Js,Ec.FACE_LANDMARKS_LEFT_EYEBROW=ec,Ec.FACE_LANDMARKS_LEFT_IRIS=tc,Ec.FACE_LANDMARKS_RIGHT_EYE=nc,Ec.FACE_LANDMARKS_RIGHT_EYEBROW=rc,Ec.FACE_LANDMARKS_RIGHT_IRIS=oc,Ec.FACE_LANDMARKS_FACE_OVAL=ac,Ec.FACE_LANDMARKS_CONTOURS=ic,Ec.FACE_LANDMARKS_TESSELATION=sc;var Mc=class extends Ks{constructor(e,t){super(new Ws(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},vn(e=this.h=new mi,0,1,t=new Da)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return vn(this.h,0,2,Ai(e,pn(this.h,Ea,2))),this.l(e)}wa(e,t){return this.j={classifications:[]},qs(this,e,t),this.j}xa(e,t,n){return this.j={classifications:[]},$s(this,e,n,t),this.j}m(){var e=new Zo;Yo(e,"input_image"),Yo(e,"norm_rect"),Ko(e,"classifications");const t=new Lo;nr(t,hi,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),jo(n,"IMAGE:input_image"),jo(n,"NORM_RECT:norm_rect"),Go(n,"CLASSIFICATIONS:classifications"),n.o(t),$o(e,n),this.g.attachProtoListener("classifications",((e,t)=>{this.j=function(e){const t={classifications:gn(e,pa,1).map((e=>_i(pn(e,ta,4)?.g()??[],Mn(zn(e,2),0),Tn(e,3))))};return null!=tt(qt(e,2))&&(t.timestampMs=Mn(tt(qt(e,2)),0)),t}(ya(e)),Yi(this,t)})),this.g.attachEmptyPacketListener("classifications",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Mc.prototype.classifyForVideo=Mc.prototype.xa,Mc.prototype.classify=Mc.prototype.wa,Mc.prototype.setOptions=Mc.prototype.o,Mc.createFromModelPath=function(e,t){return Hs(Mc,e,{baseOptions:{modelAssetPath:t}})},Mc.createFromModelBuffer=function(e,t){return Hs(Mc,e,{baseOptions:{modelAssetBuffer:t}})},Mc.createFromOptions=function(e,t){return Hs(Mc,e,t)};var zc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!0),this.h=new pi,this.embeddings={embeddings:[]},vn(e=this.h,0,1,t=new Da)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){var t=this.h,n=pn(this.h,za,2);return n=n?n.clone():new za,void 0!==e.l2Normalize?An(n,1,e.l2Normalize):"l2Normalize"in e&&Kt(n,1),void 0!==e.quantize?An(n,2,e.quantize):"quantize"in e&&Kt(n,2),vn(t,0,2,n),this.l(e)}Da(e,t){return qs(this,e,t),this.embeddings}Ea(e,t,n){return $s(this,e,n,t),this.embeddings}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"embeddings_out");const t=new Lo;nr(t,yi,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"EMBEDDINGS:embeddings_out"),n.o(t),$o(e,n),this.g.attachProtoListener("embeddings_out",((e,t)=>{e=ba(e),this.embeddings=function(e){return{embeddings:gn(e,xa,1).map((e=>{const t={headIndex:Mn(zn(e,3),0)??-1,headName:Tn(e,4)??""};if(void 0!==hn(e,ga,ln(e,1)))e=nn(e=pn(e,ga,ln(e,1)),1,Xe,tn()),t.floatEmbedding=e.slice();else{const n=new Uint8Array(0);t.quantizedEmbedding=pn(e,va,ln(e,2))?.ra()?.ua()??n}return t})),timestampMs:Mn(tt(qt(e,2)),0)}}(e),Yi(this,t)})),this.g.attachEmptyPacketListener("embeddings_out",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};zc.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=Fi(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=Fi(Ri(e.quantizedEmbedding),Ri(t.quantizedEmbedding))}return e},zc.prototype.embedForVideo=zc.prototype.Ea,zc.prototype.embed=zc.prototype.Da,zc.prototype.setOptions=zc.prototype.o,zc.createFromModelPath=function(e,t){return Hs(zc,e,{baseOptions:{modelAssetPath:t}})},zc.createFromModelBuffer=function(e,t){return Hs(zc,e,{baseOptions:{modelAssetBuffer:t}})},zc.createFromOptions=function(e,t){return Hs(zc,e,t)};var Sc=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){this.confidenceMasks?.forEach((e=>{e.close()})),this.categoryMask?.close()}};function Tc(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function Ac(e){try{const t=new Sc(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{Qi(e)}}Sc.prototype.close=Sc.prototype.close;var _c=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new bi,this.v=new gi,vn(this.h,0,3,this.v),vn(e=this.h,0,1,t=new Da)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return void 0!==e.displayNamesLocale?Kt(this.h,2,rt(e.displayNamesLocale)):"displayNamesLocale"in e&&Kt(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}J(){!function(e){const t=gn(e.ga(),Wo,1).filter((e=>Tn(e,1).includes("mediapipe.tasks.TensorsToSegmentationCalculator")));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");1===t.length&&(pn(t[0],Lo,7)?.l()?.g()??new Map).forEach(((t,n)=>{e.s[Number(n)]=Tn(t,1)}))}(this)}ha(e,t,n){const r="function"!=typeof t?t:{};return this.j="function"==typeof t?t:n,Tc(this),qs(this,e,r),Ac(this)}Pa(e,t,n,r){const o="function"!=typeof n?n:{};return this.j="function"==typeof n?n:r,Tc(this),$s(this,e,o,t),Ac(this)}Ha(){return this.s}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect");const t=new Lo;nr(t,Ei,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),n.o(t),$o(e,n),Ki(this,e),this.outputConfidenceMasks&&(Ko(e,"confidence_masks"),Go(n,"CONFIDENCE_MASKS:confidence_masks"),Zi(this,"confidence_masks"),this.g.fa("confidence_masks",((e,t)=>{this.confidenceMasks=e.map((e=>Ys(this,e,!0,!this.j))),Yi(this,t)})),this.g.attachEmptyPacketListener("confidence_masks",(e=>{this.confidenceMasks=[],Yi(this,e)}))),this.outputCategoryMask&&(Ko(e,"category_mask"),Go(n,"CATEGORY_MASK:category_mask"),Zi(this,"category_mask"),this.g.W("category_mask",((e,t)=>{this.categoryMask=Ys(this,e,!1,!this.j),Yi(this,t)})),this.g.attachEmptyPacketListener("category_mask",(e=>{this.categoryMask=void 0,Yi(this,e)}))),Ko(e,"quality_scores"),Go(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((e,t)=>{this.qualityScores=e,Yi(this,t)})),this.g.attachEmptyPacketListener("quality_scores",(e=>{this.categoryMask=void 0,Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};_c.prototype.getLabels=_c.prototype.Ha,_c.prototype.segmentForVideo=_c.prototype.Pa,_c.prototype.segment=_c.prototype.ha,_c.prototype.setOptions=_c.prototype.o,_c.createFromModelPath=function(e,t){return Hs(_c,e,{baseOptions:{modelAssetPath:t}})},_c.createFromModelBuffer=function(e,t){return Hs(_c,e,{baseOptions:{modelAssetBuffer:t}})},_c.createFromOptions=function(e,t){return Hs(_c,e,t)};var Dc=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){this.confidenceMasks?.forEach((e=>{e.close()})),this.categoryMask?.close()}};Dc.prototype.close=Dc.prototype.close;var Pc=class extends rr{constructor(e){super(e)}},Cc=[0,co,-2],Rc=[0,to,-3,fo,to,-1],Fc=[0,Rc],kc=[0,Rc,co,-1],Bc=class extends rr{constructor(e){super(e)}},Ic=[0,to,-1,fo],Lc=class extends rr{constructor(){super()}},Uc=class extends rr{constructor(e){super(e)}},Oc=[1,2,3,4,5,6,7,8,9,10,14,15],Nc=class extends rr{constructor(){super()}};Nc.prototype.g=To([0,eo,[0,Oc,xo,Rc,xo,[0,Rc,Cc],xo,Fc,xo,[0,Fc,Cc],xo,Ic,xo,[0,to,-3,fo,Eo],xo,[0,to,-3,fo],xo,[0,yo,to,-2,fo,co,fo,-1,2,to,Cc],xo,kc,xo,[0,kc,Cc],to,Cc,yo,xo,[0,to,-3,fo,Cc,-1],xo,[0,eo,Ic]],yo,[0,yo,co,-1,fo]]);var Vc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new bi,this.s=new gi,vn(this.h,0,3,this.s),vn(e=this.h,0,1,t=new Da)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}ha(e,t,n,r){const o="function"!=typeof n?n:{};this.j="function"==typeof n?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Nc;const a=new Uc;var i=new Pc;if(_n(i,1,255),vn(a,0,12,i),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var s=new Bc;An(s,3,!0),Dn(s,1,t.keypoint.x),Dn(s,2,t.keypoint.y),xn(a,5,Oc,s)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(s of(i=new Lc,t.scribble))An(t=new Bc,3,!0),Dn(t,1,s.x),Dn(t,2,s.y),En(i,1,Bc,t);xn(a,15,Oc,i)}En(r,1,Uc,a),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),qs(this,e,o);e:{try{const e=new Dc(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var c=e;break e}this.j(e)}finally{Qi(this)}c=void 0}return c}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"roi_in"),Yo(e,"norm_rect_in");const t=new Lo;nr(t,Ei,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),jo(n,"IMAGE:image_in"),jo(n,"ROI:roi_in"),jo(n,"NORM_RECT:norm_rect_in"),n.o(t),$o(e,n),Ki(this,e),this.outputConfidenceMasks&&(Ko(e,"confidence_masks"),Go(n,"CONFIDENCE_MASKS:confidence_masks"),Zi(this,"confidence_masks"),this.g.fa("confidence_masks",((e,t)=>{this.confidenceMasks=e.map((e=>Ys(this,e,!0,!this.j))),Yi(this,t)})),this.g.attachEmptyPacketListener("confidence_masks",(e=>{this.confidenceMasks=[],Yi(this,e)}))),this.outputCategoryMask&&(Ko(e,"category_mask"),Go(n,"CATEGORY_MASK:category_mask"),Zi(this,"category_mask"),this.g.W("category_mask",((e,t)=>{this.categoryMask=Ys(this,e,!1,!this.j),Yi(this,t)})),this.g.attachEmptyPacketListener("category_mask",(e=>{this.categoryMask=void 0,Yi(this,e)}))),Ko(e,"quality_scores"),Go(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((e,t)=>{this.qualityScores=e,Yi(this,t)})),this.g.attachEmptyPacketListener("quality_scores",(e=>{this.categoryMask=void 0,Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vc.prototype.segment=Vc.prototype.ha,Vc.prototype.setOptions=Vc.prototype.o,Vc.createFromModelPath=function(e,t){return Hs(Vc,e,{baseOptions:{modelAssetPath:t}})},Vc.createFromModelBuffer=function(e,t){return Hs(Vc,e,{baseOptions:{modelAssetBuffer:t}})},Vc.createFromOptions=function(e,t){return Hs(Vc,e,t)};var jc=class extends Ks{constructor(e,t){super(new Ws(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},vn(e=this.h=new Mi,0,1,t=new Da)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return void 0!==e.displayNamesLocale?Kt(this.h,2,rt(e.displayNamesLocale)):"displayNamesLocale"in e&&Kt(this.h,2),void 0!==e.maxResults?_n(this.h,3,e.maxResults):"maxResults"in e&&Kt(this.h,3),void 0!==e.scoreThreshold?Dn(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&Kt(this.h,4),void 0!==e.categoryAllowlist?Pn(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&Kt(this.h,5),void 0!==e.categoryDenylist?Pn(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&Kt(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},qs(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},$s(this,e,n,t),this.j}m(){var e=new Zo;Yo(e,"input_frame_gpu"),Yo(e,"norm_rect"),Ko(e,"detections");const t=new Lo;nr(t,zi,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),jo(n,"IMAGE:input_frame_gpu"),jo(n,"NORM_RECT:norm_rect"),Go(n,"DETECTIONS:detections"),n.o(t),$o(e,n),this.g.attachProtoVectorListener("detections",((e,t)=>{for(const n of e)e=sa(n),this.j.detections.push(Di(e));Yi(this,t)})),this.g.attachEmptyPacketListener("detections",(e=>{Yi(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};jc.prototype.detectForVideo=jc.prototype.F,jc.prototype.detect=jc.prototype.D,jc.prototype.setOptions=jc.prototype.o,jc.createFromModelPath=async function(e,t){return Hs(jc,e,{baseOptions:{modelAssetPath:t}})},jc.createFromModelBuffer=function(e,t){return Hs(jc,e,{baseOptions:{modelAssetBuffer:t}})},jc.createFromOptions=function(e,t){return Hs(jc,e,t)};var Gc=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){this.segmentationMasks?.forEach((e=>{e.close()}))}};function Wc(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function Hc(e){try{const t=new Gc(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{Qi(e)}}Gc.prototype.close=Gc.prototype.close;var Xc=class extends Ks{constructor(e,t){super(new Ws(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,vn(e=this.h=new Si,0,1,t=new Da),this.v=new li,vn(this.h,0,3,this.v),this.j=new ci,vn(this.h,0,2,this.j),_n(this.j,4,1),Dn(this.j,2,.5),Dn(this.v,2,.5),Dn(this.h,4,.5)}get baseOptions(){return pn(this.h,Da,1)}set baseOptions(e){vn(this.h,0,1,e)}o(e){return"numPoses"in e&&_n(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&Dn(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&Dn(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&Dn(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r="function"!=typeof t?t:{};return this.s="function"==typeof t?t:n,Wc(this),qs(this,e,r),Hc(this)}F(e,t,n,r){const o="function"!=typeof n?n:{};return this.s="function"==typeof n?n:r,Wc(this),$s(this,e,o,t),Hc(this)}m(){var e=new Zo;Yo(e,"image_in"),Yo(e,"norm_rect"),Ko(e,"normalized_landmarks"),Ko(e,"world_landmarks"),Ko(e,"segmentation_masks");const t=new Lo;nr(t,Ti,this.h);const n=new Wo;Vo(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),jo(n,"IMAGE:image_in"),jo(n,"NORM_RECT:norm_rect"),Go(n,"NORM_LANDMARKS:normalized_landmarks"),Go(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),$o(e,n),Ki(this,e),this.g.attachProtoVectorListener("normalized_landmarks",((e,t)=>{this.landmarks=[];for(const n of e)e=da(n),this.landmarks.push(Pi(e));Yi(this,t)})),this.g.attachEmptyPacketListener("normalized_landmarks",(e=>{this.landmarks=[],Yi(this,e)})),this.g.attachProtoVectorListener("world_landmarks",((e,t)=>{this.worldLandmarks=[];for(const n of e)e=la(n),this.worldLandmarks.push(Ci(e));Yi(this,t)})),this.g.attachEmptyPacketListener("world_landmarks",(e=>{this.worldLandmarks=[],Yi(this,e)})),this.outputSegmentationMasks&&(Go(n,"SEGMENTATION_MASK:segmentation_masks"),Zi(this,"segmentation_masks"),this.g.fa("segmentation_masks",((e,t)=>{this.segmentationMasks=e.map((e=>Ys(this,e,!0,!this.s))),Yi(this,t)})),this.g.attachEmptyPacketListener("segmentation_masks",(e=>{this.segmentationMasks=[],Yi(this,e)}))),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Xc.prototype.detectForVideo=Xc.prototype.F,Xc.prototype.detect=Xc.prototype.D,Xc.prototype.setOptions=Xc.prototype.o,Xc.createFromModelPath=function(e,t){return Hs(Xc,e,{baseOptions:{modelAssetPath:t}})},Xc.createFromModelBuffer=function(e,t){return Hs(Xc,e,{baseOptions:{modelAssetBuffer:t}})},Xc.createFromOptions=function(e,t){return Hs(Xc,e,t)},Xc.POSE_CONNECTIONS=vc}}]);
//# sourceMappingURL=react-three.cfd4ca44ba97705d02b2.chunk.js.map